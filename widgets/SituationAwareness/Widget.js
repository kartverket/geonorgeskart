// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://@sbaseurl@/jsapi/jsapi/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"esri/tasks/locator":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/Deferred dojo/_base/json dojo/has ../kernel ../request ../deferredUtils ./Task ./AddressCandidate".split(" "),function(t,m,l,n,f,d,a,c,e,w,g){return t(w,{declaredClass:"esri.tasks.Locator",_eventMap:{"address-to-locations-complete":["addresses"],"addresses-to-locations-complete":["addresses"],"location-to-address-complete":["address"],"suggest-locations-complete":["suggestions"]},
constructor:function(c){this._geocodeHandler=m.hitch(this,this._geocodeHandler);this._geocodeAddressesHandler=m.hitch(this,this._geocodeAddressesHandler);this._reverseGeocodeHandler=m.hitch(this,this._reverseGeocodeHandler);this.registerConnectEvents()},outSpatialReference:null,setOutSpatialReference:function(c){this.outSpatialReference=c},_geocodeHandler:function(c,a,e,k,d){try{var b=c.candidates,s;a=[];var u,r=b.length,w=c.spatialReference,f;for(u=0;u<r;u++){s=b[u];if(f=s.location)f.spatialReference=
w;a[u]=new g(s)}this._successHandler([a],"onAddressToLocationsComplete",e,d)}catch(m){this._errorHandler(m,k,d)}},_geocodeAddressesHandler:function(c,a,e,k,d){try{var b=c.locations;a=[];var s,u=b.length,r=c.spatialReference,w;for(s=0;s<u;s++){if(w=b[s].location)w.spatialReference=r;a[s]=new g(b[s])}this._successHandler([a],"onAddressesToLocationsComplete",e,d)}catch(f){this._errorHandler(f,k,d)}},addressToLocations:function(a,p,d,k,g){var b,s,u,r,w,z,l;a.address&&(k=d,d=p,p=a.outFields,g=a.searchExtent,
l=a.countryCode,b=a.magicKey,s=a.distance,z=a.categories,a.location&&this.normalization&&(u=a.location.normalize()),r=a.maxLocations,w=a.forStorage,a=a.address);g&&(g=g.shiftCentralMeridian());var t=this.outSpatialReference;a=this._encode(m.mixin({},this._url.query,a,{f:"json",outSR:t&&f.toJson(t.toJson()),outFields:p&&p.join(",")||null,searchExtent:g&&f.toJson(g.toJson()),category:z&&z.join(",")||null,countryCode:l||null,magicKey:b||null,distance:s||null,location:u||null,maxLocations:r||null,forStorage:w||
null}));var N=this._geocodeHandler,A=this._errorHandler,D=new n(e._dfdCanceller);D._pendingDfd=c({url:this._url.path+"/findAddressCandidates",content:a,callbackParamName:"callback",load:function(b,a){N(b,a,d,k,D)},error:function(b){A(b,k,D)}});return D},suggestLocations:function(a){var d;d=new n(e._dfdCanceller);a.hasOwnProperty("location")&&this.normalization&&(a.location=a.location.normalize());a.searchExtent&&(a.searchExtent=a.searchExtent.shiftCentralMeridian());a=this._encode(m.mixin({},this._url.query,
{f:"json",text:a.text,maxSuggestions:a.maxSuggestions,searchExtent:a.searchExtent&&f.toJson(a.searchExtent.toJson()),category:a.categories&&a.categories.join(",")||null,countryCode:a.countryCode||null,location:a.location||null,distance:a.distance||null},{f:"json"}));a=c({url:this._url.path+"/suggest",content:a,callbackParamName:"callback"});d._pendingDfd=a;a.then(m.hitch(this,function(a){a=a.suggestions||[];this.onSuggestLocationsComplete(a);d.resolve(a)}),m.hitch(this,function(a){this._errorHandler(a);
d.reject(a)}));return d},addressesToLocations:function(a,d,g){var k=this.outSpatialReference,v=[],b=a.categories,s=a.countryCode;l.forEach(a.addresses,function(b,a){v.push({attributes:b})});a=this._encode(m.mixin({},this._url.query,{category:b&&b.join(",")||null,sourceCountry:s||null},{addresses:f.toJson({records:v})},{f:"json",outSR:k&&f.toJson(k.toJson())}));var u=this._geocodeAddressesHandler,r=this._errorHandler,w=new n(e._dfdCanceller);w._pendingDfd=c({url:this._url.path+"/geocodeAddresses",
content:a,callbackParamName:"callback",load:function(b,a){u(b,a,d,g,w)},error:function(b){r(b,g,w)}});return w},_reverseGeocodeHandler:function(a,c,e,k,d){try{var b=new g({address:a.address,location:a.location,score:100});this._successHandler([b],"onLocationToAddressComplete",e,d)}catch(s){this._errorHandler(s,k,d)}},locationToAddress:function(a,d,g,k){a&&this.normalization&&(a=a.normalize());var v=this.outSpatialReference;a=this._encode(m.mixin({},this._url.query,{outSR:v&&f.toJson(v.toJson()),location:a&&
f.toJson(a.toJson()),distance:d,f:"json"}));var b=this._reverseGeocodeHandler,s=this._errorHandler,u=new n(e._dfdCanceller);u._pendingDfd=c({url:this._url.path+"/reverseGeocode",content:a,callbackParamName:"callback",load:function(a,c){b(a,c,g,k,u)},error:function(b){s(b,k,u)}});return u},onSuggestLocationsComplete:function(){},onAddressToLocationsComplete:function(){},onAddressesToLocationsComplete:function(){},onLocationToAddressComplete:function(){}})})},"esri/tasks/AddressCandidate":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/has","../kernel","../geometry/Point"],function(t,m,l,n,f){return t(null,{declaredClass:"esri.tasks.AddressCandidate",constructor:function(d){m.mixin(this,d);this.location=new f(this.location)}})})},"esri/tasks/BufferParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/Polygon ../geometry/jsonUtils".split(" "),function(t,m,l,n,f,d,a,c){return t(null,{declaredClass:"esri.tasks.BufferParameters",geometries:null,
outSpatialReference:null,bufferSpatialReference:null,distances:null,unit:null,unionResults:!1,geodesic:!1,toJson:function(){var e={unit:this.unit,unionResults:this.unionResults,geodesic:this.geodesic},d=this.distances,g=this.outSpatialReference,y=this.bufferSpatialReference,p=l.map(this.geometries,function(c){c="extent"===c.type?a.fromExtent(c):c;return c.toJson()},this),f=this.geometries;if(f&&0<f.length){var k="extent"===f[0].type?"esriGeometryPolygon":c.getJsonType(f[0]);e.geometries=n.toJson({geometryType:k,
geometries:p});e.inSR=f[0].spatialReference.wkid?f[0].spatialReference.wkid:n.toJson(f[0].spatialReference.toJson())}d&&(e.distances=d.join(","));g&&(e.outSR=g.wkid?g.wkid:n.toJson(g.toJson()));y&&(e.bufferSR=y.wkid?y.wkid:n.toJson(y.toJson()));return e}})})},"esri/dijit/AttributeInspector":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/connect dojo/_base/sniff dojo/_base/kernel dojo/has dojo/dom-style dojo/dom-construct ../kernel ../lang ../domUtils ../layers/InheritedDomain ../layers/FeatureLayer dojo/i18n!../nls/jsapi dojo/fx dojox/gfx dijit/_Widget dijit/_Templated dijit/Editor dijit/_editor/plugins/LinkDialog dijit/_editor/plugins/TextColor ./_EventedWidget ./editing/AttachmentEditor ./editing/Util ../tasks/query dijit/form/DateTextBox dijit/form/TextBox dijit/form/NumberTextBox dijit/form/FilteringSelect dijit/form/NumberSpinner dijit/form/Button dijit/form/SimpleTextarea dijit/form/ValidationTextBox dijit/form/TimeTextBox dijit/Tooltip dojo/data/ItemFileReadStore dojox/date/islamic dojox/date/islamic/Date dojox/date/islamic/locale dojo/text!./templates/AttributeInspector.html".split(" "),
function(t,m,l,n,f,d,a,c,e,w,g,y,p,x,k,v,b,s,u,r,H,z,F,M,N,A,D,E,C,B,h,q,G,K,J,I,O,P,R,S,Q){var L=t([F,s,u],{declaredClass:"esri.dijit.AttributeInspector",widgetsInTemplate:!0,templateString:Q,onUpdate:function(){},onDelete:function(){},onAttributeChange:function(){},onNext:function(){},onReset:function(){},onCancel:function(){},_navMessage:"( ${idx} ${of} ${numFeatures} )",_currentAttributeFieldName:null,_aiConnects:[],_selection:[],_toolTips:[],_numFeatures:0,_featureIdx:0,_currentLInfo:null,_currentFeature:null,
_rollbackInfo:null,_eventMap:{update:!0,"delete":["feature"],"attribute-change":["feature","fieldName","fieldValue"],next:["feature"],reset:!0,cancel:!0},constructor:function(h,b){m.mixin(this,k.widgets.attributeInspector);h=h||{};!h.featureLayer&&!h.layerInfos&&console.error("esri.AttributeInspector: please provide correct parameter in the constructor");this._datePackage=this._getDatePackage(h);this._layerInfos=h.layerInfos||[{featureLayer:h.featureLayer,options:h.options||[]}];this._layerInfos=
l.filter(this._layerInfos,function(h){return!h.disableAttributeUpdate});this._hideNavButtons=h.hideNavButtons||!1},postCreate:function(){if(l.every(this._layerInfos,function(h){return h.featureLayer.loaded}))this._initLayerInfos(),this._createAttachmentEditor(),this.onFirstFeature();else{var h=this._layerInfos.length;l.forEach(this._layerInfos,function(b){b=b.featureLayer;if(b.loaded)h--;else var a=n.connect(b,"onLoad",this,function(b){n.disconnect(a);a=null;h--;h||(this._initLayerInfos(),this._createAttachmentEditor(),
this.onFirstFeature())})},this)}},destroy:function(){this._destroyAttributeTable();l.forEach(this._aiConnects,n.disconnect);delete this._aiConnects;this._attachmentEditor&&(this._attachmentEditor.destroy(),delete this._attachmentEditor);delete this._layerInfos;this._selection=this._currentFeature=this._currentLInfo=this._attributes=this._layerInfos=null;this.inherited(arguments)},refresh:function(){this._updateSelection()},first:function(){this.onFirstFeature()},last:function(){this.onLastFeature()},
next:function(){this.onNextFeature()},previous:function(){this.onPreviousFeature()},showFeature:function(h,b){b&&(this._createOnlyFirstTime=!0);this._updateSelection([h],b);this._updateUI()},onLayerSelectionChange:function(h,b,a){this._createOnlyFirstTime=!1;this._featureIdx=a===x.SELECTION_NEW?0:this._featureIdx;this._updateSelection();this._updateUI()},onLayerSelectionClear:function(){this._selection&&!(0>=this._selection.length)&&(this._featureIdx=this._numFeatures=0,this._selection=[],this._currentLInfo=
this._currentFeature=null,this._updateUI())},onLayerUpdateEnd:function(h,b,a,q){},onLayerError:function(h,b,a,q){},onLayerEditsError:function(h,b,a,q){},onLayerEditsComplete:function(h,b,a,q){q=q||[];if(q.length){var c=this._selection,e=h.featureLayer.objectIdField;l.forEach(q,m.hitch(this,function(h){l.some(c,m.hitch(this,function(b,a){if(b.attributes[e]!==h.objectId)return!1;this._selection.splice(a,1);return!0}))}))}b=b||[];b.length&&(this._selection=N.findFeatures(b,h.featureLayer),this._featureIdx=
0);q=this._numFeatures=this._selection?this._selection.length:0;if(b.length){if(b=q?this._selection[this._featureIdx]:null)q=b.getLayer().getEditCapabilities(),(!q.canCreate||q.canUpdate)&&this._showFeature(b);this._updateUI()}a=a||[];if(a.length){var d=this._rollbackInfo;l.forEach(a,function(b){var q=N.findFeatures(a,h.featureLayer)[0];if(!b.success&&q.attributes[h.featureLayer.objectIdField]===b.objectId&&d){b=d.graphic.attributes[d.field.name];var c=l.filter(this._currentLInfo.fieldInfos,function(h){return h.fieldName===
d.field.name},this)[0].dijit;q.attributes[d.field.name]=b;this._setValue(c,b)}},this)}this._rollbackInfo=null},onFieldValueChange:function(h,b){var a=h.field,q=h.dijit,c=this._currentFeature,e=this._currentLInfo,d=a.name;if(""!==q.displayedValue&&"undefined"===typeof b&&!q.isValid())this._setValue(q,c.attributes[a.name]);else if(""!==q.displayedValue&&q.displayedValue!==b&&q.isValid&&!q.isValid())this._setValue(q,c.attributes[a.name]);else{b="undefined"===typeof b?null:b;if("esriFieldTypeDate"===
a.type){if(q instanceof Array){var k=q[0].getValue(),q=q[1].getValue();b=k&&q?new Date(k.getFullYear(),k.getMonth(),k.getDate(),q.getHours(),q.getMinutes(),q.getSeconds(),q.getMilliseconds()):k||q||null}else b=q.getValue();b=b&&b.getTime?b.getTime():b&&b.toGregorian?b.toGregorian().getTime():b}if(this._currentFeature.attributes[a.name]!==b){if(d===e.typeIdField){var p=this._findFirst(e.types,"id",b);l.forEach(e.fieldInfos,function(h){if((a=h.field)&&a.name!==e.typeIdField)h=h.dijit,this._setFieldDomain(h,
p,a)&&h&&(this._setValue(h,c.attributes[a.name]+""),!1===h.isValid()&&this._setValue(h,null))},this)}this.onAttributeChange(c,d,b)}}},onDeleteBtn:function(h){this._deleteFeature()},onNextFeature:function(h){this._onNextFeature(1)},onPreviousFeature:function(h){this._onNextFeature(-1)},onFirstFeature:function(h){this._onNextFeature(-1*this._featureIdx)},onLastFeature:function(h){this._onNextFeature(this._numFeatures-1-this._featureIdx)},_initLayerInfos:function(){var h=this._layerInfos;this._editorTrackingInfos=
{};l.forEach(h,this._initLayerInfo,this)},_initLayerInfo:function(h){var b=h.featureLayer,a,q;this._userIds={};q=b.id;b.credential&&(this._userIds[q]=b.credential.userId);h.userId&&(this._userIds[q]=h.userId);this._connect(b,"onSelectionComplete",m.hitch(this,"onLayerSelectionChange",h));this._connect(b,"onSelectionClear",m.hitch(this,"onLayerSelectionClear",h));this._connect(b,"onEditsComplete",m.hitch(this,"onLayerEditsComplete",h));this._connect(b,"error",m.hitch(this,"onLayerError",h));this._connect(b,
"onUpdateEnd",m.hitch(this,"onLayerUpdateEnd",h));h.showAttachments=b.hasAttachments?g.isDefined(h.showAttachments)?h.showAttachments:!0:!1;h.hideFields=h.hideFields||[];h.htmlFields=h.htmlFields||[];h.isEditable=b.isEditable()?g.isDefined(h.isEditable)?h.isEditable:!0:!1;h.typeIdField=b.typeIdField;h.layerId=b.id;h.types=b.types;b.globalIdField&&(a=this._findFirst(h.fieldInfos,"fieldName",b.globalIdField),!a&&!h.showGlobalID&&h.hideFields.push(b.globalIdField));q=this._findFirst(h.fieldInfos,"fieldName",
b.objectIdField);!q&&!h.showObjectID&&h.hideFields.push(b.objectIdField);var c=this._getFields(h.featureLayer);if(c){var e=h.fieldInfos||[],e=l.map(e,function(h){return m.mixin({},h)});e.length?h.fieldInfos=l.filter(l.map(e,m.hitch(this,function(b){var a=b.stringFieldOption||(this._isInFields(b.fieldName,h.htmlFields)?L.STRING_FIELD_OPTION_RICHTEXT:L.STRING_FIELD_OPTION_TEXTBOX);return m.mixin(b,{field:this._findFirst(c,"name",b.fieldName),stringFieldOption:a})})),"return item.field;"):(c=l.filter(c,
m.hitch(this,function(b){return!this._isInFields(b.name,h.hideFields)})),h.fieldInfos=l.map(c,m.hitch(this,function(b){var a=this._isInFields(b.name,h.htmlFields)?L.STRING_FIELD_OPTION_RICHTEXT:L.STRING_FIELD_OPTION_TEXTBOX;return{fieldName:b.name,field:b,stringFieldOption:a}})));h.showGlobalID&&!a&&e.push(this._findFirst(c,"name",b.globalIdField));h.showObjectID&&!q&&e.push(this._findFirst(c,"name",b.objectIdField));a=[];b.editFieldsInfo&&(b.editFieldsInfo.creatorField&&a.push(b.editFieldsInfo.creatorField),
b.editFieldsInfo.creationDateField&&a.push(b.editFieldsInfo.creationDateField),b.editFieldsInfo.editorField&&a.push(b.editFieldsInfo.editorField),b.editFieldsInfo.editDateField&&a.push(b.editFieldsInfo.editDateField));this._editorTrackingInfos[b.id]=a}},_createAttachmentEditor:function(){this._attachmentEditor=null;var h=l.filter(this._layerInfos,function(h){return h.showAttachments});h&&h.length&&(this._attachmentEditor=new M({"class":"atiAttachmentEditor"},this.attachmentEditor),this._attachmentEditor.startup())},
_setCurrentLInfo:function(h){var b=this._currentLInfo?this._currentLInfo.featureLayer:null,a=h.featureLayer;if(b&&(b.id===a.id&&!b.ownershipBasedAccessControlForFeatures)&&(b=a.getEditCapabilities(),!b.canCreate||b.canUpdate))return;this._currentLInfo=h;this._createTable()},_updateSelection:function(h,b){this._selection=h||[];l.forEach(this._layerInfos,this._getSelection,this);var a=this._selection.length;this._numFeatures=this._selection.length;this._showFeature(a?this._selection[this._featureIdx]:
null,b)},_getSelection:function(h){h=h.featureLayer.getSelectedFeatures();this._selection=this._selection.concat(h)},_updateUI:function(){var h=this._numFeatures,b=this._currentLInfo;this.layerName.innerHTML=!b||0===h?this.NLS_noFeaturesSelected:b.featureLayer?b.featureLayer.name:"";c.set(this.attributeTable,"display",h?"":"none");c.set(this.editButtons,"display",h?"":"none");c.set(this.navButtons,"display",!this._hideNavButtons&&1<h?"":"none");this.navMessage.innerHTML=g.substitute({idx:this._featureIdx+
1,of:this.NLS_of,numFeatures:this._numFeatures},this._navMessage);this._attachmentEditor&&c.set(this._attachmentEditor.domNode,"display",b&&b.showAttachments&&h?"":"none");c.set(this.deleteBtn.domNode,"display",!(b&&!1===b.showDeleteButton)&&this._canDelete?"":"none");this.domNode.parentNode&&0<this.domNode.parentNode.scrollTop&&(this.domNode.parentNode.scrollTop=0)},_onNextFeature:function(h){this._featureIdx+=h;0>this._featureIdx?this._featureIdx=this._numFeatures-1:this._featureIdx>=this._numFeatures&&
(this._featureIdx=0);h=this._selection.length?this._selection[this._featureIdx]:null;this._showFeature(h);this._updateUI();this.onNext(h)},_deleteFeature:function(){this.onDelete(this._currentFeature)},_showFeature:function(h,b){if(h){this._currentFeature=h;var a=b?b:h.getLayer(),q=a.getEditCapabilities({feature:h,userId:this._userIds[a.id]});this._canUpdate=q.canUpdate;this._canDelete=q.canDelete;if(q=this._getLInfoFromFeatureLayer(a)){this._setCurrentLInfo(q);var c=h.attributes,e=this._findFirst(q.types,
"id",c[q.typeIdField]),d=null;l.forEach(q.fieldInfos,function(h){d=h.field;var b=[];h.dijit&&1<h.dijit.length?l.forEach(h.dijit,function(h){b.push(h)}):b.push(h.dijit);l.forEach(b,m.hitch(this,function(h){if(h){var b=this._setFieldDomain(h,e,d),a=c[d.name],a=a&&b&&b.codedValues&&b.codedValues.length?b.codedValues[a]?b.codedValues[a].name:a:a;g.isDefined(a)||(a="");"dijit.form.DateTextBox"===h.declaredClass||"dijit.form.TimeTextBox"===h.declaredClass?a=""===a?null:new Date(a):"dijit.form.FilteringSelect"===
h.declaredClass&&(h._lastValueReported=null,a=c[d.name]+"");try{this._setValue(h,a),"dijit.form.FilteringSelect"===h.declaredClass&&!1===h.isValid()&&this._setValue(h,null)}catch(q){h.set("displayedValue",this.NLS_errorInvalid,!1)}}}))},this);this._attachmentEditor&&q.showAttachments&&this._attachmentEditor.showAttachments(this._currentFeature,a);(a=a.getEditSummary(h))?(this.editorTrackingInfoDiv.innerHTML=a,y.show(this.editorTrackingInfoDiv)):y.hide(this.editorTrackingInfoDiv)}}},_setFieldDomain:function(h,
b,a){if(!h)return null;var q=a.domain;b&&b.domains&&b.domains[a.name]&&!1===b.domains[a.name]instanceof p&&(q=b.domains[a.name]);if(!q)return null;q.codedValues&&0<q.codedValues.length?(h.set("store",this._toStore(l.map(q.codedValues,function(h){return{id:h.code+="",name:h.name}}))),this._setValue(h,q.codedValues[0].code)):(h.constraints={min:g.isDefined(q.minValue)?q.minValue:Number.MIN_VALUE,max:g.isDefined(q.maxValue)?q.maxValue:Number.MAX_VALUE},this._setValue(h,h.constraints.min));return q},
_setValue:function(h,b){h.set&&(h._onChangeActive=!1,h.set("value",b,!0),h._onChangeActive=!0)},_getFields:function(h){var b=h._getOutFields();if(!b)return null;h=h.fields;return"*"==b?h:l.filter(l.map(b,m.hitch(this,"_findFirst",h,"name")),g.isDefined)},_isInFields:function(h,b){return!h||!b&&!b.length?!1:l.some(b,function(b){return b.toLowerCase()===h.toLowerCase()})},_findFirst:function(h,b,a){return(h=l.filter(h,function(h){return h.hasOwnProperty(b)&&h[b]===a}))&&h.length?h[0]:null},_getLInfoFromFeatureLayer:function(h){return this._findFirst(this._layerInfos,
"layerId",h?h.id:null)},_createTable:function(){this._destroyAttributeTable();this.attributeTable.innerHTML="";this._attributes=e.create("table",{cellspacing:"0",cellpadding:"0"},this.attributeTable);var h=e.create("tbody",null,this._attributes),b=this._currentLInfo,a=this._findFirst(b.types,"id",this._currentFeature.attributes[b.typeIdField]);l.forEach(b.fieldInfos,m.hitch(this,"_createField",a,h),this);this._createOnlyFirstTime=!1},_createField:function(h,b,a){var q=this._currentLInfo,c=a.field;
if(!this._isInFields(c.name,q.hideFields)&&!this._isInFields(c.name,this._editorTrackingInfos[q.featureLayer.id])){var d=e.create("tr",null,b);b=e.create("td",{innerHTML:a.label||c.alias||c.name,"class":"atiLabel"},d);b=e.create("td",null,d);var k,d=null,p=!1;if(a.customField)e.place(a.customField.domNode||a.customField,e.create("div",null,b),"first"),k=a.customField;else if(!1===q.isEditable||!1===c.editable||!1===a.isEditable||"esriFieldTypeOID"===c.type||"esriFieldTypeGlobalID"===c.type||!this._canUpdate&&
!this._createOnlyFirstTime)p=!0;!k&&q.typeIdField&&c.name.toLowerCase()==q.typeIdField.toLowerCase()?k=this._createTypeField(c,a,b):k||(k=this._createDomainField(c,a,h,b));if(!k)switch(c.type){case "esriFieldTypeString":k=this._createStringField(c,a,b);break;case "esriFieldTypeDate":k=this._createDateField(c,a,b);a.format&&a.format.time&&(d=this._createTimeField(c,a,b));break;case "esriFieldTypeInteger":case "esriFieldTypeSmallInteger":k=this._createIntField(c,a,b);break;case "esriFieldTypeSingle":case "esriFieldTypeDouble":k=
this._createFltField(c,a,b);break;default:k=this._createStringField(c,a,b)}a.tooltip&&a.tooltip.length&&this._toolTips.push(new I({connectId:[k.id],label:a.tooltip}));k.onChange=m.hitch(this,"onFieldValueChange",a);k.set("disabled",p);d?(a.dijit=[k,d],d.onChange=m.hitch(this,"onFieldValueChange",a),d.set("disabled",p)):a.dijit=k}},_createTypeField:function(h,b,a){return(b=h.domain)&&"range"===b.type&&b.minValue===b.maxValue?new E({"class":"atiField"},e.create("div",null,a)):new B({"class":"atiField",
name:h.alias||h.name,required:!h.nullable||!1,store:this._toStore(l.map(this._currentLInfo.types,function(h){return{id:h.id,name:h.name}})),searchAttr:"name"},e.create("div",null,a))},_createDomainField:function(b,a,q,c){a=b.domain;q&&q.domains&&q.domains[b.name]&&!1===q.domains[b.name]instanceof p&&(a=q.domains[b.name]);return!a?null:a.codedValues?new B({"class":"atiField",name:b.alias||b.name,searchAttr:"name",required:!b.nullable||!1},e.create("div",null,c)):new h({"class":"atiField"},e.create("div",
null,c))},_createStringField:function(h,b,a){var q={"class":"atiField",trim:!0,maxLength:h.length};return b.stringFieldOption===L.STRING_FIELD_OPTION_TEXTAREA?(q["class"]+=" atiTextAreaField",new G(q,e.create("div",null,a))):b.stringFieldOption===L.STRING_FIELD_OPTION_RICHTEXT?(q["class"]+=" atiRichTextField",q.height="100%",q.width="100%",q.plugins=b.richTextPlugins||"bold italic underline foreColor hiliteColor | justifyLeft justifyCenter justifyRight justifyFull | insertOrderedList insertUnorderedList indent outdent | createLink".split(" "),
h=new r(q,e.create("div",null,a)),h.startup(),h):!h.nullable||!b.field||!b.field.nullable?new K({required:!0},e.create("div",null,a)):new E(q,e.create("div",null,a))},_createTimeField:function(h,b,a){h={"class":"atiField",trim:!0,constraints:{formatLength:"medium"}};this._datePackage&&(h.datePackage=this._datePackage);return new J(h,e.create("div",null,a))},_createDateField:function(h,b,a){h={"class":"atiField",trim:!0};this._datePackage&&(h.datePackage=this._datePackage);return new D(h,e.create("div",
null,a))},_createIntField:function(h,b,a){return new C({"class":"atiField",constraints:"esriFieldTypeSmallInteger"===h.type?{min:-32768,max:32767,places:0}:{places:0},invalidMessage:this.NLS_validationInt,trim:!0},e.create("div",null,a))},_createFltField:function(h,b,a){var q=/\de[-+]?\d/i,c=/[0-9]\d{0,2}(\.\d{3})*(,\d+)?$/i;return new K({validator:function(h,b){this._maskValidSubsetError=!1;this._hasBeenBlurred=!0;return""===h||null===h?!0:q.test(h)?!0:c.test(h)?("min"in b?0<=this.compare(h,b.min):
1)&&("max"in b?0>=this.compare(h,b.max):1)?!0:!1:!1},"class":"atiField",trim:!0,constraints:{places:"0,40",min:-Infinity,max:Infinity,exponent:!0},invalidMessage:this.NLS_validationFlt},e.create("div",null,a))},_toStore:function(h){return new O({data:{identifier:"id",label:"name",items:h}})},_connect:function(h,b,a){this._aiConnects.push(n.connect(h,b,a))},_getDatePackage:function(h){return null===h.datePackage?null:h.datePackage?h.datePackage:"ar"===d.locale?"dojox.date.islamic":null},_destroyAttributeTable:function(){l.forEach(this._layerInfos,
function(h){l.forEach(h.fieldInfos,function(h){var b=h.dijit;if(b){b._onChangeHandle=null;if(h.customField)return;b instanceof Array?l.forEach(b,m.hitch(this,function(h){h.destroyRecursive?h.destroyRecursive():h.destroy&&h.destroy();h._onChangeHandle=null})):b.destroyRecursive?b.destroyRecursive():b.destroy&&b.destroy()}h.dijit=null},this)},this);l.forEach(this._toolTips,function(h){h.destroy()});this._toolTips=[];this._attributes&&e.destroy(this._attributes)}});m.mixin(L,{STRING_FIELD_OPTION_RICHTEXT:"richtext",
STRING_FIELD_OPTION_TEXTAREA:"textarea",STRING_FIELD_OPTION_TEXTBOX:"textbox"});return L})},"dijit/Editor":function(){define("require dojo/_base/array dojo/_base/declare dojo/Deferred dojo/i18n dojo/dom-attr dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/keys dojo/_base/lang dojo/sniff dojo/string dojo/topic ./_Container ./Toolbar ./ToolbarSeparator ./layout/_LayoutWidget ./form/ToggleButton ./_editor/_Plugin ./_editor/plugins/EnterKeyHandling ./_editor/html ./_editor/range ./_editor/RichText ./main dojo/i18n!./_editor/nls/commands".split(" "),
function(t,m,l,n,f,d,a,c,e,w,g,y,p,x,k,v,b,s,u,r,H,z,F,M,N){function A(b){return new r({command:b.name})}function D(b){return new r({buttonClass:u,command:b.name})}l=l("dijit.Editor",M,{plugins:null,extraPlugins:null,constructor:function(){g.isArray(this.plugins)||(this.plugins=["undo","redo","|","cut","copy","paste","|","bold","italic","underline","strikethrough","|","insertOrderedList","insertUnorderedList","indent","outdent","|","justifyLeft","justifyRight","justifyCenter","justifyFull",H]);this._plugins=
[];this._editInterval=1E3*this.editActionInterval;if(y("ie")||y("trident")||y("edge"))this.events.push("onBeforeDeactivate"),this.events.push("onBeforeActivate")},postMixInProperties:function(){this.setValueDeferred=new n;this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._steps=this._steps.slice(0);this._undoedSteps=this._undoedSteps.slice(0);g.isArray(this.extraPlugins)&&(this.plugins=this.plugins.concat(this.extraPlugins));this.commands=f.getLocalization("dijit._editor",
"commands",this.lang);y("webkit")&&e.set(this.domNode,"KhtmlUserSelect","none")},startup:function(){this.inherited(arguments);this.toolbar||(this.toolbar=new v({ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,"aria-label":this.id}),this.header.appendChild(this.toolbar.domNode));m.forEach(this.plugins,this.addPlugin,this);this.setValueDeferred.resolve(!0);a.add(this.iframe.parentNode,"dijitEditorIFrameContainer");a.add(this.iframe,"dijitEditorIFrame");d.set(this.iframe,"allowTransparency",
!0);this.toolbar.startup();this.onNormalizedDisplayChanged()},destroy:function(){m.forEach(this._plugins,function(b){b&&b.destroy&&b.destroy()});this._plugins=[];this.toolbar.destroyRecursive();delete this.toolbar;this.inherited(arguments)},addPlugin:function(b,a){var c=g.isString(b)?{name:b}:g.isFunction(b)?{ctor:b}:b;if(!c.setEditor){var h={args:c,plugin:null,editor:this};c.name&&(r.registry[c.name]?h.plugin=r.registry[c.name](c):x.publish(N._scopeName+".Editor.getPlugin",h));if(!h.plugin)try{var q=
c.ctor||g.getObject(c.name)||t(c.name);q&&(h.plugin=new q(c))}catch(e){throw Error(this.id+": cannot find plugin ["+c.name+"]");}if(!h.plugin)throw Error(this.id+": cannot find plugin ["+c.name+"]");b=h.plugin}1<arguments.length?this._plugins[a]=b:this._plugins.push(b);b.setEditor(this);g.isFunction(b.setToolbar)&&b.setToolbar(this.toolbar)},resize:function(b){b&&s.prototype.resize.apply(this,arguments)},layout:function(){var b=this._contentBox.h-(this.getHeaderHeight()+this.getFooterHeight()+c.getPadBorderExtents(this.iframe.parentNode).h+
c.getMarginExtents(this.iframe.parentNode).h);this.editingArea.style.height=b+"px";this.iframe&&(this.iframe.style.height="100%");this._layoutMode=!0},_onIEMouseDown:function(b){var a,c=this.document.body,h=c.clientWidth,q=c.clientHeight,e=c.clientLeft,d=c.offsetWidth,k=c.offsetHeight,p=c.offsetLeft;/^rtl$/i.test(c.dir||"")?h<d&&(b.x>h&&b.x<d)&&(a=!0):b.x<e&&b.x>p&&(a=!0);a||q<k&&(b.y>q&&b.y<k)&&(a=!0);a||(delete this._cursorToStart,delete this._savedSelection,"BODY"==b.target.tagName&&this.defer("placeCursorAtEnd"),
this.inherited(arguments))},onBeforeActivate:function(){this._restoreSelection()},onBeforeDeactivate:function(b){this.customUndo&&this.endEditing(!0);"BODY"!=b.target.tagName&&this._saveSelection()},customUndo:!0,editActionInterval:3,beginEditing:function(b){this._inEditing||(this._inEditing=!0,this._beginEditing(b));0<this.editActionInterval&&(this._editTimer&&this._editTimer.remove(),this._editTimer=this.defer("endEditing",this._editInterval))},_steps:[],_undoedSteps:[],execCommand:function(b){if(this.customUndo&&
("undo"==b||"redo"==b))return this[b]();this.customUndo&&(this.endEditing(),this._beginEditing());var a=this.inherited(arguments);this.customUndo&&this._endEditing();return a},_pasteImpl:function(){return this._clipboardCommand("paste")},_cutImpl:function(){return this._clipboardCommand("cut")},_copyImpl:function(){return this._clipboardCommand("copy")},_clipboardCommand:function(b){var a;try{if(a=this.document.execCommand(b,!1,null),y("webkit")&&!a)throw{};}catch(c){a=p.substitute,alert(a(this.commands.systemShortcut,
[this.commands[b],a(this.commands[y("mac")?"appleKey":"ctrlKey"],[{cut:"X",copy:"C",paste:"V"}[b]])])),a=!1}return a},queryCommandEnabled:function(b){return this.customUndo&&("undo"==b||"redo"==b)?"undo"==b?1<this._steps.length:0<this._undoedSteps.length:this.inherited(arguments)},_moveToBookmark:function(b){var a=b.mark,c=b.mark;b=b.isCollapsed;var h,q,e;if(c)if(9>y("ie")||9===y("ie")&&y("quirks"))if(g.isArray(c))a=[],m.forEach(c,function(h){a.push(F.getNode(h,this.editNode))},this),this.selection.moveToBookmark({mark:a,
isCollapsed:b});else{if(c.startContainer&&c.endContainer&&(e=F.getSelection(this.window))&&e.removeAllRanges)e.removeAllRanges(),b=F.create(this.window),h=F.getNode(c.startContainer,this.editNode),q=F.getNode(c.endContainer,this.editNode),h&&q&&(b.setStart(h,c.startOffset),b.setEnd(q,c.endOffset),e.addRange(b))}else if((e=F.getSelection(this.window))&&e.removeAllRanges)e.removeAllRanges(),b=F.create(this.window),h=F.getNode(c.startContainer,this.editNode),q=F.getNode(c.endContainer,this.editNode),
h&&q&&(b.setStart(h,c.startOffset),b.setEnd(q,c.endOffset),e.addRange(b))},_changeToStep:function(b,a){this.setValue(a.text);var c=a.bookmark;c&&this._moveToBookmark(c)},undo:function(){var b=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var a=this._steps.pop();a&&0<this._steps.length&&(this.focus(),this._changeToStep(a,this._steps[this._steps.length-1]),this._undoedSteps.push(a),this.onDisplayChanged(),delete this._undoRedoActive,b=!0);delete this._undoRedoActive}return b},
redo:function(){var b=!1;if(!this._undoRedoActive){this._undoRedoActive=!0;this.endEditing(!0);var a=this._undoedSteps.pop();a&&0<this._steps.length&&(this.focus(),this._changeToStep(this._steps[this._steps.length-1],a),this._steps.push(a),this.onDisplayChanged(),b=!0);delete this._undoRedoActive}return b},endEditing:function(b){this._editTimer&&(this._editTimer=this._editTimer.remove());this._inEditing&&(this._endEditing(b),this._inEditing=!1)},_getBookmark:function(){var b=this.selection.getBookmark(),
a=[];if(b&&b.mark){var c=b.mark;if(9>y("ie")||9===y("ie")&&y("quirks")){var h=F.getSelection(this.window);if(g.isArray(c))m.forEach(b.mark,function(h){a.push(F.getIndex(h,this.editNode).o)},this),b.mark=a;else if(h){var q;h.rangeCount&&(q=h.getRangeAt(0));b.mark=q?q.cloneRange():this.selection.getBookmark()}}try{b.mark&&b.mark.startContainer&&(a=F.getIndex(b.mark.startContainer,this.editNode).o,b.mark={startContainer:a,startOffset:b.mark.startOffset,endContainer:b.mark.endContainer===b.mark.startContainer?
a:F.getIndex(b.mark.endContainer,this.editNode).o,endOffset:b.mark.endOffset})}catch(e){b.mark=null}}return b},_beginEditing:function(){0===this._steps.length&&this._steps.push({text:z.getChildrenHtml(this.editNode),bookmark:this._getBookmark()})},_endEditing:function(){var b=z.getChildrenHtml(this.editNode);this._undoedSteps=[];this._steps.push({text:b,bookmark:this._getBookmark()})},onKeyDown:function(b){!y("ie")&&(!this.iframe&&b.keyCode==w.TAB&&!this.tabIndent)&&this._saveSelection();if(this.customUndo){var a=
b.keyCode;if(b.ctrlKey&&!b.shiftKey&&!b.altKey){if(90==a||122==a){b.stopPropagation();b.preventDefault();this.undo();return}if(89==a||121==a){b.stopPropagation();b.preventDefault();this.redo();return}}this.inherited(arguments);switch(a){case w.ENTER:case w.BACKSPACE:case w.DELETE:this.beginEditing();break;case 88:case 86:if(b.ctrlKey&&!b.altKey&&!b.metaKey){this.endEditing();88==b.keyCode?this.beginEditing("cut"):this.beginEditing("paste");this.defer("endEditing",1);break}default:if(!b.ctrlKey&&!b.altKey&&
!b.metaKey&&(b.keyCode<w.F1||b.keyCode>w.F15)){this.beginEditing();break}case w.ALT:this.endEditing();break;case w.UP_ARROW:case w.DOWN_ARROW:case w.LEFT_ARROW:case w.RIGHT_ARROW:case w.HOME:case w.END:case w.PAGE_UP:case w.PAGE_DOWN:this.endEditing(!0);case w.CTRL:case w.SHIFT:case w.TAB:}}else this.inherited(arguments)},_onBlur:function(){this.inherited(arguments);this.endEditing(!0)},_saveSelection:function(){try{this._savedSelection=this._getBookmark()}catch(b){}},_restoreSelection:function(){this._savedSelection&&
(delete this._cursorToStart,this.selection.isCollapsed()&&this._moveToBookmark(this._savedSelection),delete this._savedSelection)},onClick:function(){this.endEditing(!0);this.inherited(arguments)},replaceValue:function(b){this.customUndo?this.isClosed?this.setValue(b):(this.beginEditing(),b||(b="\x26#160;"),this.setValue(b),this.endEditing()):this.inherited(arguments)},_setDisabledAttr:function(b){this.setValueDeferred.then(g.hitch(this,function(){!this.disabled&&b||!this._buttonEnabledPlugins&&b?
m.forEach(this._plugins,function(b){b.set("disabled",!0)}):this.disabled&&!b&&m.forEach(this._plugins,function(b){b.set("disabled",!1)})}));this.inherited(arguments)},_setStateClass:function(){try{this.inherited(arguments),this.document&&this.document.body&&e.set(this.document.body,"color",e.get(this.iframe,"color"))}catch(b){}}});g.mixin(r.registry,{undo:A,redo:A,cut:A,copy:A,paste:A,insertOrderedList:A,insertUnorderedList:A,indent:A,outdent:A,justifyCenter:A,justifyFull:A,justifyLeft:A,justifyRight:A,
"delete":A,selectAll:A,removeFormat:A,unlink:A,insertHorizontalRule:A,bold:D,italic:D,underline:D,strikethrough:D,subscript:D,superscript:D,"|":function(){return new r({setEditor:function(a){this.editor=a;this.button=new b({ownerDocument:a.ownerDocument})}})}});return l})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(t,m,l,n,f,d,a,c){l("dijit-legacy-requires")&&f(0,function(){t(["dijit/ToolbarSeparator"])});
return m("dijit.Toolbar",[d,c,a],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"dijit/ToolbarSeparator":function(){define(["dojo/_base/declare","dojo/dom","./_Widget","./_TemplatedMixin"],function(t,m,l,n){return t("dijit.ToolbarSeparator",[l,n],{templateString:'\x3cdiv class\x3d"dijitToolbarSeparator dijitInline" role\x3d"presentation"\x3e\x3c/div\x3e',
buildRendering:function(){this.inherited(arguments);m.setSelectable(this.domNode,!1)},isFocusable:function(){return!1}})})},"dijit/_editor/_Plugin":function(){define(["dojo/_base/connect","dojo/_base/declare","dojo/_base/lang","../Destroyable","../form/Button"],function(t,m,l,n,f){m=m("dijit._editor._Plugin",n,{constructor:function(d){this.params=d||{};l.mixin(this,this.params);this._attrPairNames={}},editor:null,iconClassPrefix:"dijitEditorIcon",button:null,command:"",useDefaultCommand:!0,buttonClass:f,
disabled:!1,getLabel:function(d){return this.editor.commands[d]},_initButton:function(){if(this.command.length){var d=this.getLabel(this.command),a=this.editor,c=this.iconClassPrefix+" "+this.iconClassPrefix+this.command.charAt(0).toUpperCase()+this.command.substr(1);this.button||(d=l.mixin({label:d,ownerDocument:a.ownerDocument,dir:a.dir,lang:a.lang,showLabel:!1,iconClass:c,dropDown:this.dropDown,tabIndex:"-1"},this.params||{}),delete d.name,this.button=new this.buttonClass(d))}this.get("disabled")&&
this.button&&this.button.set("disabled",this.get("disabled"))},destroy:function(){this.dropDown&&this.dropDown.destroyRecursive();this.inherited(arguments)},connect:function(d,a,c){this.own(t.connect(d,a,this,c))},updateState:function(){var d=this.editor,a=this.command,c,e;if(d&&d.isLoaded&&a.length){var w=this.get("disabled");if(this.button)try{e=!w&&d.queryCommandEnabled(a),this.enabled!==e&&(this.enabled=e,this.button.set("disabled",!e)),e&&"boolean"==typeof this.button.checked&&(c=d.queryCommandState(a),
this.checked!==c&&(this.checked=c,this.button.set("checked",d.queryCommandState(a))))}catch(g){console.log(g)}}},setEditor:function(d){this.editor=d;this._initButton();this.button&&this.useDefaultCommand&&(this.editor.queryCommandAvailable(this.command)?this.own(this.button.on("click",l.hitch(this.editor,"execCommand",this.command,this.commandArg))):this.button.domNode.style.display="none");this.own(this.editor.on("NormalizedDisplayChanged",l.hitch(this,"updateState")))},setToolbar:function(d){this.button&&
d.addChild(this.button)},set:function(d,a){if("object"===typeof d){for(var c in d)this.set(c,d[c]);return this}c=this._getAttrNames(d);if(this[c.s])var e=this[c.s].apply(this,Array.prototype.slice.call(arguments,1));else this._set(d,a);return e||this},get:function(d){var a=this._getAttrNames(d);return this[a.g]?this[a.g]():this[d]},_setDisabledAttr:function(d){this._set("disabled",d);this.updateState()},_getAttrNames:function(d){var a=this._attrPairNames;if(a[d])return a[d];var c=d.charAt(0).toUpperCase()+
d.substr(1);return a[d]={s:"_set"+c+"Attr",g:"_get"+c+"Attr"}},_set:function(d,a){this[d]=a}});m.registry={};return m})},"dijit/_editor/plugins/EnterKeyHandling":function(){define("dojo/_base/declare dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/_base/window dojo/window ../_Plugin ../RichText ../range".split(" "),function(t,m,l,n,f,d,a,c,e,w,g){return t("dijit._editor.plugins.EnterKeyHandling",e,{blockNodeForEnter:"BR",constructor:function(a){a&&("blockNodeForEnter"in a&&(a.blockNodeForEnter=
a.blockNodeForEnter.toUpperCase()),n.mixin(this,a))},setEditor:function(a){if(this.editor!==a)if(this.editor=a,"BR"==this.blockNodeForEnter)this.editor.customUndo=!0,a.onLoadDeferred.then(n.hitch(this,function(c){this.own(f(a.document,"keydown",n.hitch(this,function(a){if(a.keyCode==l.ENTER){var c=n.mixin({},a);c.shiftKey=!0;this.handleEnterKey(c)||(a.stopPropagation(),a.preventDefault())}})));9<=d("ie")&&10>=d("ie")&&this.own(f(a.document,"paste",n.hitch(this,function(a){setTimeout(n.hitch(this,
function(){var a=this.editor.document.selection.createRange();a.move("character",-1);a.select();a.move("character",1);a.select()}),0)})));return c}));else if(this.blockNodeForEnter){var c=n.hitch(this,"handleEnterKey");a.addKeyHandler(13,0,0,c);a.addKeyHandler(13,0,1,c);this.own(this.editor.on("KeyPressed",n.hitch(this,"onKeyPressed")))}},onKeyPressed:function(){if(this._checkListLater){if(this.editor.selection.isCollapsed()){var a=this.editor.selection.getAncestorElement("LI");if(a){d("mozilla")&&
"LI"==a.parentNode.parentNode.nodeName&&(a=a.parentNode.parentNode);var c=a.firstChild;if(c&&1==c.nodeType&&("UL"==c.nodeName||"OL"==c.nodeName))a.insertBefore(c.ownerDocument.createTextNode("\u00a0"),c),c=g.create(this.editor.window),c.setStart(a.firstChild,0),a=g.getSelection(this.editor.window,!0),a.removeAllRanges(),a.addRange(c)}else w.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter),(a=this.editor.selection.getAncestorElement(this.blockNodeForEnter))?(a.innerHTML=
this.bogusHtmlContent,9>=d("ie")&&(a=this.editor.document.selection.createRange(),a.move("character",-1),a.select())):console.error("onKeyPressed: Cannot find the new block node")}this._checkListLater=!1}this._pressedEnterInBlock&&(this._pressedEnterInBlock.previousSibling&&this.removeTrailingBr(this._pressedEnterInBlock.previousSibling),delete this._pressedEnterInBlock)},bogusHtmlContent:"\x26#160;",blockNodes:/^(?:P|H1|H2|H3|H4|H5|H6|LI)$/,handleEnterKey:function(a){var e,f,k,v,b=this.editor.document,
s,u,r;if(a.shiftKey){a=this.editor.selection.getParentElement();if(v=g.getAncestor(a,this.blockNodes)){if("LI"==v.tagName)return!0;a=g.getSelection(this.editor.window);e=a.getRangeAt(0);e.collapsed||(e.deleteContents(),a=g.getSelection(this.editor.window),e=a.getRangeAt(0));if(g.atBeginningOfContainer(v,e.startContainer,e.startOffset))s=b.createElement("br"),e=g.create(this.editor.window),v.insertBefore(s,v.firstChild),e.setStartAfter(s),a.removeAllRanges(),a.addRange(e);else if(g.atEndOfContainer(v,
e.startContainer,e.startOffset))e=g.create(this.editor.window),s=b.createElement("br"),v.appendChild(s),v.appendChild(b.createTextNode("\u00a0")),e.setStart(v.lastChild,0),a.removeAllRanges(),a.addRange(e);else return(u=e.startContainer)&&3==u.nodeType?(r=u.nodeValue,f=b.createTextNode(r.substring(0,e.startOffset)),k=b.createTextNode(r.substring(e.startOffset)),v=b.createElement("br"),""==k.nodeValue&&d("webkit")&&(k=b.createTextNode("\u00a0")),m.place(f,u,"after"),m.place(v,f,"after"),m.place(k,
v,"after"),m.destroy(u),e=g.create(this.editor.window),e.setStart(k,0),a.removeAllRanges(),a.addRange(e),!1):!0}else if(a=g.getSelection(this.editor.window),a.rangeCount){if((e=a.getRangeAt(0))&&e.startContainer)e.collapsed||(e.deleteContents(),a=g.getSelection(this.editor.window),e=a.getRangeAt(0)),(u=e.startContainer)&&3==u.nodeType?(v=e.startOffset,u.length<v&&(k=this._adjustNodeAndOffset(u,v),u=k.node,v=k.offset),r=u.nodeValue,f=b.createTextNode(r.substring(0,v)),k=b.createTextNode(r.substring(v)),
v=b.createElement("br"),k.length||(k=b.createTextNode("\u00a0")),f.length?m.place(f,u,"after"):f=u,m.place(v,f,"after"),m.place(k,v,"after"),m.destroy(u)):(0<=e.startOffset&&(s=u.childNodes[e.startOffset]),v=b.createElement("br"),k=b.createTextNode("\u00a0"),s?(m.place(v,s,"before"),m.place(k,v,"after")):(u.appendChild(v),u.appendChild(k))),e=g.create(this.editor.window),e.setStart(k,0),e.setEnd(k,k.length),a.removeAllRanges(),a.addRange(e),this.editor.selection.collapse(!0)}else w.prototype.execCommand.call(this.editor,
"inserthtml","\x3cbr\x3e");return!1}var H=!0;a=g.getSelection(this.editor.window);e=a.getRangeAt(0);e.collapsed||(e.deleteContents(),a=g.getSelection(this.editor.window),e=a.getRangeAt(0));s=g.getBlockAncestor(e.endContainer,null,this.editor.editNode);var z=s.blockNode;if(this._checkListLater=z&&("LI"==z.nodeName||"LI"==z.parentNode.nodeName))return d("mozilla")&&(this._pressedEnterInBlock=z),/^(\s|&nbsp;|&#160;|\xA0|<span\b[^>]*\bclass=['"]Apple-style-span['"][^>]*>(\s|&nbsp;|&#160;|\xA0)<\/span>)?(<br>)?$/.test(z.innerHTML)&&
(z.innerHTML="",d("webkit")&&(e=g.create(this.editor.window),e.setStart(z,0),a.removeAllRanges(),a.addRange(e)),this._checkListLater=!1),!0;if(!s.blockNode||s.blockNode===this.editor.editNode){try{w.prototype.execCommand.call(this.editor,"formatblock",this.blockNodeForEnter)}catch(l){}s={blockNode:this.editor.selection.getAncestorElement(this.blockNodeForEnter),blockContainer:this.editor.editNode};if(s.blockNode){if(s.blockNode!=this.editor.editNode&&!(s.blockNode.textContent||s.blockNode.innerHTML).replace(/^\s+|\s+$/g,
"").length)return this.removeTrailingBr(s.blockNode),!1}else s.blockNode=this.editor.editNode;a=g.getSelection(this.editor.window);e=a.getRangeAt(0)}z=b.createElement(this.blockNodeForEnter);z.innerHTML=this.bogusHtmlContent;this.removeTrailingBr(s.blockNode);k=e.endOffset;H=e.endContainer;H.length<k&&(k=this._adjustNodeAndOffset(H,k),H=k.node,k=k.offset);if(g.atEndOfContainer(s.blockNode,H,k))s.blockNode===s.blockContainer?s.blockNode.appendChild(z):m.place(z,s.blockNode,"after"),H=!1,e=g.create(this.editor.window),
e.setStart(z,0),a.removeAllRanges(),a.addRange(e),this.editor.height&&c.scrollIntoView(z);else if(g.atBeginningOfContainer(s.blockNode,e.startContainer,e.startOffset))m.place(z,s.blockNode,s.blockNode===s.blockContainer?"first":"before"),z.nextSibling&&this.editor.height&&(e=g.create(this.editor.window),e.setStart(z.nextSibling,0),a.removeAllRanges(),a.addRange(e),c.scrollIntoView(z.nextSibling)),H=!1;else{s.blockNode===s.blockContainer?s.blockNode.appendChild(z):m.place(z,s.blockNode,"after");H=
!1;s.blockNode.style&&(z.style&&s.blockNode.style.cssText)&&(z.style.cssText=s.blockNode.style.cssText);if((u=e.startContainer)&&3==u.nodeType){k=e.endOffset;u.length<k&&(k=this._adjustNodeAndOffset(u,k),u=k.node,k=k.offset);r=u.nodeValue;f=b.createTextNode(r.substring(0,k));k=b.createTextNode(r.substring(k,r.length));m.place(f,u,"before");m.place(k,u,"after");m.destroy(u);for(f=f.parentNode;f!==s.blockNode;){r=b.createElement(f.tagName);f.style&&(r.style&&f.style.cssText)&&(r.style.cssText=f.style.cssText);
"FONT"===f.tagName&&(f.color&&(r.color=f.color),f.face&&(r.face=f.face),f.size&&(r.size=f.size));for(e=k;e;)u=e.nextSibling,r.appendChild(e),e=u;m.place(r,f,"after");k=r;f=f.parentNode}e=k;if(1==e.nodeType||3==e.nodeType&&e.nodeValue)z.innerHTML="";for(f=e;e;)u=e.nextSibling,z.appendChild(e),e=u}e=g.create(this.editor.window);b=f;if("BR"!==this.blockNodeForEnter){for(;b;)v=b,b=u=b.firstChild;v&&v.parentNode?(z=v.parentNode,e.setStart(z,0),a.removeAllRanges(),a.addRange(e),this.editor.height&&c.scrollIntoView(z),
d("mozilla")&&(this._pressedEnterInBlock=s.blockNode)):H=!0}else e.setStart(z,0),a.removeAllRanges(),a.addRange(e),this.editor.height&&c.scrollIntoView(z),d("mozilla")&&(this._pressedEnterInBlock=s.blockNode)}return H},_adjustNodeAndOffset:function(a,c){for(;a.length<c&&a.nextSibling&&3==a.nextSibling.nodeType;)c-=a.length,a=a.nextSibling;return{node:a,offset:c}},removeTrailingBr:function(a){if(a=/P|DIV|LI/i.test(a.tagName)?a:this.editor.selection.getParentOfType(a,["P","DIV","LI"]))a.lastChild&&
(1<a.childNodes.length&&3==a.lastChild.nodeType&&/^[\s\xAD]*$/.test(a.lastChild.nodeValue)||"BR"==a.lastChild.tagName)&&m.destroy(a.lastChild),a.childNodes.length||(a.innerHTML=this.bogusHtmlContent)}})})},"dijit/_editor/RichText":function(){define("dojo/_base/array dojo/_base/config dojo/_base/declare dojo/_base/Deferred dojo/dom dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/dom-style dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/query dojo/domReady dojo/sniff dojo/string dojo/topic dojo/_base/unload dojo/_base/url dojo/window ../_Widget ../_CssStateMixin ../selection ./range ./html ../focus ../main".split(" "),
function(t,m,l,n,f,d,a,c,e,w,g,y,p,x,k,v,b,s,u,r,H,z,F,M,N,A,D,E,C){var B=l("dijit._editor.RichText",[F,M],{constructor:function(b){this.contentPreFilters=[];this.contentPostFilters=[];this.contentDomPreFilters=[];this.contentDomPostFilters=[];this.editingAreaStyleSheets=[];this.events=[].concat(this.events);this._keyHandlers={};b&&p.isString(b.value)&&(this.value=b.value);this.onLoadDeferred=new n},baseClass:"dijitEditor",inheritWidth:!1,focusOnLoad:!1,name:"",styleSheets:"",height:"300px",minHeight:"1em",
isClosed:!0,isLoaded:!1,_SEPARATOR:"@@**%%__RICHTEXTBOUNDRY__%%**@@",_NAME_CONTENT_SEP:"@@**%%:%%**@@",onLoadDeferred:null,isTabIndent:!1,disableSpellCheck:!1,postCreate:function(){"textarea"===this.domNode.tagName.toLowerCase()&&console.warn("RichText should not be used with the TEXTAREA tag.  See dijit._editor.RichText docs.");this.contentPreFilters=[p.trim,p.hitch(this,"_preFixUrlAttributes")].concat(this.contentPreFilters);b("mozilla")&&(this.contentPreFilters=[this._normalizeFontStyle].concat(this.contentPreFilters),
this.contentPostFilters=[this._removeMozBogus].concat(this.contentPostFilters));b("webkit")&&(this.contentPreFilters=[this._removeWebkitBogus].concat(this.contentPreFilters),this.contentPostFilters=[this._removeWebkitBogus].concat(this.contentPostFilters));if(b("ie")||b("trident"))this.contentPostFilters=[this._normalizeFontStyle].concat(this.contentPostFilters),this.contentDomPostFilters=[p.hitch(this,"_stripBreakerNodes")].concat(this.contentDomPostFilters);this.contentDomPostFilters=[p.hitch(this,
"_stripTrailingEmptyNodes")].concat(this.contentDomPostFilters);this.inherited(arguments);u.publish(C._scopeName+"._editor.RichText::init",this)},startup:function(){this.inherited(arguments);this.open();this.setupDefaultShortcuts()},setupDefaultShortcuts:function(){var h=p.hitch(this,function(b,h){return function(){return!this.execCommand(b,h)}}),a={b:h("bold"),i:h("italic"),u:h("underline"),a:h("selectall"),s:function(){this.save(!0)},m:function(){this.isTabIndent=!this.isTabIndent},1:h("formatblock",
"h1"),2:h("formatblock","h2"),3:h("formatblock","h3"),4:h("formatblock","h4"),"\\":h("insertunorderedlist")};b("ie")||(a.Z=h("redo"));for(var c in a)this.addKeyHandler(c,!0,!1,a[c])},events:["onKeyDown","onKeyUp"],captureEvents:[],_editorCommandsLocalized:!1,_localizeEditorCommands:function(){if(B._editorCommandsLocalized)this._local2NativeFormatNames=B._local2NativeFormatNames,this._native2LocalFormatNames=B._native2LocalFormatNames;else{B._editorCommandsLocalized=!0;B._local2NativeFormatNames={};
B._native2LocalFormatNames={};this._local2NativeFormatNames=B._local2NativeFormatNames;this._native2LocalFormatNames=B._native2LocalFormatNames;for(var b="div p pre h1 h2 h3 h4 h5 h6 ol ul address".split(" "),a="",e,d=0;e=b[d++];)a="l"!==e.charAt(1)?a+("\x3c"+e+"\x3e\x3cspan\x3econtent\x3c/span\x3e\x3c/"+e+"\x3e\x3cbr/\x3e"):a+("\x3c"+e+"\x3e\x3cli\x3econtent\x3c/li\x3e\x3c/"+e+"\x3e\x3cbr/\x3e");var k=c.create("div",{style:{position:"absolute",top:"0px",zIndex:10,opacity:0.01},innerHTML:a});this.ownerDocumentBody.appendChild(k);
b=p.hitch(this,function(){for(var b=k.firstChild;b;)try{this.selection.selectElement(b.firstChild);var h=b.tagName.toLowerCase();this._local2NativeFormatNames[h]=document.queryCommandValue("formatblock");this._native2LocalFormatNames[this._local2NativeFormatNames[h]]=h;b=b.nextSibling.nextSibling}catch(a){}c.destroy(k)});this.defer(b)}},open:function(h){if(!this.onLoadDeferred||0<=this.onLoadDeferred.fired)this.onLoadDeferred=new n;this.isClosed||this.close();u.publish(C._scopeName+"._editor.RichText::open",
this);1===arguments.length&&h.nodeName&&(this.domNode=h);var q=this.domNode,e;if(p.isString(this.value))e=this.value,q.innerHTML="";else if(q.nodeName&&"textarea"==q.nodeName.toLowerCase()){var k=this.textarea=q;this.name=k.name;e=k.value;q=this.domNode=this.ownerDocument.createElement("div");q.setAttribute("widgetId",this.id);k.removeAttribute("widgetId");q.cssText=k.cssText;q.className+=" "+k.className;c.place(q,k,"before");var g=p.hitch(this,function(){w.set(k,{display:"block",position:"absolute",
top:"-1000px"});if(b("ie")){var h=k.style;this.__overflow=h.overflow;h.overflow="hidden"}});b("ie")?this.defer(g,10):g();if(k.form){var s=k.value;this.reset=function(){this.getValue()!==s&&this.replaceValue(s)};x(k.form,"submit",p.hitch(this,function(){d.set(k,"disabled",this.disabled);k.value=this.getValue()}))}}else e=D.getChildrenHtml(q),q.innerHTML="";this.value=e;q.nodeName&&"LI"===q.nodeName&&(q.innerHTML=" \x3cbr\x3e");this.header=q.ownerDocument.createElement("div");q.appendChild(this.header);
this.editingArea=q.ownerDocument.createElement("div");q.appendChild(this.editingArea);this.footer=q.ownerDocument.createElement("div");q.appendChild(this.footer);this.name||(this.name=this.id+"_AUTOGEN");if(""!==this.name&&(!m.useXDomain||m.allowXdRichTextSave)){if((e=f.byId(C._scopeName+"._editor.RichText.value"))&&""!==e.value)for(var g=e.value.split(this._SEPARATOR),v=0,z;z=g[v++];)if(z=z.split(this._NAME_CONTENT_SEP),z[0]===this.name){this.value=z[1];g=g.splice(v,1);e.value=g.join(this._SEPARATOR);
break}B._globalSaveHandler||(B._globalSaveHandler={},r.addOnUnload(function(){for(var b in B._globalSaveHandler){var h=B._globalSaveHandler[b];p.isFunction(h)&&h()}}));B._globalSaveHandler[this.id]=p.hitch(this,"_saveContent")}this.isClosed=!1;e=this.editorObject=this.iframe=this.ownerDocument.createElement("iframe");e.id=this.id+"_iframe";e.style.border="none";e.style.width="100%";this._layoutMode?e.style.height="100%":7<=b("ie")?(this.height&&(e.style.height=this.height),this.minHeight&&(e.style.minHeight=
this.minHeight)):e.style.height=this.height?this.height:this.minHeight;e.frameBorder=0;e._loadFunc=p.hitch(this,function(h){this.window=h;this.document=h.document;this.selection=new N.SelectionManager(h);b("ie")&&this._localizeEditorCommands();this.onLoad(this.get("value"))});g=this._getIframeDocTxt().replace(/\\/g,"\\\\").replace(/'/g,"\\'");g=11>b("ie")?'javascript:document.open();try{parent.window;}catch(e){document.domain\x3d"'+document.domain+"\";}document.write('"+g+"');document.close()":"javascript: '"+
g+"'";this.editingArea.appendChild(e);e.src=g;"LI"===q.nodeName&&(q.lastChild.style.marginTop="-1.2em");a.add(this.domNode,this.baseClass)},_local2NativeFormatNames:{},_native2LocalFormatNames:{},_getIframeDocTxt:function(){var h=w.getComputedStyle(this.domNode),a;if(this["aria-label"])a=this["aria-label"];else{var c=k('label[for\x3d"'+this.id+'"]',this.ownerDocument)[0]||f.byId(this["aria-labelledby"],this.ownerDocument);c&&(a=c.textContent||c.innerHTML||"")}var c="\x3cdiv id\x3d'dijitEditorBody' role\x3d'textbox' aria-multiline\x3d'true' "+
(a?" aria-label\x3d'"+s.escape(a)+"'":"")+"\x3e\x3c/div\x3e",e=[h.fontWeight,h.fontSize,h.fontFamily].join(" "),d=h.lineHeight,d=0<=d.indexOf("px")?parseFloat(d)/parseFloat(h.fontSize):0<=d.indexOf("em")?parseFloat(d):"normal",r="",u=this;this.style.replace(/(^|;)\s*(line-|font-?)[^;]+/ig,function(b){b=b.replace(/^;/ig,"")+";";var h=b.split(":")[0];if(h){var h=p.trim(h),h=h.toLowerCase(),a,c="";for(a=0;a<h.length;a++){var q=h.charAt(a);switch(q){case "-":a++,q=h.charAt(a).toUpperCase();default:c+=
q}}w.set(u.domNode,c,"")}r+=b+";"});this.iframe.setAttribute("title",a);return["\x3c!DOCTYPE html\x3e","\x3chtml lang\x3d'"+(this.lang||g.locale.replace(/-.*/,""))+"'"+(this.isLeftToRight()?"":" dir\x3d'rtl'")+"\x3e\n","\x3chead\x3e\n\x3cmeta http-equiv\x3d'Content-Type' content\x3d'text/html'\x3e\n",a?"\x3ctitle\x3e"+s.escape(a)+"\x3c/title\x3e":"","\x3cstyle\x3e\n\tbody,html {\n\t\tbackground:transparent;\n\t\tpadding: 1px 0 0 0;\n\t\tmargin: -1px 0 0 0;\n\t}\n\tbody,html,#dijitEditorBody { outline: none; }html { height: 100%; width: 100%; overflow: hidden; }\n",
this.height?"\tbody,#dijitEditorBody { height: 100%; width: 100%; overflow: auto; }\n":"\tbody,#dijitEditorBody { min-height: "+this.minHeight+"; width: 100%; overflow-x: auto; overflow-y: hidden; }\n","\tbody{\n\t\ttop:0px;\n\t\tleft:0px;\n\t\tright:0px;\n\t\tfont:",e,";\n",this.height||b("opera")?"":"\t\tposition: fixed;\n","\t\tline-height:",d,";\n\t}\n\tp{ margin: 1em 0; }\n\tli \x3e ul:-moz-first-node, li \x3e ol:-moz-first-node{ padding-top: 1.2em; }\n",b("ie")||b("trident")||b("edge")?"":"\tli{ min-height:1.2em; }\n",
"\x3c/style\x3e\n",this._applyEditingAreaStyleSheets(),"\n\x3c/head\x3e\n\x3cbody role\x3d'application'",a?" aria-label\x3d'"+s.escape(a)+"'":"","onload\x3d'try{frameElement \x26\x26 frameElement._loadFunc(window,document)}catch(e){document.domain\x3d\""+document.domain+"\";frameElement._loadFunc(window,document)}' ","style\x3d'"+r+"'\x3e",c,"\x3c/body\x3e\n\x3c/html\x3e"].join("")},_applyEditingAreaStyleSheets:function(){var b=[];this.styleSheets&&(b=this.styleSheets.split(";"),this.styleSheets=
"");b=b.concat(this.editingAreaStyleSheets);this.editingAreaStyleSheets=[];for(var a="",c=0,e,d=z.get(this.ownerDocument);e=b[c++];)e=(new H(d.location,e)).toString(),this.editingAreaStyleSheets.push(e),a+='\x3clink rel\x3d"stylesheet" type\x3d"text/css" href\x3d"'+e+'"/\x3e';return a},addStyleSheet:function(b){var a=b.toString(),c=z.get(this.ownerDocument);if("."===a.charAt(0)||"/"!==a.charAt(0)&&!b.host)a=(new H(c.location,a)).toString();-1<t.indexOf(this.editingAreaStyleSheets,a)||(this.editingAreaStyleSheets.push(a),
this.onLoadDeferred.then(p.hitch(this,function(){if(this.document.createStyleSheet)this.document.createStyleSheet(a);else{var b=this.document.getElementsByTagName("head")[0],h=this.document.createElement("link");h.rel="stylesheet";h.type="text/css";h.href=a;b.appendChild(h)}})))},removeStyleSheet:function(b){var a=b.toString(),c=z.get(this.ownerDocument);if("."===a.charAt(0)||"/"!==a.charAt(0)&&!b.host)a=(new H(c.location,a)).toString();b=t.indexOf(this.editingAreaStyleSheets,a);-1!==b&&(delete this.editingAreaStyleSheets[b],
k('link[href\x3d"'+a+'"]',this.window.document).orphan())},disabled:!1,_mozSettingProps:{styleWithCSS:!1},_setDisabledAttr:function(h){h=!!h;this._set("disabled",h);if(this.isLoaded){var a=b("ie")&&(this.isLoaded||!this.focusOnLoad);a&&(this.editNode.unselectable="on");this.editNode.contentEditable=!h;this.editNode.tabIndex=h?"-1":this.tabIndex;a&&this.defer(function(){this.editNode&&(this.editNode.unselectable="off")});if(b("mozilla")&&!h&&this._mozSettingProps){h=this._mozSettingProps;for(var c in h)if(h.hasOwnProperty(c))try{this.document.execCommand(c,
!1,h[c])}catch(e){}}this._disabledOK=!0}},onLoad:function(h){this.window.__registeredWindow||(this.window.__registeredWindow=!0,this._iframeRegHandle=E.registerIframe(this.iframe));this.editNode=this.document.body.firstChild;var a=this;this.beforeIframeNode=c.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"before");this.afterIframeNode=c.place("\x3cdiv tabIndex\x3d-1\x3e\x3c/div\x3e",this.iframe,"after");this.iframe.onfocus=this.document.onfocus=function(){a.editNode.focus()};this.focusNode=
this.editNode;var e=this.events.concat(this.captureEvents),d=this.iframe?this.document:this.editNode;this.own.apply(this,t.map(e,function(b){var h=b.toLowerCase().replace(/^on/,"");return x(d,h,p.hitch(this,b))},this));this.own(x(d,"mouseup",p.hitch(this,"onClick")));b("ie")&&(this.own(x(this.document,"mousedown",p.hitch(this,"_onIEMouseDown"))),this.editNode.style.zoom=1);b("webkit")&&(this._webkitListener=this.own(x(this.document,"mouseup",p.hitch(this,"onDisplayChanged")))[0],this.own(x(this.document,
"mousedown",p.hitch(this,function(b){(b=b.target)&&(b===this.document.body||b===this.document)&&this.defer("placeCursorAtEnd")}))));if(b("ie"))try{this.document.execCommand("RespectVisibilityInDesign",!0,null)}catch(k){}this.isLoaded=!0;this.set("disabled",this.disabled);e=p.hitch(this,function(){this.setValue(h);this.onLoadDeferred&&!this.onLoadDeferred.isFulfilled()&&this.onLoadDeferred.resolve(!0);this.onDisplayChanged();this.focusOnLoad&&v(p.hitch(this,"defer","focus",this.updateInterval));this.value=
this.getValue(!0)});this.setValueDeferred?this.setValueDeferred.then(e):e()},onKeyDown:function(h){if(h.keyCode===y.SHIFT||h.keyCode===y.ALT||h.keyCode===y.META||h.keyCode===y.CTRL)return!0;if(h.keyCode===y.TAB&&this.isTabIndent&&(h.stopPropagation(),h.preventDefault(),this.queryCommandEnabled(h.shiftKey?"outdent":"indent")))this.execCommand(h.shiftKey?"outdent":"indent");if(h.keyCode==y.TAB&&!this.isTabIndent&&!h.ctrlKey&&!h.altKey)return h.shiftKey?this.beforeIframeNode.focus():this.afterIframeNode.focus(),
!0;9>b("ie")&&(h.keyCode===y.BACKSPACE&&"Control"===this.document.selection.type)&&(h.stopPropagation(),h.preventDefault(),this.execCommand("delete"));b("ff")&&(h.keyCode===y.PAGE_UP||h.keyCode===y.PAGE_DOWN)&&this.editNode.clientHeight>=this.editNode.scrollHeight&&h.preventDefault();var a=this._keyHandlers[h.keyCode],c=arguments;a&&!h.altKey&&t.some(a,function(b){if(!(b.shift^h.shiftKey)&&!(b.ctrl^(h.ctrlKey||h.metaKey)))return b.handler.apply(this,c)||h.preventDefault(),!0},this);this.defer("onKeyPressed",
1);return!0},onKeyUp:function(){},setDisabled:function(b){g.deprecated("dijit.Editor::setDisabled is deprecated",'use dijit.Editor::attr("disabled",boolean) instead',2);this.set("disabled",b)},_setValueAttr:function(b){this.setValue(b)},_setDisableSpellCheckAttr:function(b){this.document?d.set(this.document.body,"spellcheck",!b):this.onLoadDeferred.then(p.hitch(this,function(){d.set(this.document.body,"spellcheck",!b)}));this._set("disableSpellCheck",b)},addKeyHandler:function(b,a,c,e){"string"==
typeof b&&(b=b.toUpperCase().charCodeAt(0));p.isArray(this._keyHandlers[b])||(this._keyHandlers[b]=[]);this._keyHandlers[b].push({shift:c||!1,ctrl:a||!1,handler:e})},onKeyPressed:function(){this.onDisplayChanged()},onClick:function(b){this.onDisplayChanged(b)},_onIEMouseDown:function(){!this.focused&&!this.disabled&&this.focus()},_onBlur:function(a){(b("ie")||b("trident"))&&this.defer(function(){E.curNode||this.ownerDocumentBody.focus()});this.inherited(arguments);var c=this.getValue(!0);if(c!==this.value)this.onChange(c);
this._set("value",c)},_onFocus:function(b){this.disabled||(this._disabledOK||this.set("disabled",!1),this.inherited(arguments))},blur:function(){!b("ie")&&this.window.document.documentElement&&this.window.document.documentElement.focus?this.window.document.documentElement.focus():this.ownerDocumentBody.focus&&this.ownerDocumentBody.focus()},focus:function(){this.isLoaded?9>b("ie")?this.iframe.fireEvent("onfocus",document.createEventObject()):this.editNode.focus():this.focusOnLoad=!0},updateInterval:200,
_updateTimer:null,onDisplayChanged:function(){this._updateTimer&&this._updateTimer.remove();this._updateTimer=this.defer("onNormalizedDisplayChanged",this.updateInterval)},onNormalizedDisplayChanged:function(){delete this._updateTimer},onChange:function(){},_normalizeCommand:function(a,c){var e=a.toLowerCase();"formatblock"===e?b("safari")&&void 0===c&&(e="heading"):"hilitecolor"===e&&!b("mozilla")&&(e="backcolor");return e},_qcaCache:{},queryCommandAvailable:function(b){var a=this._qcaCache[b];return void 0!==
a?a:this._qcaCache[b]=this._queryCommandAvailable(b)},_queryCommandAvailable:function(a){switch(a.toLowerCase()){case "bold":case "italic":case "underline":case "subscript":case "superscript":case "fontname":case "fontsize":case "forecolor":case "hilitecolor":case "justifycenter":case "justifyfull":case "justifyleft":case "justifyright":case "delete":case "selectall":case "toggledir":case "createlink":case "unlink":case "removeformat":case "inserthorizontalrule":case "insertimage":case "insertorderedlist":case "insertunorderedlist":case "indent":case "outdent":case "formatblock":case "inserthtml":case "undo":case "redo":case "strikethrough":case "tabindent":case "cut":case "copy":case "paste":return!0;
case "blockdirltr":case "blockdirrtl":case "dirltr":case "dirrtl":case "inlinedirltr":case "inlinedirrtl":return b("ie")||b("trident")||b("edge");case "inserttable":case "insertcell":case "insertcol":case "insertrow":case "deletecells":case "deletecols":case "deleterows":case "mergecells":case "splitcell":return!b("webkit");default:return!1}},execCommand:function(a,c){var e;this.focused&&this.focus();a=this._normalizeCommand(a,c);if(void 0!==c){if("heading"===a)throw Error("unimplemented");if("formatblock"===
a&&(b("ie")||b("trident")))c="\x3c"+c+"\x3e"}var d="_"+a+"Impl";if(this[d])e=this[d](c);else if((c=1<arguments.length?c:null)||"createlink"!==a)e=this.document.execCommand(a,!1,c);this.onDisplayChanged();return e},queryCommandEnabled:function(b){if(this.disabled||!this._disabledOK)return!1;b=this._normalizeCommand(b);var a="_"+b+"EnabledImpl";return this[a]?this[a](b):this._browserQueryCommandEnabled(b)},queryCommandState:function(b){if(this.disabled||!this._disabledOK)return!1;b=this._normalizeCommand(b);
try{return this.document.queryCommandState(b)}catch(a){return!1}},queryCommandValue:function(a){if(this.disabled||!this._disabledOK)return!1;a=this._normalizeCommand(a);if(b("ie")&&"formatblock"===a)a=this._native2LocalFormatNames[this.document.queryCommandValue(a)];else if(b("mozilla")&&"hilitecolor"===a){var c;try{c=this.document.queryCommandValue("styleWithCSS")}catch(e){c=!1}this.document.execCommand("styleWithCSS",!1,!0);a=this.document.queryCommandValue(a);this.document.execCommand("styleWithCSS",
!1,c)}else a=this.document.queryCommandValue(a);return a},_sCall:function(b,a){return this.selection[b].apply(this.selection,a)},placeCursorAtStart:function(){this.focus();var a=!1;if(b("mozilla"))for(var c=this.editNode.firstChild;c;){if(3===c.nodeType){if(0<c.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(c);break}}else if(1===c.nodeType){var a=!0,e=c.tagName?c.tagName.toLowerCase():"";/br|input|img|base|meta|area|basefont|hr|link/.test(e)?this.selection.selectElement(c):
this.selection.selectElementChildren(c);break}c=c.nextSibling}else a=!0,this.selection.selectElementChildren(this.editNode);a&&this.selection.collapse(!0)},placeCursorAtEnd:function(){this.focus();var a=!1;if(b("mozilla"))for(var c=this.editNode.lastChild;c;){if(3===c.nodeType){if(0<c.nodeValue.replace(/^\s+|\s+$/g,"").length){a=!0;this.selection.selectElement(c);break}}else if(1===c.nodeType){a=!0;this.selection.selectElement(c.lastChild||c);break}c=c.previousSibling}else a=!0,this.selection.selectElementChildren(this.editNode);
a&&this.selection.collapse(!1)},getValue:function(b){return this.textarea&&(this.isClosed||!this.isLoaded)?this.textarea.value:this.isLoaded?this._postFilterContent(null,b):this.value},_getValueAttr:function(){return this.getValue(!0)},setValue:function(b){if(this.isLoaded){if(this.textarea&&(this.isClosed||!this.isLoaded))this.textarea.value=b;else{b=this._preFilterContent(b);var a=this.isClosed?this.domNode:this.editNode;a.innerHTML=b;this._preDomFilterContent(a)}this.onDisplayChanged();this._set("value",
this.getValue(!0))}else this.onLoadDeferred.then(p.hitch(this,function(){this.setValue(b)}))},replaceValue:function(a){this.isClosed?this.setValue(a):this.window&&this.window.getSelection&&!b("mozilla")?this.setValue(a):this.window&&this.window.getSelection?(a=this._preFilterContent(a),this.execCommand("selectall"),this.execCommand("inserthtml",a),this._preDomFilterContent(this.editNode)):this.document&&this.document.selection&&this.setValue(a);this._set("value",this.getValue(!0))},_preFilterContent:function(b){var a=
b;t.forEach(this.contentPreFilters,function(b){b&&(a=b(a))});return a},_preDomFilterContent:function(b){b=b||this.editNode;t.forEach(this.contentDomPreFilters,function(a){a&&p.isFunction(a)&&a(b)},this)},_postFilterContent:function(b,a){var c;p.isString(b)?c=b:(b=b||this.editNode,this.contentDomPostFilters.length&&(a&&(b=p.clone(b)),t.forEach(this.contentDomPostFilters,function(a){b=a(b)})),c=D.getChildrenHtml(b));p.trim(c.replace(/^\xA0\xA0*/,"").replace(/\xA0\xA0*$/,"")).length||(c="");t.forEach(this.contentPostFilters,
function(b){c=b(c)});return c},_saveContent:function(){var b=f.byId(C._scopeName+"._editor.RichText.value");b&&(b.value&&(b.value+=this._SEPARATOR),b.value+=this.name+this._NAME_CONTENT_SEP+this.getValue(!0))},escapeXml:function(b,a){b=b.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");a||(b=b.replace(/'/gm,"\x26#39;"));return b},getNodeHtml:function(b){g.deprecated("dijit.Editor::getNodeHtml is deprecated","use dijit/_editor/html::getNodeHtml instead",
2);return D.getNodeHtml(b)},getNodeChildrenHtml:function(b){g.deprecated("dijit.Editor::getNodeChildrenHtml is deprecated","use dijit/_editor/html::getChildrenHtml instead",2);return D.getChildrenHtml(b)},close:function(h){if(!this.isClosed){arguments.length||(h=!0);h&&this._set("value",this.getValue(!0));this.interval&&clearInterval(this.interval);this._webkitListener&&(this._webkitListener.remove(),delete this._webkitListener);b("ie")&&(this.iframe.onfocus=null);this.iframe._loadFunc=null;this._iframeRegHandle&&
(this._iframeRegHandle.remove(),delete this._iframeRegHandle);if(this.textarea){var e=this.textarea.style;e.position="";e.left=e.top="";b("ie")&&(e.overflow=this.__overflow,this.__overflow=null);this.textarea.value=this.value;c.destroy(this.domNode);this.domNode=this.textarea}else this.domNode.innerHTML=this.value;delete this.iframe;a.remove(this.domNode,this.baseClass);this.isClosed=!0;this.isLoaded=!1;delete this.editNode;delete this.focusNode;this.window&&this.window._frameElement&&(this.window._frameElement=
null);this.editorObject=this.editingArea=this.document=this.window=null}},destroy:function(){this.isClosed||this.close(!1);this._updateTimer&&this._updateTimer.remove();this.inherited(arguments);B._globalSaveHandler&&delete B._globalSaveHandler[this.id]},_removeMozBogus:function(b){return b.replace(/\stype="_moz"/gi,"").replace(/\s_moz_dirty=""/gi,"").replace(/_moz_resizing="(true|false)"/gi,"")},_removeWebkitBogus:function(b){b=b.replace(/\sclass="webkit-block-placeholder"/gi,"");b=b.replace(/\sclass="apple-style-span"/gi,
"");return b=b.replace(/<meta charset=\"utf-8\" \/>/gi,"")},_normalizeFontStyle:function(b){return b.replace(/<(\/)?strong([ \>])/gi,"\x3c$1b$2").replace(/<(\/)?em([ \>])/gi,"\x3c$1i$2")},_preFixUrlAttributes:function(b){return b.replace(/(?:(<a(?=\s).*?\shref=)("|')(.*?)\2)|(?:(<a\s.*?href=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2").replace(/(?:(<img(?=\s).*?\ssrc=)("|')(.*?)\2)|(?:(<img\s.*?src=)([^"'][^ >]+))/gi,"$1$4$2$3$5$2 _djrealurl\x3d$2$3$5$2")},_browserQueryCommandEnabled:function(a){if(!a)return!1;
if(b("ie")||b("trident")||b("edge"))return this.focused&&!this.disabled;var c=9>b("ie")?this.document.selection.createRange():this.document;try{return c.queryCommandEnabled(a)}catch(e){return!1}},_createlinkEnabledImpl:function(){var a=!0;return a=b("opera")?this.window.getSelection().isCollapsed?!0:this.document.queryCommandEnabled("createlink"):this._browserQueryCommandEnabled("createlink")},_unlinkEnabledImpl:function(){var a=!0;return a=b("mozilla")||b("webkit")||b("ie")||b("trident")||b("edge")?
this.selection.hasAncestorElement("a"):this._browserQueryCommandEnabled("unlink")},_inserttableEnabledImpl:function(){var a=!0;return a=b("mozilla")||b("webkit")?!0:this._browserQueryCommandEnabled("inserttable")},_cutEnabledImpl:function(){var a=!0;b("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("cut");return a},_copyEnabledImpl:function(){var a=!0;b("webkit")?((a=this.window.getSelection())&&(a=a.toString()),a=!!a):a=this._browserQueryCommandEnabled("copy");
return a},_pasteEnabledImpl:function(){var a=!0;return b("webkit")?!0:a=this._browserQueryCommandEnabled("paste")},_inserthorizontalruleImpl:function(a){return b("ie")?this._inserthtmlImpl("\x3chr\x3e"):this.document.execCommand("inserthorizontalrule",!1,a)},_unlinkImpl:function(a){return this.queryCommandEnabled("unlink")&&(b("mozilla")||b("webkit"))?(a=this.selection.getAncestorElement("a"),this.selection.selectElement(a),this.document.execCommand("unlink",!1,null)):this.document.execCommand("unlink",
!1,a)},_hilitecolorImpl:function(a){var c;this._handleTextColorOrProperties("hilitecolor",a)||(b("mozilla")?(this.document.execCommand("styleWithCSS",!1,!0),console.log("Executing color command."),c=this.document.execCommand("hilitecolor",!1,a),this.document.execCommand("styleWithCSS",!1,!1)):c=this.document.execCommand("hilitecolor",!1,a));return c},_backcolorImpl:function(a){b("ie")&&(a=a?a:null);var c=this._handleTextColorOrProperties("backcolor",a);c||(c=this.document.execCommand("backcolor",
!1,a));return c},_forecolorImpl:function(a){b("ie")&&(a=a?a:null);var c=!1;(c=this._handleTextColorOrProperties("forecolor",a))||(c=this.document.execCommand("forecolor",!1,a));return c},_inserthtmlImpl:function(a){a=this._preFilterContent(a);var e=!0;if(9>b("ie")){var d=this.document.selection.createRange();if("CONTROL"===this.document.selection.type.toUpperCase()){for(var k=d.item(0);d.length;)d.remove(d.item(0));k.outerHTML=a}else d.pasteHTML(a);d.select()}else if(8>b("trident")){var g=A.getSelection(this.window);
if(g&&g.rangeCount&&g.getRangeAt){d=g.getRangeAt(0);d.deleteContents();var r=c.create("div");r.innerHTML=a;for(var f,k=this.document.createDocumentFragment();a=r.firstChild;)f=k.appendChild(a);d.insertNode(k);f&&(d=d.cloneRange(),d.setStartAfter(f),d.collapse(!1),g.removeAllRanges(),g.addRange(d))}}else b("mozilla")&&!a.length?this.selection.remove():e=this.document.execCommand("inserthtml",!1,a);return e},_boldImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("bold");
c||(c=this.document.execCommand("bold",!1,a));return c},_italicImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("italic");c||(c=this.document.execCommand("italic",!1,a));return c},_underlineImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("underline");c||(c=this.document.execCommand("underline",!1,a));return c},_strikethroughImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),
c=this._adaptIEFormatAreaAndExec("strikethrough");c||(c=this.document.execCommand("strikethrough",!1,a));return c},_superscriptImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("superscript");c||(c=this.document.execCommand("superscript",!1,a));return c},_subscriptImpl:function(a){var c=!1;if(b("ie")||b("trident"))this._adaptIESelection(),c=this._adaptIEFormatAreaAndExec("subscript");c||(c=this.document.execCommand("subscript",!1,a));return c},
_fontnameImpl:function(a){var c;if(b("ie")||b("trident"))c=this._handleTextColorOrProperties("fontname",a);c||(c=this.document.execCommand("fontname",!1,a));return c},_fontsizeImpl:function(a){var c;if(b("ie")||b("trident"))c=this._handleTextColorOrProperties("fontsize",a);c||(c=this.document.execCommand("fontsize",!1,a));return c},_insertorderedlistImpl:function(a){var c=!1;if(b("ie")||b("trident")||b("edge"))c=this._adaptIEList("insertorderedlist",a);c||(c=this.document.execCommand("insertorderedlist",
!1,a));return c},_insertunorderedlistImpl:function(a){var c=!1;if(b("ie")||b("trident")||b("edge"))c=this._adaptIEList("insertunorderedlist",a);c||(c=this.document.execCommand("insertunorderedlist",!1,a));return c},getHeaderHeight:function(){return this._getNodeChildrenHeight(this.header)},getFooterHeight:function(){return this._getNodeChildrenHeight(this.footer)},_getNodeChildrenHeight:function(b){var a=0;if(b&&b.childNodes){var c;for(c=0;c<b.childNodes.length;c++)var d=e.position(b.childNodes[c]),
a=a+d.h}return a},_isNodeEmpty:function(b,a){return 1===b.nodeType?0<b.childNodes.length?this._isNodeEmpty(b.childNodes[0],a):!0:3===b.nodeType?""===b.nodeValue.substring(a):!1},_removeStartingRangeFromRange:function(b,a){if(b.nextSibling)a.setStart(b.nextSibling,0);else{for(var c=b.parentNode;c&&null==c.nextSibling;)c=c.parentNode;c&&a.setStart(c.nextSibling,0)}return a},_adaptIESelection:function(){var b=A.getSelection(this.window);if(b&&b.rangeCount&&!b.isCollapsed){for(var a=b.getRangeAt(0),c=
a.startContainer,e=a.startOffset;3===c.nodeType&&e>=c.length&&c.nextSibling;)e-=c.length,c=c.nextSibling;for(var d=null;this._isNodeEmpty(c,e)&&c!==d;)d=c,a=this._removeStartingRangeFromRange(c,a),c=a.startContainer,e=0;b.removeAllRanges();b.addRange(a)}},_adaptIEFormatAreaAndExec:function(b){var a=A.getSelection(this.window),e=this.document,d,k,g,r,f,s,u;if(b&&a&&a.isCollapsed){if(this.queryCommandValue(b)){b=this._tagNamesForCommand(b);g=a.getRangeAt(0);r=g.startContainer;3===r.nodeType&&(k=g.endOffset,
r.length<k&&(k=this._adjustNodeAndOffset(d,k),r=k.node));for(;r&&r!==this.editNode;){d=r.tagName?r.tagName.toLowerCase():"";if(-1<t.indexOf(b,d)){u=r;break}r=r.parentNode}if(u&&(d=g.startContainer,b=e.createElement(u.tagName),c.place(b,u,"after"),d&&3===d.nodeType)){k=g.endOffset;d.length<k&&(k=this._adjustNodeAndOffset(d,k),d=k.node,k=k.offset);r=d.nodeValue;g=e.createTextNode(r.substring(0,k));var w=r.substring(k,r.length);w&&(f=e.createTextNode(w));c.place(g,d,"before");f&&(s=e.createElement("span"),
s.className="ieFormatBreakerSpan",c.place(s,d,"after"),c.place(f,s,"after"),f=s);c.destroy(d);g=g.parentNode;for(d=[];g!==u;){r=g.tagName;k={tagName:r};d.push(k);r=e.createElement(r);g.style&&(r.style&&g.style.cssText)&&(r.style.cssText=g.style.cssText,k.cssText=g.style.cssText);"FONT"===g.tagName&&(g.color&&(r.color=g.color,k.color=g.color),g.face&&(r.face=g.face,k.face=g.face),g.size&&(r.size=g.size,k.size=g.size));g.className&&(r.className=g.className,k.className=g.className);if(f)for(;f;)k=f.nextSibling,
r.appendChild(f),f=k;r.tagName==g.tagName?(s=e.createElement("span"),s.className="ieFormatBreakerSpan",c.place(s,g,"after"),c.place(r,s,"after")):c.place(r,g,"after");f=r;g=g.parentNode}if(f){if(1===f.nodeType||3===f.nodeType&&f.nodeValue)b.innerHTML="";for(;f;)k=f.nextSibling,b.appendChild(f),f=k}if(d.length){k=d.pop();f=e.createElement(k.tagName);k.cssText&&f.style&&(f.style.cssText=k.cssText);k.className&&(f.className=k.className);"FONT"===k.tagName&&(k.color&&(f.color=k.color),k.face&&(f.face=
k.face),k.size&&(f.size=k.size));for(c.place(f,b,"before");d.length;)k=d.pop(),u=e.createElement(k.tagName),k.cssText&&u.style&&(u.style.cssText=k.cssText),k.className&&(u.className=k.className),"FONT"===k.tagName&&(k.color&&(u.color=k.color),k.face&&(u.face=k.face),k.size&&(u.size=k.size)),f.appendChild(u),f=u;u=e.createTextNode(".");s.appendChild(u);f.appendChild(u)}else s=e.createElement("span"),s.className="ieFormatBreakerSpan",u=e.createTextNode("."),s.appendChild(u),c.place(s,b,"before");f=
A.create(this.window);f.setStart(u,0);f.setEnd(u,u.length);a.removeAllRanges();a.addRange(f);this.selection.collapse(!1);u.parentNode.innerHTML="";b.firstChild||c.destroy(b);return!0}return!1}g=a.getRangeAt(0);if((d=g.startContainer)&&3===d.nodeType)return k=g.startOffset,d.length<k&&(k=this._adjustNodeAndOffset(d,k),d=k.node,k=k.offset),r=d.nodeValue,g=e.createTextNode(r.substring(0,k)),w=r.substring(k),""!==w&&(f=e.createTextNode(r.substring(k))),s=e.createElement("span"),u=e.createTextNode("."),
s.appendChild(u),g.length?c.place(g,d,"after"):g=d,c.place(s,g,"after"),f&&c.place(f,s,"after"),c.destroy(d),f=A.create(this.window),f.setStart(u,0),f.setEnd(u,u.length),a.removeAllRanges(),a.addRange(f),e.execCommand(b),c.place(s.firstChild,s,"before"),c.destroy(s),f.setStart(u,0),f.setEnd(u,u.length),a.removeAllRanges(),a.addRange(f),this.selection.collapse(!1),u.parentNode.innerHTML="",!0}else return!1},_adaptIEList:function(b){var a=A.getSelection(this.window);if(a.isCollapsed&&a.rangeCount&&
!this.queryCommandValue(b)){var e=a.getRangeAt(0),k=e.startContainer;if(k&&3==k.nodeType&&!e.startOffset)return e="ul","insertorderedlist"===b&&(e="ol"),b=this.document.createElement(e),e=c.create("li",null,b),c.place(b,k,"before"),e.appendChild(k),c.create("br",null,b,"after"),b=A.create(this.window),b.setStart(k,0),b.setEnd(k,k.length),a.removeAllRanges(),a.addRange(b),this.selection.collapse(!0),!0}return!1},_handleTextColorOrProperties:function(a,e){var k=A.getSelection(this.window),d=this.document,
g,r,f,u,s;e=e||null;if(a&&(k&&k.isCollapsed)&&k.rangeCount&&(r=k.getRangeAt(0),(g=r.startContainer)&&3===g.nodeType)){s=r.startOffset;g.length<s&&(r=this._adjustNodeAndOffset(g,s),g=r.node,s=r.offset);f=g.nodeValue;r=d.createTextNode(f.substring(0,s));""!==f.substring(s)&&(u=d.createTextNode(f.substring(s)));f=d.createElement("span");s=d.createTextNode(".");f.appendChild(s);d=d.createElement("span");f.appendChild(d);r.length?c.place(r,g,"after"):r=g;c.place(f,r,"after");u&&c.place(u,f,"after");c.destroy(g);
g=A.create(this.window);g.setStart(s,0);g.setEnd(s,s.length);k.removeAllRanges();k.addRange(g);if(b("webkit")){k="color";if("hilitecolor"===a||"backcolor"===a)k="backgroundColor";w.set(f,k,e);this.selection.remove();c.destroy(d);f.innerHTML="\x26#160;";this.selection.selectElement(f);this.focus()}else this.execCommand(a,e),c.place(f.firstChild,f,"before"),c.destroy(f),g.setStart(s,0),g.setEnd(s,s.length),k.removeAllRanges(),k.addRange(g),this.selection.collapse(!1),s.parentNode.removeChild(s);return!0}return!1},
_adjustNodeAndOffset:function(b,a){for(;b.length<a&&b.nextSibling&&3===b.nextSibling.nodeType;)a-=b.length,b=b.nextSibling;return{node:b,offset:a}},_tagNamesForCommand:function(b){return"bold"===b?["b","strong"]:"italic"===b?["i","em"]:"strikethrough"===b?["s","strike"]:"superscript"===b?["sup"]:"subscript"===b?["sub"]:"underline"===b?["u"]:[]},_stripBreakerNodes:function(b){if(this.isLoaded)return k(".ieFormatBreakerSpan",b).forEach(function(b){for(;b.firstChild;)c.place(b.firstChild,b,"before");
c.destroy(b)}),b},_stripTrailingEmptyNodes:function(b){for(;b.lastChild&&(/^(p|div|br)$/i.test(b.lastChild.nodeName)&&0==b.lastChild.children.length&&/^[\s\xA0]*$/.test(b.lastChild.textContent||b.lastChild.innerText||"")||3===b.lastChild.nodeType&&/^[\s\xA0]*$/.test(b.lastChild.nodeValue));)c.destroy(b.lastChild);return b},_setTextDirAttr:function(b){this._set("textDir",b);this.onLoadDeferred.then(p.hitch(this,function(){this.editNode.dir=b}))}});return B})},"dijit/_editor/range":function(){define(["dojo/_base/array",
"dojo/_base/declare","dojo/_base/lang"],function(t,m,l){var n={getIndex:function(a,c){for(var e=[],d=[],g=a,f,p;a!=c;){var l=0;for(f=a.parentNode;p=f.childNodes[l++];)if(p===a){--l;break}e.unshift(l);d.unshift(l-f.childNodes.length);a=f}if(0<e.length&&3==g.nodeType){for(p=g.previousSibling;p&&3==p.nodeType;)e[e.length-1]--,p=p.previousSibling;for(p=g.nextSibling;p&&3==p.nodeType;)d[d.length-1]++,p=p.nextSibling}return{o:e,r:d}},getNode:function(a,c){if(!l.isArray(a)||0==a.length)return c;var e=c;
t.every(a,function(a){if(0<=a&&a<e.childNodes.length)e=e.childNodes[a];else return e=null,!1;return!0});return e},getCommonAncestor:function(a,c,e){e=e||a.ownerDocument.body;var d=function(a){for(var c=[];a;)if(c.unshift(a),a!==e)a=a.parentNode;else break;return c};a=d(a);c=d(c);for(var d=Math.min(a.length,c.length),g=a[0],f=1;f<d;f++)if(a[f]===c[f])g=a[f];else break;return g},getAncestor:function(a,c,e){for(e=e||a.ownerDocument.body;a&&a!==e;){var d=a.nodeName.toUpperCase();if(c.test(d))return a;
a=a.parentNode}return null},BlockTagNames:/^(?:P|DIV|H1|H2|H3|H4|H5|H6|ADDRESS|PRE|OL|UL|LI|DT|DE)$/,getBlockAncestor:function(a,c,e){e=e||a.ownerDocument.body;c=c||n.BlockTagNames;for(var d=null,g;a&&a!==e;){var f=a.nodeName.toUpperCase();!d&&c.test(f)&&(d=a);!g&&/^(?:BODY|TD|TH|CAPTION)$/.test(f)&&(g=a);a=a.parentNode}return{blockNode:d,blockContainer:g||a.ownerDocument.body}},atBeginningOfContainer:function(a,c,e){var d=!1,g=0==e;!g&&3==c.nodeType&&/^[\s\xA0]+$/.test(c.nodeValue.substr(0,e))&&
(g=!0);if(g)for(d=!0;c&&c!==a;){if(c.previousSibling){d=!1;break}c=c.parentNode}return d},atEndOfContainer:function(a,c,e){var d=!1,g=e==(c.length||c.childNodes.length);!g&&3==c.nodeType&&/^[\s\xA0]+$/.test(c.nodeValue.substr(e))&&(g=!0);if(g)for(d=!0;c&&c!==a;){if(c.nextSibling){d=!1;break}c=c.parentNode}return d},adjacentNoneTextNode:function(a,c){for(var e=a,d=0-a.length||0,g=c?"nextSibling":"previousSibling";e&&3==e.nodeType;)d+=e.length,e=e[g];return[e,d]},create:function(a){a=a||window;return a.getSelection?
a.document.createRange():new d},getSelection:function(a,c){if(a.getSelection)return a.getSelection();var e=new f.selection(a);c||e._getCurrentSelection();return e}};if(!window.getSelection)var f=n.ie={cachedSelection:{},selection:function(a){this._ranges=[];this.addRange=function(a,e){this._ranges.push(a);e||a._select();this.rangeCount=this._ranges.length};this.removeAllRanges=function(){this._ranges=[];this.rangeCount=0};this.getRangeAt=function(a){return this._ranges[a]};this._getCurrentSelection=
function(){this.removeAllRanges();var c;c=a.document.selection.createRange();c="CONTROL"==a.document.selection.type.toUpperCase()?new d(f.decomposeControlRange(c)):new d(f.decomposeTextRange(c));c?(this.addRange(c,!0),this.isCollapsed=c.collapsed):this.isCollapsed=!0}},decomposeControlRange:function(a){var c=a.item(0),e=a.item(a.length-1);a=c.parentNode;var d=e.parentNode,c=n.getIndex(c,a).o[0],e=n.getIndex(e,d).o[0]+1;return[a,c,d,e]},getEndPoint:function(a,c){var e=a.duplicate();e.collapse(!c);
var d="EndTo"+(c?"End":"Start"),g=e.parentElement(),f,p,l;0<g.childNodes.length?t.every(g.childNodes,function(c,b){var k;if(3!=c.nodeType)if(e.moveToElementText(c),0<e.compareEndPoints(d,a))if(l&&3==l.nodeType)f=l,k=!0;else return f=g,p=b,!1;else{if(b==g.childNodes.length-1)return f=g,p=g.childNodes.length,!1}else b==g.childNodes.length-1&&(f=c,k=!0);if(k&&f){f=(k=n.adjacentNoneTextNode(f)[0])?k.nextSibling:g.firstChild;var u=n.adjacentNoneTextNode(f);k=u[0];u=u[1];k?(e.moveToElementText(k),e.collapse(!1)):
e.moveToElementText(g);e.setEndPoint(d,a);p=e.text.length-u;return!1}l=c;return!0}):(f=g,p=0);if(!c&&1==f.nodeType&&p==f.childNodes.length){var k=f.nextSibling;k&&3==k.nodeType&&(f=k,p=0)}return[f,p]},setEndPoint:function(a,c,e){a=a.duplicate();var d;if(3!=c.nodeType)if(0<e){if(d=c.childNodes[e-1])if(3==d.nodeType)c=d,e=d.length;else if(d.nextSibling&&3==d.nextSibling.nodeType)c=d.nextSibling,e=0;else{a.moveToElementText(d.nextSibling?d:c);var f=d.parentNode;d=f.insertBefore(d.ownerDocument.createTextNode(" "),
d.nextSibling);a.collapse(!1);f.removeChild(d)}}else a.moveToElementText(c),a.collapse(!0);3==c.nodeType&&(d=n.adjacentNoneTextNode(c),f=d[0],d=d[1],f?(a.moveToElementText(f),a.collapse(!1),"inherit"!=f.contentEditable&&d++):(a.moveToElementText(c.parentNode),a.collapse(!0),a.move("character",1),a.move("character",-1)),e+=d,0<e&&a.move("character",e)!=e&&console.error("Error when moving!"));return a},decomposeTextRange:function(a){var c=f.getEndPoint(a),e=c[0],d=c[1],g=c[0],c=c[1];a.htmlText.length&&
(a.htmlText==a.text?c=d+a.text.length:(c=f.getEndPoint(a,!0),g=c[0],c=c[1]));return[e,d,g,c]},setRange:function(a,c,e,d,g,l){c=f.setEndPoint(a,c,e);a.setEndPoint("StartToStart",c);if(!l)var p=f.setEndPoint(a,d,g);a.setEndPoint("EndToEnd",p||c);return a}},d=n.W3CRange=m(null,{constructor:function(){0<arguments.length?(this.setStart(arguments[0][0],arguments[0][1]),this.setEnd(arguments[0][2],arguments[0][3])):(this.startContainer=this.commonAncestorContainer=null,this.startOffset=0,this.endContainer=
null,this.endOffset=0,this.collapsed=!0)},_updateInternal:function(){this.commonAncestorContainer=this.startContainer!==this.endContainer?n.getCommonAncestor(this.startContainer,this.endContainer):this.startContainer;this.collapsed=this.startContainer===this.endContainer&&this.startOffset==this.endOffset},setStart:function(a,c){c=parseInt(c);this.startContainer===a&&this.startOffset==c||(delete this._cachedBookmark,this.startContainer=a,this.startOffset=c,this.endContainer?this._updateInternal():
this.setEnd(a,c))},setEnd:function(a,c){c=parseInt(c);this.endContainer===a&&this.endOffset==c||(delete this._cachedBookmark,this.endContainer=a,this.endOffset=c,this.startContainer?this._updateInternal():this.setStart(a,c))},setStartAfter:function(a,c){this._setPoint("setStart",a,c,1)},setStartBefore:function(a,c){this._setPoint("setStart",a,c,0)},setEndAfter:function(a,c){this._setPoint("setEnd",a,c,1)},setEndBefore:function(a,c){this._setPoint("setEnd",a,c,0)},_setPoint:function(a,c,e,d){e=n.getIndex(c,
c.parentNode).o;this[a](c.parentNode,e.pop()+d)},_getIERange:function(){var a=(this._body||this.endContainer.ownerDocument.body).createTextRange();f.setRange(a,this.startContainer,this.startOffset,this.endContainer,this.endOffset,this.collapsed);return a},getBookmark:function(){this._getIERange();return this._cachedBookmark},_select:function(){this._getIERange().select()},deleteContents:function(){var a=this.startContainer,c=this._getIERange();3===a.nodeType&&!this.startOffset&&this.setStartBefore(a);
c.pasteHTML("");this.endContainer=this.startContainer;this.endOffset=this.startOffset;this.collapsed=!0},cloneRange:function(){var a=new d([this.startContainer,this.startOffset,this.endContainer,this.endOffset]);a._body=this._body;return a},detach:function(){this.startContainer=this.commonAncestorContainer=this._body=null;this.startOffset=0;this.endContainer=null;this.endOffset=0;this.collapsed=!0}});l.setObject("dijit.range",n);return n})},"dijit/_editor/html":function(){define(["dojo/_base/array",
"dojo/_base/lang","dojo/sniff"],function(t,m,l){var n={};m.setObject("dijit._editor.html",n);var f=n.escapeXml=function(d,a){d=d.replace(/&/gm,"\x26amp;").replace(/</gm,"\x26lt;").replace(/>/gm,"\x26gt;").replace(/"/gm,"\x26quot;");a||(d=d.replace(/'/gm,"\x26#39;"));return d};n.getNodeHtml=function(d){var a=[];n.getNodeHtmlHelper(d,a);return a.join("")};n.getNodeHtmlHelper=function(d,a){switch(d.nodeType){case 1:var c=d.nodeName.toLowerCase();if(!c||"/"==c.charAt(0))return"";a.push("\x3c",c);var e=
[],w={},g;if(l("dom-attributes-explicit")||l("dom-attributes-specified-flag"))for(var m=0;g=d.attributes[m++];){var p=g.name;if("_dj"!==p.substr(0,3)&&(!l("dom-attributes-specified-flag")||g.specified)&&!(p in w)){g=g.value;if("src"==p||"href"==p)d.getAttribute("_djrealurl")&&(g=d.getAttribute("_djrealurl"));8===l("ie")&&"style"===p&&(g=g.replace("HEIGHT:","height:").replace("WIDTH:","width:"));e.push([p,g]);w[p]=g}}else{var x=(/^input$|^img$/i.test(d.nodeName)?d:d.cloneNode(!1)).outerHTML,w=x.match(/[\w-]+=("[^"]*"|'[^']*'|\S*)/gi),
x=x.substr(0,x.indexOf("\x3e"));t.forEach(w,function(a){if(a){var f=a.indexOf("\x3d");if(0<f&&(a=a.substring(0,f),"_dj"!=a.substr(0,3)))if(("src"==a||"href"==a)&&d.getAttribute("_djrealurl"))e.push([a,d.getAttribute("_djrealurl")]);else{var b;switch(a){case "style":b=d.style.cssText.toLowerCase();break;case "class":b=d.className;break;case "width":if("img"===c){(f=/width=(\S+)/i.exec(x))&&(b=f[1]);break}case "height":if("img"===c){(f=/height=(\S+)/i.exec(x))&&(b=f[1]);break}default:b=d.getAttribute(a)}null!=
b&&e.push([a,b.toString()])}}},this)}e.sort(function(a,c){return a[0]<c[0]?-1:a[0]==c[0]?0:1});for(w=0;g=e[w++];)a.push(" ",g[0],'\x3d"',"string"===typeof g[1]?f(g[1],!0):g[1],'"');switch(c){case "br":case "hr":case "img":case "input":case "base":case "meta":case "area":case "basefont":a.push(" /\x3e");break;case "script":a.push("\x3e",d.innerHTML,"\x3c/",c,"\x3e");break;default:a.push("\x3e"),d.hasChildNodes()&&n.getChildrenHtmlHelper(d,a),a.push("\x3c/",c,"\x3e")}break;case 4:case 3:a.push(f(d.nodeValue,
!0));break;case 8:a.push("\x3c!--",f(d.nodeValue,!0),"--\x3e");break;default:a.push("\x3c!-- Element not recognized - Type: ",d.nodeType," Name: ",d.nodeName,"--\x3e")}};n.getChildrenHtml=function(d){var a=[];n.getChildrenHtmlHelper(d,a);return a.join("")};n.getChildrenHtmlHelper=function(d,a){if(d)for(var c=d.childNodes||d,e=!l("ie")||c!==d,f,g=0;f=c[g++];)(!e||f.parentNode==d)&&n.getNodeHtmlHelper(f,a)};return n})},"dijit/_editor/plugins/LinkDialog":function(){define("require dojo/_base/declare dojo/dom-attr dojo/keys dojo/_base/lang dojo/on dojo/sniff dojo/query dojo/string ../_Plugin ../../form/DropDownButton ../range".split(" "),
function(t,m,l,n,f,d,a,c,e,w,g,y){var p=m("dijit._editor.plugins.LinkDialog",w,{buttonClass:g,useDefaultCommand:!1,urlRegExp:"((https?|ftps?|file)\\://|./|../|/|)(/[a-zA-Z]{1,1}:/|)(((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)*(?:[a-zA-Z](?:[-\\da-zA-Z]{0,80}[\\da-zA-Z])?)\\.?)|(((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])|(0[xX]0*[\\da-fA-F]?[\\da-fA-F]\\.){3}0[xX]0*[\\da-fA-F]?[\\da-fA-F]|(0+[0-3][0-7][0-7]\\.){3}0+[0-3][0-7][0-7]|(0|[1-9]\\d{0,8}|[1-3]\\d{9}|4[01]\\d{8}|42[0-8]\\d{7}|429[0-3]\\d{6}|4294[0-8]\\d{5}|42949[0-5]\\d{4}|429496[0-6]\\d{3}|4294967[01]\\d{2}|42949672[0-8]\\d|429496729[0-5])|0[xX]0*[\\da-fA-F]{1,8}|([\\da-fA-F]{1,4}\\:){7}[\\da-fA-F]{1,4}|([\\da-fA-F]{1,4}\\:){6}((\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])\\.){3}(\\d|[1-9]\\d|1\\d\\d|2[0-4]\\d|25[0-5])))(\\:\\d+)?(/(?:[^?#\\s/]+/)*(?:[^?#\\s/]{0,}(?:\\?[^?#\\s/]*)?(?:#.*)?)?)?",
emailRegExp:"\x3c?(mailto\\:)([!#-'*+\\-\\/-9\x3d?A-Z^-~]+[.])*[!#-'*+\\-\\/-9\x3d?A-Z^-~]+@((?:(?:[\\da-zA-Z](?:[-\\da-zA-Z]{0,61}[\\da-zA-Z])?)\\.)+(?:[a-zA-Z](?:[-\\da-zA-Z]{0,6}[\\da-zA-Z])?)\\.?)|localhost|^[^-][a-zA-Z0-9_-]*\x3e?",htmlTemplate:'\x3ca href\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" target\x3d"${targetSelect}"\x3e${textInput}\x3c/a\x3e',tag:"a",_hostRxp:/^((([^\[:]+):)?([^@]+)@)?(\[([^\]]+)\]|([^\[:]*))(:([0-9]+))?$/,_userAtRxp:/^([!#-'*+\-\/-9=?A-Z^-~]+[.])*[!#-'*+\-\/-9=?A-Z^-~]+@/i,
linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'true' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_targetSelect'\x3e${target}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cselect id\x3d'${id}_targetSelect' name\x3d'targetSelect' data-dojo-type\x3d'dijit.form.Select'\x3e\x3coption selected\x3d'selected' value\x3d'_self'\x3e${currentWindow}\x3c/option\x3e\x3coption value\x3d'_blank'\x3e${newWindow}\x3c/option\x3e\x3coption value\x3d'_top'\x3e${topWindow}\x3c/option\x3e\x3coption value\x3d'_parent'\x3e${parentWindow}\x3c/option\x3e\x3c/select\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
_initButton:function(){this.inherited(arguments);this.button.loadDropDown=f.hitch(this,"_loadDropDown");this._connectTagEvents()},_loadDropDown:function(a){t("dojo/i18n ../../TooltipDialog ../../registry ../../form/Button ../../form/Select ../../form/ValidationTextBox dojo/i18n!../../nls/common dojo/i18n!../nls/LinkDialog".split(" "),f.hitch(this,function(c,b,g){var u=this;this.tag="insertImage"==this.command?"img":"a";c=f.delegate(c.getLocalization("dijit","common",this.lang),c.getLocalization("dijit._editor",
"LinkDialog",this.lang));var r=this.dropDown=this.button.dropDown=new b({title:c[this.command+"Title"],ownerDocument:this.editor.ownerDocument,dir:this.editor.dir,execute:f.hitch(this,"setValue"),onOpen:function(){u._onOpenDialog();b.prototype.onOpen.apply(this,arguments)},onCancel:function(){setTimeout(f.hitch(u,"_onCloseDialog"),0)}});c.urlRegExp=this.urlRegExp;c.id=g.getUniqueId(this.editor.id);this._uniqueId=c.id;this._setContent(r.title+"\x3cdiv style\x3d'border-bottom: 1px black solid;padding-bottom:2pt;margin-bottom:4pt'\x3e\x3c/div\x3e"+
e.substitute(this.linkDialogTemplate,c));r.startup();this._urlInput=g.byId(this._uniqueId+"_urlInput");this._textInput=g.byId(this._uniqueId+"_textInput");this._setButton=g.byId(this._uniqueId+"_setButton");this.own(g.byId(this._uniqueId+"_cancelButton").on("click",f.hitch(this.dropDown,"onCancel")));this._urlInput&&this.own(this._urlInput.on("change",f.hitch(this,"_checkAndFixInput")));this._textInput&&this.own(this._textInput.on("change",f.hitch(this,"_checkAndFixInput")));this._urlRegExp=RegExp("^"+
this.urlRegExp+"$","i");this._emailRegExp=RegExp("^"+this.emailRegExp+"$","i");this._urlInput.isValid=f.hitch(this,function(){var b=this._urlInput.get("value");return this._urlRegExp.test(b)||this._emailRegExp.test(b)});this.own(d(r.domNode,"keydown",f.hitch(this,f.hitch(this,function(b){b&&(b.keyCode==n.ENTER&&!b.shiftKey&&!b.metaKey&&!b.ctrlKey&&!b.altKey)&&!this._setButton.get("disabled")&&(r.onExecute(),r.execute(r.get("value")))}))));a()}))},_checkAndFixInput:function(){var a=this,c=this._urlInput.get("value");
this._delayedCheck&&(clearTimeout(this._delayedCheck),this._delayedCheck=null);this._delayedCheck=setTimeout(function(){var b=c,e=!1,d=!1;b&&1<b.length&&(b=f.trim(b),0!==b.indexOf("mailto:")&&(0<b.indexOf("/")?-1===b.indexOf("://")&&"/"!==b.charAt(0)&&b.indexOf("./")&&0!==b.indexOf("../")&&a._hostRxp.test(b)&&(e=!0):a._userAtRxp.test(b)&&(d=!0)));e&&a._urlInput.set("value","http://"+b);d&&a._urlInput.set("value","mailto:"+b);a._setButton.set("disabled",!a._isValid())},250)},_connectTagEvents:function(){this.editor.onLoadDeferred.then(f.hitch(this,
function(){this.own(d(this.editor.editNode,"dblclick",f.hitch(this,"_onDblClick")))}))},_isValid:function(){return this._urlInput.isValid()&&this._textInput.isValid()},_setContent:function(a){this.dropDown.set({parserScope:"dojo",content:a})},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));return a},setValue:function(d){this._onCloseDialog();if(9>a("ie")){var f=y.getSelection(this.editor.window).getRangeAt(0).endContainer;3===f.nodeType&&(f=f.parentNode);
f&&(f.nodeName&&f.nodeName.toLowerCase()!==this.tag)&&(f=this.editor.selection.getSelectedElement(this.tag));f&&(f.nodeName&&f.nodeName.toLowerCase()===this.tag)&&this.editor.queryCommandEnabled("unlink")&&(this.editor.selection.selectElementChildren(f),this.editor.execCommand("unlink"))}d=this._checkValues(d);this.editor.execCommand("inserthtml",e.substitute(this.htmlTemplate,d));c("a",this.editor.document).forEach(function(b){!b.innerHTML&&!l.has(b,"name")&&b.parentNode.removeChild(b)},this)},_onCloseDialog:function(){this.editor.focused&&
this.editor.focus()},_getCurrentValues:function(a){var c,b,e;a&&a.tagName.toLowerCase()===this.tag?(c=a.getAttribute("_djrealurl")||a.getAttribute("href"),e=a.getAttribute("target")||"_self",b=a.textContent||a.innerText,this.editor.selection.selectElement(a,!0)):b=this.editor.selection.getSelectedText();return{urlInput:c||"",textInput:b||"",targetSelect:e||""}},_onOpenDialog:function(){var c,e;if(a("ie")){if(e=y.getSelection(this.editor.window),e.rangeCount){var b=e.getRangeAt(0);c=b.endContainer;
3===c.nodeType&&(c=c.parentNode);c&&(c.nodeName&&c.nodeName.toLowerCase()!==this.tag)&&(c=this.editor.selection.getSelectedElement(this.tag));if(!c||c.nodeName&&c.nodeName.toLowerCase()!==this.tag)if((e=this.editor.selection.getAncestorElement(this.tag))&&e.nodeName&&e.nodeName.toLowerCase()==this.tag)c=e,this.editor.selection.selectElement(c);else if(b.startContainer===b.endContainer&&(e=b.startContainer.firstChild)&&e.nodeName&&e.nodeName.toLowerCase()==this.tag)c=e,this.editor.selection.selectElement(c)}}else c=
this.editor.selection.getAncestorElement(this.tag);this.dropDown.reset();this._setButton.set("disabled",!0);this.dropDown.set("value",this._getCurrentValues(c))},_onDblClick:function(a){if(a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&l.get(a,"href"))){var c=this.editor;this.editor.selection.selectElement(a);c.onDisplayChanged();c._updateTimer&&(c._updateTimer.remove(),delete c._updateTimer);c.onNormalizedDisplayChanged();var b=this.button;setTimeout(function(){b.set("disabled",
!1);b.loadAndOpenDropDown().then(function(){b.dropDown.focus&&b.dropDown.focus()})},10)}}}),x=m("dijit._editor.plugins.ImgLinkDialog",[p],{linkDialogTemplate:"\x3ctable role\x3d'presentation'\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_urlInput'\x3e${url}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput dojoType\x3d'dijit.form.ValidationTextBox' regExp\x3d'${urlRegExp}' required\x3d'true' id\x3d'${id}_urlInput' name\x3d'urlInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3clabel for\x3d'${id}_textInput'\x3e${text}\x3c/label\x3e\x3c/td\x3e\x3ctd\x3e\x3cinput data-dojo-type\x3d'dijit.form.ValidationTextBox' required\x3d'false' id\x3d'${id}_textInput' name\x3d'textInput' data-dojo-props\x3d'intermediateChanges:true'/\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd\x3e\x3c/td\x3e\x3ctd\x3e\x3c/td\x3e\x3c/tr\x3e\x3ctr\x3e\x3ctd colspan\x3d'2'\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'submit' id\x3d'${id}_setButton'\x3e${set}\x3c/button\x3e\x3cbutton data-dojo-type\x3d'dijit.form.Button' type\x3d'button' id\x3d'${id}_cancelButton'\x3e${buttonCancel}\x3c/button\x3e\x3c/td\x3e\x3c/tr\x3e\x3c/table\x3e",
htmlTemplate:'\x3cimg src\x3d"${urlInput}" _djrealurl\x3d"${urlInput}" alt\x3d"${textInput}" /\x3e',tag:"img",_getCurrentValues:function(a){var c,b;a&&a.tagName.toLowerCase()===this.tag?(c=a.getAttribute("_djrealurl")||a.getAttribute("src"),b=a.getAttribute("alt"),this.editor.selection.selectElement(a,!0)):b=this.editor.selection.getSelectedText();return{urlInput:c||"",textInput:b||""}},_isValid:function(){return this._urlInput.isValid()},_connectTagEvents:function(){this.inherited(arguments);this.editor.onLoadDeferred.then(f.hitch(this,
function(){this.own(d(this.editor.editNode,"mousedown",f.hitch(this,"_selectTag")))}))},_selectTag:function(a){a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&this.editor.selection.selectElement(a))},_checkValues:function(a){a&&a.urlInput&&(a.urlInput=a.urlInput.replace(/"/g,"\x26quot;"));a&&a.textInput&&(a.textInput=a.textInput.replace(/"/g,"\x26quot;"));return a},_onDblClick:function(a){if(a&&a.target&&(a=a.target,(a.tagName?a.tagName.toLowerCase():"")===this.tag&&l.get(a,
"src"))){var c=this.editor;this.editor.selection.selectElement(a);c.onDisplayChanged();c._updateTimer&&(c._updateTimer.remove(),delete c._updateTimer);c.onNormalizedDisplayChanged();var b=this.button;setTimeout(function(){b.set("disabled",!1);b.loadAndOpenDropDown().then(function(){b.dropDown.focus&&b.dropDown.focus()})},10)}}});w.registry.createLink=function(){return new p({command:"createLink"})};w.registry.insertImage=function(){return new x({command:"insertImage"})};p.ImgLinkDialog=x;return p})},
"dijit/_editor/plugins/TextColor":function(){define("require dojo/colors dojo/_base/declare dojo/_base/lang ../_Plugin ../../form/DropDownButton".split(" "),function(t,m,l,n,f,d){var a=l("dijit._editor.plugins.TextColor",f,{buttonClass:d,colorPicker:"dijit/ColorPalette",useDefaultCommand:!1,_initButton:function(){this.command=this.name;this.inherited(arguments);var a=this;this.button.loadDropDown=function(e){function d(f){a.button.dropDown=new f({dir:a.editor.dir,ownerDocument:a.editor.ownerDocument,
value:a.value,onChange:function(e){a.editor.execCommand(a.command,e)},onExecute:function(){a.editor.execCommand(a.command,this.get("value"))}});e()}"string"==typeof a.colorPicker?t([a.colorPicker],d):d(a.colorPicker)}},updateState:function(){var a=this.editor,e=this.command;if(a&&a.isLoaded&&e.length){if(this.button){var d=this.get("disabled");this.button.set("disabled",d);if(d)return;var f;try{f=a.queryCommandValue(e)||""}catch(l){f=""}}""==f&&(f="#000000");"transparent"==f&&(f="#ffffff");"string"==
typeof f?-1<f.indexOf("rgb")&&(f=m.fromRgb(f).toHex()):(f=((f&255)<<16|f&65280|(f&16711680)>>>16).toString(16),f="#000000".slice(0,7-f.length)+f);this.value=f;(a=this.button.dropDown)&&(a.get&&f!==a.get("value"))&&a.set("value",f,!1)}}});f.registry.foreColor=function(c){return new a(c)};f.registry.hiliteColor=function(c){return new a(c)};return a})},"esri/dijit/editing/AttachmentEditor":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/connect dojo/_base/array dojo/_base/kernel dojo/has dojo/query dojo/io-query dojo/dom-attr dijit/_Widget dijit/_Templated dijit/ProgressBar ../../kernel ../../lang ../../domUtils dojo/text!./templates/AttachmentEditor.html dojo/i18n!../../nls/jsapi dojo/NodeList-dom".split(" "),
function(t,m,l,n,f,d,a,c,e,w,g,y,p,x,k,v,b){return t([w,g],{declaredClass:"esri.dijit.editing.AttachmentEditor",widgetsInTemplate:!0,templateString:v,_listHtml:"\x3cspan id\x3d'node_${oid}_${attid}'\x3e\x3ca href\x3d'${href}' target\x3d'_blank'\x3e${name}\x3c/a\x3e",_deleteBtnHtml:"(\x3cspan style\x3d'cursor:pointer;color:red;font-weight:bold;' class\x3d'deleteAttachment' id\x3d'${attid}');'\x3eX\x3c/span\x3e)",_endHtml:"\x3cbr/\x3e\x3c/span\x3e",_aeConnects:[],_layerEditingCapChecked:{},_layerEditingCap:{},
constructor:function(a,c){m.mixin(this,b.widgets.attachmentEditor)},startup:function(){this.inherited(arguments);this._uploadField_connect=l.connect(this._uploadField,"onchange",this,function(){0<this._uploadField.value.length&&this._addAttachment()});this._uploadFieldFocus_connect=l.connect(this._uploadField,"onfocus",m.hitch(this,function(a){k.hide(this._attachmentError)}))},destroy:function(){n.forEach(this._aeConnects,l.disconnect);l.disconnect(this._uploadField_connect);l.disconnect(this._uploadFieldFocus_connect);
this.inherited(arguments)},showAttachments:function(a,b){this._attachmentList.innerHTML=this.NLS_none;this._uploadField.value="";n.forEach(this.domNode.children,function(a,b){k.show(a)});k.hide(this._attachmentError);if(a&&(this._featureLayer=a.getLayer()||b))if("esri.layers.FeatureLayer"!==this._featureLayer.declaredClass||!this._featureLayer.getEditCapabilities){if(!b||!b.getEditCapabilities())k.hide(this._uploadForm),n.forEach(this.domNode.children,function(a,b){k.hide(a)})}else this._currentLayerId=
this._featureLayer.id,this._layerEditingCapChecked[this._currentLayerId]||(this._layerEditingCap[this._currentLayerId]=this._featureLayer.getEditCapabilities(),this._layerEditingCapChecked[this._currentLayerId]=!0),this._featureCanUpdate=this._featureLayer.getEditCapabilities({feature:a}).canUpdate,this._oid=a.attributes[this._featureLayer.objectIdField],this._getAttachments(a)},_getAttachments:function(a){this._featureLayer&&this._featureLayer.queryAttachmentInfos&&this._featureLayer.queryAttachmentInfos(this._oid,
m.hitch(this,"_onQueryAttachmentInfosComplete"))},_addAttachment:function(){k.hide(this._attachmentError);!this._featureLayer||!this._featureLayer.addAttachment?this._tempUpload=this._uploadForm:(k.show(this._attachmentProgress),this._featureLayer.addAttachment(this._oid,this._uploadForm,m.hitch(this,"_onAddAttachmentComplete"),m.hitch(this,"_onAddAttachmentError")))},_chainAttachment:function(a,b){this._tempUpload&&(k.show(this._attachmentProgress),b.addAttachment(a,this._tempUpload,m.hitch(this,
"_onAddAttachmentComplete"),m.hitch(this,"_onAddAttachmentError")));this._tempUpload=null},_deleteAttachment:function(a,b){k.show(this._attachmentProgress);this._featureLayer.deleteAttachments(a,[b],m.hitch(this,"_onDeleteAttachmentComplete"))},_onQueryAttachmentInfosComplete:function(a){var b=this._listHtml+this._deleteBtnHtml+this._endHtml;this._uploadForm.style.display="block";!this._featureCanUpdate&&this._layerEditingCap[this._currentLayerId].canUpdate||!this._layerEditingCap[this._currentLayerId].canCreate&&
!this._layerEditingCap[this._currentLayerId].canUpdate?(b=this._listHtml+this._endHtml,this._uploadForm.style.display="none"):this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&(b=this._listHtml+this._endHtml);var c=this._attachmentList;a=n.map(a,m.hitch(this,function(a){return x.substitute({href:a.url,name:a.name,oid:a.objectId,attid:a.id},b)}));c.innerHTML=a.join("")||this.NLS_none;this._updateConnects()},_onAddAttachmentComplete:function(a){k.hide(this._attachmentProgress.domNode);
var b=this._attachmentList,e=this._uploadField,d=e.value,f=d.lastIndexOf("\\");-1<f&&(d=d.substring(f+1,d.length));var d=d.replace(/\ /g,"_"),f=c.objectToQuery({gdbVersion:this._featureLayer.gdbVersion,token:this._featureLayer._getToken()}),g=this._listHtml+this._deleteBtnHtml+this._endHtml;this._layerEditingCap[this._currentLayerId].canCreate&&!this._layerEditingCap[this._currentLayerId].canUpdate&&(g=this._listHtml+this._endHtml);a=x.substitute({href:this._featureLayer._url.path+"/"+a.objectId+
"/attachments/"+a.attachmentId+(f?"?"+f:""),name:d,oid:a.objectId,attid:a.attachmentId},g);b.innerHTML=b.innerHTML==this.NLS_none?a:b.innerHTML+a;this._updateConnects();e.value=""},_onAddAttachmentError:function(a){k.hide(this._attachmentProgress.domNode);if(a&&x.isDefined(a.code)){var b=this._attachmentError;e.set(b,"innerHTML",(400===a.code?this.NLS_fileNotSupported:a.message||a.details&&a.details.length&&a.details[0])||this.NLS_error);k.show(b)}},_onDeleteAttachmentComplete:function(a){k.hide(this._attachmentProgress.domNode);
var b=this._attachmentList;if(n.every(a,function(a){return a.success})&&(f.query("#node_"+a[0].objectId+"_"+a[0].attachmentId).orphan(),!b.children||!b.children.length))b.innerHTML=this.NLS_none},_updateConnects:function(){n.forEach(this._aeConnects,l.disconnect);f.query(".deleteAttachment").forEach(function(a){this._aeConnects.push(l.connect(a,"onclick",m.hitch(this,"_deleteAttachment",this._oid,a.id)))},this)}})})},"dijit/ProgressBar":function(){define("require dojo/_base/declare dojo/dom-class dojo/_base/lang dojo/number ./_Widget ./_TemplatedMixin dojo/text!./templates/ProgressBar.html".split(" "),
function(t,m,l,n,f,d,a,c){return m("dijit.ProgressBar",[d,a],{progress:"0",value:"",maximum:100,places:0,indeterminate:!1,label:"",name:"",templateString:c,_indeterminateHighContrastImagePath:t.toUrl("./themes/a11y/indeterminate_progress.gif"),postMixInProperties:function(){this.inherited(arguments);this.params&&"value"in this.params||(this.value=this.indeterminate?Infinity:this.progress)},buildRendering:function(){this.inherited(arguments);this.indeterminateHighContrastImage.setAttribute("src",this._indeterminateHighContrastImagePath.toString());
this.update()},_setDirAttr:function(a){var c="rtl"==a.toLowerCase();l.toggle(this.domNode,"dijitProgressBarRtl",c);l.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&c);this.inherited(arguments)},update:function(a){n.mixin(this,a||{});a=this.internalProgress;var c=this.domNode,d=1;this.indeterminate?c.removeAttribute("aria-valuenow"):(-1!=String(this.progress).indexOf("%")?(d=Math.min(parseFloat(this.progress)/100,1),this.progress=d*this.maximum):(this.progress=Math.min(this.progress,
this.maximum),d=this.maximum?this.progress/this.maximum:0),c.setAttribute("aria-valuenow",this.progress));c.setAttribute("aria-labelledby",this.labelNode.id);c.setAttribute("aria-valuemin",0);c.setAttribute("aria-valuemax",this.maximum);this.labelNode.innerHTML=this.report(d);l.toggle(this.domNode,"dijitProgressBarIndeterminate",this.indeterminate);l.toggle(this.domNode,"dijitProgressBarIndeterminateRtl",this.indeterminate&&!this.isLeftToRight());a.style.width=100*d+"%";this.onChange()},_setValueAttr:function(a){this._set("value",
a);Infinity==a?this.update({indeterminate:!0}):this.update({indeterminate:!1,progress:a})},_setLabelAttr:function(a){this._set("label",a);this.update()},_setIndeterminateAttr:function(a){this._set("indeterminate",a);this.update()},report:function(a){return this.label?this.label:this.indeterminate?"\x26#160;":f.format(a,{type:"percent",places:this.places,locale:this.lang})},onChange:function(){}})})},"esri/dijit/editing/Util":function(){define(["dojo/_base/lang","dojo/_base/array","dojo/has","../../kernel"],
function(t,m,l,n){t={};return t={findFeatures:function(f,d,a){var c=d.objectIdField;d=m.filter(d.graphics,function(a){return m.some(f,function(d){return a.attributes[c]===d.objectId})});if(a)a(d);else return d},getSelection:function(f){var d=[];m.forEach(f,function(a){a=a.getSelectedFeatures();m.forEach(a,function(a){d.push(a)})});return d}}})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(t,m,l){return t("dijit.form.DateTextBox",l,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",
popupClass:m,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),function(t,m,l,n,f,d,a,c,e,w,g,y,p,x,k,v,b){var s=n("dijit.Calendar",[p,x,k],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",
incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){c.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new s._MonthDropDownButton({id:this.id+"_mddb",tabIndex:-1,onMonthSelect:w.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);
this.own(g(this.domNode,"keydown",w.hitch(this,"_onKeyDown")),g(this.dateRowsNode,"mouseover",w.hitch(this,"_onDayMouseOver")),g(this.dateRowsNode,"mouseout",w.hitch(this,"_onDayMouseOut")),g(this.dateRowsNode,"mousedown",w.hitch(this,"_onDayMouseDown")),g(this.dateRowsNode,"mouseup",w.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var b=new this.dateClassObj(this.currentFocus);b.setDate(1);b.setMonth(a);a=this.dateModule.getDaysInMonth(b);var c=this.currentFocus.getDate();b.setDate(Math.min(c,
a));this._setCurrentFocusAttr(b)},_onDayMouseOver:function(a){if((a=d.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!d.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode))d.add(a,"dijitCalendarHoveredDate"),this._currentNode=a},_onDayMouseOut:function(a){this._currentNode&&!(a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode)&&(a="dijitCalendarHoveredDate",d.contains(this._currentNode,"dijitCalendarActiveDate")&&
(a+=" dijitCalendarActiveDate"),d.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){if((a=a.target.parentNode)&&a.dijitDateValue&&!d.contains(a,"dijitCalendarDisabledDate"))d.add(a,"dijitCalendarActiveDate"),this._currentNode=a},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&d.remove(a,"dijitCalendarActiveDate")},handleKey:function(a){var b=-1,c,d=this.currentFocus;switch(a.keyCode){case e.RIGHT_ARROW:b=1;case e.LEFT_ARROW:c="day";this.isLeftToRight()||
(b*=-1);break;case e.DOWN_ARROW:b=1;case e.UP_ARROW:c="week";break;case e.PAGE_DOWN:b=1;case e.PAGE_UP:c=a.ctrlKey||a.altKey?"year":"month";break;case e.END:d=this.dateModule.add(d,"month",1),c="day";case e.HOME:d=new this.dateClassObj(d);d.setDate(1);break;default:return!0}c&&(d=this.dateModule.add(d,c,b));this._setCurrentFocusAttr(d);return!1},_onKeyDown:function(a){this.handleKey(a)||(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},
getClassForDate:function(){}});s._MonthDropDownButton=n("dijit.Calendar._MonthDropDownButton",b,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new s._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.dropDown.set("months",b);this.containerNode.innerHTML=(6==y("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+
"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});s._MonthDropDown=n("dijit.Calendar._MonthDropDown",[x,v,k],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(b){this.domNode.innerHTML="";t.forEach(b,function(b,c){a.create("div",{className:"dijitCalendarMonthLabel",month:c,innerHTML:b},this.domNode)._cssState=
"dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(f.get(a.target,"month"))},onChange:function(){}});return s})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),function(t,m,l,n,f,d,a,c,e,w,g,y,p,x,k){var v=m("dijit.CalendarLite",
[p,x],{templateString:k,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',
value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",dayOffset:-1,currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var c=new this.dateClassObj(a);c.setHours(0,0,0,0);c.getDate()<a.getDate()&&(c=this.dateModule.add(c,"hour",1));return c}return null},_setValueAttr:function(a,
c){"string"==typeof a&&(a=d.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(c||"undefined"==typeof c))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){a&&(a=new this.dateClassObj(a),a.setHours(1,0,0,0));return a},_setText:function(a,c){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(c))},
_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),c=a.getDay(),e=this.dateModule.getDaysInMonth(a),d=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),f=new this.dateClassObj,k=0<=this.dayOffset?this.dayOffset:l.getFirstDayOfWeek(this.lang);k>c&&(k-=7);if(!this.summary){var g=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",g[a.getMonth()])}this._date2cell={};t.forEach(this.dateCells,
function(g,p){var v=p+k,w=new this.dateClassObj(a),l="dijitCalendar",C=0;v<c?(v=d-c+v+1,C=-1,l+="Previous"):v>=c+e?(v=v-c-e+1,C=1,l+="Next"):(v=v-c+1,l+="Current");C&&(w=this.dateModule.add(w,"month",C));w.setDate(v);this.dateModule.compare(w,f,"date")||(l="dijitCalendarCurrentDate "+l);this.isDisabledDate(w,this.lang)?(l="dijitCalendarDisabledDate "+l,g.setAttribute("aria-disabled","true")):(l="dijitCalendarEnabledDate "+l,g.removeAttribute("aria-disabled"),g.setAttribute("aria-selected","false"));
(C=this.getClassForDate(w,this.lang))&&(l=C+" "+l);g.className=l+"Month dijitCalendarDateTemplate";l=w.valueOf();this._date2cell[l]=g;g.dijitDateValue=l;this._setText(this.dateLabels[p],w.getDateLocalized?w.getDateLocalized(this.lang):w.getDate())},this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);this.monthWidget.set("month",a);var c=a.getFullYear()-1,e=new this.dateClassObj;t.forEach(["previous","current","next"],function(a){e.setFullYear(c++);this._setText(this[a+
"YearLabelNode"],this.dateLocaleModule.format(e,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?e.getObject(a.datePackage,!1):n;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?e.getObject(a.datePackage+".locale",!1):f},_createMonthWidget:function(){return v._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},
buildRendering:function(){var b=this.dowTemplateString,c=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),e=0<=this.dayOffset?this.dayOffset:l.getFirstDayOfWeek(this.lang);this.dayCellsHtml=y.substitute([b,b,b,b,b,b,b].join(""),{d:""},function(){return c[e++%7]});b=y.substitute(this.weekTemplateString,{d:this.dateTemplateString});this.dateRowsHtml=[b,b,b,b,b,b].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);a.setSelectable(this.domNode,!1);b=new this.dateClassObj(this.currentFocus);
this.monthWidget=this._createMonthWidget();this.set("currentFocus",b,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var a=e.hitch(this,function(a,b,c){this[a].dojoClick=!0;return w(this[a],"click",e.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,b,c))}))});this.own(a("incrementMonth","month",1),a("decrementMonth","month",-1),a("nextYearLabelNode","year",1),a("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,
c){var e=this.currentFocus,d=this._getNodeByDate(e);a=this._patchDate(a);this._set("currentFocus",a);if(!this._date2cell||0!=this.dateModule.difference(e,a,"month"))this._populateGrid(),this._populateControls(),this._markSelectedDates([this.value]);e=this._getNodeByDate(a);e.setAttribute("tabIndex",this.tabIndex);(this.focused||c)&&e.focus();d&&d!=e&&(g("webkit")?d.setAttribute("tabIndex","-1"):d.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();
a.preventDefault();for(a=a.target;a&&!a.dijitDateValue;a=a.parentNode);a&&!c.contains(a,"dijitCalendarDisabledDate")&&this.set("value",a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function d(a,b){c.toggle(b,"dijitCalendarSelectedDate",a);b.setAttribute("aria-selected",a?"true":"false")}t.forEach(this._selectedCells||[],e.partial(d,!1));this._selectedCells=t.filter(t.map(a,this._getNodeByDate,
this),function(a){return a});t.forEach(this._selectedCells,e.partial(d,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});v._MonthWidget=m("dijit.CalendarLite._MonthWidget",p,{_setMonthAttr:function(a){var c=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a),e=6==g("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+t.map(c,function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=e+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+
c[a.getMonth()]+"\x3c/div\x3e"}});return v})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),function(t,m,l,n,f,d,a,c){new Date("X");return n("dijit.form._DateTimeTextBox",[d,a],{templateString:c,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:m.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);
this._set("type","text")},compare:function(a,c){var d=this._isInvalidDate(a),f=this._isInvalidDate(c);if(d||f)return d&&f?0:!d?1:-1;var d=this.format(a,this._unboundedConstraints),f=this.format(c,this._unboundedConstraints),p=this.parse(d,this._unboundedConstraints),l=this.parse(f,this._unboundedConstraints);return d==f?0:t.compare(p,l,this._selector)},autoWidth:!0,format:function(a,c){return!a?"":this.dateLocaleModule.format(a,c)},parse:function(a,c){return this.dateLocaleModule.parse(a,c)||(this._isEmpty(a)?
null:void 0)},serialize:function(a,c){a.toGregorian&&(a=a.toGregorian());return l.toISOString(a,c)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(a){a=a||{};this.dateModule=a.datePackage?f.getObject(a.datePackage,!1):t;this.dateClassObj=this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=a.datePackage?f.getObject(a.datePackage+".locale",!1):m;this._set("pattern",
this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(a){a.selector=this._selector;a.fullYear=!0;var c=l.fromISOString;"string"==typeof a.min&&(a.min=c(a.min),this.dateClassObj instanceof Date||(a.min=new this.dateClassObj(a.min)));
"string"==typeof a.max&&(a.max=c(a.max),this.dateClassObj instanceof Date||(a.max=new this.dateClassObj(a.max)));this.inherited(arguments);this._unboundedConstraints=f.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(a){return!a||isNaN(a)||"object"!=typeof a||a.toString()==this._invalidDate},_setValueAttr:function(a,c,d){void 0!==a&&("string"==typeof a&&(a=l.fromISOString(a)),this._isInvalidDate(a)&&(a=null),a instanceof Date&&!(this.dateClassObj instanceof Date)&&(a=new this.dateClassObj(a)));
this.inherited(arguments,[a,c,d]);this.value instanceof Date&&(this.filterString="");!1!==c&&this.dropDown&&this.dropDown.set("value",a,!1)},_set:function(a,c){if("value"==a){c instanceof Date&&!(this.dateClassObj instanceof Date)&&(c=new this.dateClassObj(c));var d=this._get("value");if(d instanceof this.dateClassObj&&0==this.compare(c,d))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(a){this._isInvalidDate(a)&&(a=new this.dateClassObj);this._set("dropDownDefaultValue",a)},
openDropDown:function(a){this.dropDown&&this.dropDown.destroy();var c=f.isString(this.popupClass)?f.getObject(this.popupClass,!1):this.popupClass,d=this,l=this.get("value");this.dropDown=new c({onChange:function(a){d.set("value",a,!0)},id:this.id+"_popup",dir:d.dir,lang:d.lang,value:l,textDir:d.textDir,currentFocus:!this._isInvalidDate(l)?l:this.dropDownDefaultValue,constraints:d.constraints,filterString:d.filterString,datePackage:d.datePackage,isDisabledDate:function(a){return!d.rangeCheck(a,d.constraints)}});
this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(a,c){this._setValueAttr(this.parse(a,this.constraints),c,a)}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(t,m,l,n,f){return t("dijit.form.FilteringSelect",[n,f],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||
!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(d,a,c,e){a&&a[this.searchAttr]!==this._lastQuery||!a&&d.length&&this.store.getIdentity(d[0])!=this._lastQuery||(d.length?this.set("item",d[0],e):this.set("value","",e||void 0===e&&!this.focused,this.textbox.value,null))},_openResultList:function(d,a,c){a[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},
_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(d,a,c,e){this._onChangeActive||(a=null);if(void 0===e){if(null===d||""===d)if(d="",!m.isString(c)){this._setDisplayedValueAttr(c||"",a);return}var f=this;this._lastQuery=d;l(this.store.get(d),function(c){f._callbackSetLabel(c?[c]:[],void 0,void 0,a)})}else this.valueNode.value=d,this.inherited(arguments,[d,a,c,e])},_setItemAttr:function(d,a,c){this.inherited(arguments);this._lastDisplayedValue=
this.textbox.value},_getDisplayQueryString:function(d){return d.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(d,a){null==d&&(d="");if(!this._created){if(!("displayedValue"in this.params))return;a=!1}if(this.store){this.closeDropDown();var c=m.clone(this.query),e=this._getDisplayQueryString(d),f;this.store._oldAPI?f=e:(f=this._patternToRegExp(e),f.toString=function(){return e});this._lastQuery=c[this.searchAttr]=f;this._lastDisplayedValue=this.textbox.value=d;this._set("displayedValue",
d);var g=this,n={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};m.mixin(n,this.fetchProperties);this._fetchHandle=this.store.query(c,n);l(this._fetchHandle,function(d){g._fetchHandle=null;g._callbackSetLabel(d||[],c,n,a)},function(a){g._fetchHandle=null;g._cancelingQuery||console.error("dijit.form.FilteringSelect: "+a.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/SimpleTextarea":function(){define(["dojo/_base/declare","dojo/dom-class","dojo/sniff",
"./TextBox"],function(t,m,l,n){return t("dijit.form.SimpleTextarea",n,{baseClass:"dijitTextBox dijitTextArea",rows:"3",cols:"20",templateString:"\x3ctextarea ${!nameAttrSetting} data-dojo-attach-point\x3d'focusNode,containerNode,textbox' autocomplete\x3d'off'\x3e\x3c/textarea\x3e",postMixInProperties:function(){!this.value&&this.srcNodeRef&&(this.value=this.srcNodeRef.value);this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);l("ie")&&this.cols&&m.add(this.textbox,"dijitTextAreaCols")},
filter:function(f){f&&(f=f.replace(/\r/g,""));return this.inherited(arguments)},_onInput:function(f){if(this.maxLength){var d=parseInt(this.maxLength),a=this.textbox.value.replace(/\r/g,""),d=a.length-d;if(0<d){var c=this.textbox;if(c.selectionStart){var e=c.selectionStart,m=0;l("opera")&&(m=(this.textbox.value.substring(0,e).match(/\r/g)||[]).length);this.textbox.value=a.substring(0,e-d-m)+a.substring(e-m);c.setSelectionRange(e-d,e-d)}else this.ownerDocument.selection&&(c.focus(),a=this.ownerDocument.selection.createRange(),
a.moveStart("character",-d),a.text="",a.select())}}this.inherited(arguments)}})})},"dijit/form/TimeTextBox":function(){define(["dojo/_base/declare","dojo/keys","dojo/_base/lang","../_TimePicker","./_DateTimeTextBox"],function(t,m,l,n,f){return t("dijit.form.TimeTextBox",f,{baseClass:"dijitTextBox dijitComboBox dijitTimeTextBox",popupClass:n,_selector:"time",value:new Date(""),maxHeight:-1,openDropDown:function(d){this.inherited(arguments);this.dropDown.on("input",l.hitch(this,function(){this.set("value",
this.dropDown.get("value"),!1)}))},_onInput:function(){this.inherited(arguments);var d=this.get("displayedValue");this.filterString=d&&!this.parse(d,this.constraints)?d.toLowerCase():"";this._opened&&this.closeDropDown();this.openDropDown()}})})},"dijit/_TimePicker":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/sniff dojo/query dojo/mouse dojo/on ./_WidgetBase ./form/_ListMouseMixin".split(" "),
function(t,m,l,n,f,d,a,c,e,w,g,y,p,x,k,v){return f("dijit._TimePicker",[k,v],{baseClass:"dijitTimePicker",pickerMin:"T00:00:00",pickerMax:"T23:59:59",clickableIncrement:"T00:15:00",visibleIncrement:"T01:00:00",value:new Date,_visibleIncrement:2,_clickableIncrement:1,_totalIncrements:10,constraints:{},serialize:n.toISOString,buildRendering:function(){this.inherited(arguments);this.timeMenu=this.containerNode=this.domNode},setValue:function(a){c.deprecated("dijit._TimePicker:setValue() is deprecated.  Use set('value', ...) instead.",
"","2.0");this.set("value",a)},_setValueAttr:function(a){this._set("value",a);this._showText()},_setFilterStringAttr:function(a){this._set("filterString",a);this._showText()},isDisabledDate:function(){return!1},_getFilteredNodes:function(a,c,d,e){a=this.ownerDocument.createDocumentFragment();for(c=0;c<this._maxIncrement;c++)(d=this._createOption(c))&&a.appendChild(d);return a},_showText:function(){var a=n.fromISOString;this.domNode.innerHTML="";this._clickableIncrementDate=a(this.clickableIncrement);
this._visibleIncrementDate=a(this.visibleIncrement);var c=3600*this._clickableIncrementDate.getHours()+60*this._clickableIncrementDate.getMinutes()+this._clickableIncrementDate.getSeconds(),d=3600*this._visibleIncrementDate.getHours()+60*this._visibleIncrementDate.getMinutes()+this._visibleIncrementDate.getSeconds();(this.value||this.currentFocus).getTime();this._refDate=a(this.pickerMin);this._refDate.setFullYear(1970,0,1);this._clickableIncrement=1;this._visibleIncrement=d/c;a=a(this.pickerMax);
a.setFullYear(1970,0,1);a=0.0010*(a.getTime()-this._refDate.getTime());this._maxIncrement=Math.ceil((a+1)/c);c=this._getFilteredNodes();!c.firstChild&&this.filterString?(this.filterString="",this._showText()):this.domNode.appendChild(c)},constructor:function(){this.constraints={}},postMixInProperties:function(){this.inherited(arguments);this._setConstraintsAttr(this.constraints)},_setConstraintsAttr:function(a){for(var c in{clickableIncrement:1,visibleIncrement:1,pickerMin:1,pickerMax:1})c in a&&
(this[c]=a[c]);a.locale||(a.locale=this.lang)},_createOption:function(b){var c=new Date(this._refDate),d=this._clickableIncrementDate;c.setHours(c.getHours()+d.getHours()*b,c.getMinutes()+d.getMinutes()*b,c.getSeconds()+d.getSeconds()*b);"time"==this.constraints.selector&&c.setFullYear(1970,0,1);var e=l.format(c,this.constraints);if(this.filterString&&0!==e.toLowerCase().indexOf(this.filterString))return null;d=this.ownerDocument.createElement("div");d.className=this.baseClass+"Item";d.date=c;d.idx=
b;a.create("div",{"class":this.baseClass+"ItemInner",innerHTML:e},d);e=1>b%this._visibleIncrement&&-1<b%this._visibleIncrement;b=!e&&!(b%this._clickableIncrement);e?d.className+=" "+this.baseClass+"Marker":b&&(d.className+=" "+this.baseClass+"Tick");this.isDisabledDate(c)&&(d.className+=" "+this.baseClass+"ItemDisabled");this.value&&!m.compare(this.value,c,this.constraints.selector)&&(d.selected=!0,d.className+=" "+this.baseClass+"ItemSelected",this._selectedDiv=d,e?d.className+=" "+this.baseClass+
"MarkerSelected":b&&(d.className+=" "+this.baseClass+"TickSelected"),this._highlightOption(d,!0));return d},onOpen:function(){this.inherited(arguments);this.set("selected",this._selectedDiv)},_onOptionSelected:function(a,c){var d=a.target.date||a.target.parentNode.date;d&&!this.isDisabledDate(d)&&(this._set("value",d),this.emit("input"),c&&(this._highlighted_option=null,this.set("value",d),this.onChange(d)))},onChange:function(){},_highlightOption:function(a,c){if(a){if(c)this._highlighted_option&&
this._highlightOption(this._highlighted_option,!1),this._highlighted_option=a;else{if(this._highlighted_option!==a)return;this._highlighted_option=null}d.toggle(a,this.baseClass+"ItemHover",c);d.contains(a,this.baseClass+"Marker")?d.toggle(a,this.baseClass+"MarkerHover",c):d.toggle(a,this.baseClass+"TickHover",c)}},handleKey:function(a){if(a.keyCode==e.DOWN_ARROW)return this.selectNextNode(),this._onOptionSelected({target:this._highlighted_option},!1),a.stopPropagation(),a.preventDefault(),!1;if(a.keyCode==
e.UP_ARROW)return this.selectPreviousNode(),this._onOptionSelected({target:this._highlighted_option},!1),a.stopPropagation(),a.preventDefault(),!1;if(a.keyCode==e.ENTER||a.keyCode===e.TAB){if(!this._keyboardSelected&&a.keyCode===e.TAB)return!0;this._highlighted_option&&this._onOptionSelected({target:this._highlighted_option},!0);return a.keyCode===e.TAB}},onHover:function(a){this._highlightOption(a,!0)},onUnhover:function(a){this._highlightOption(a,!1)},onSelect:function(a){this._highlightOption(a,
!0)},onDeselect:function(a){this._highlightOption(a,!1)},onClick:function(a){this._onOptionSelected({target:a},!0)}})})},"dojox/date/islamic":function(){define(["dojox/main","dojo/_base/lang","dojo/date","./islamic/Date"],function(t,m,l,n){var f=m.getObject("date.islamic",!0,t);f.getDaysInMonth=function(d){return d.getDaysInIslamicMonth(d.getMonth(),d.getFullYear())};f.compare=function(d,a,c){d instanceof n&&(d=d.toGregorian());a instanceof n&&(a=a.toGregorian());return l.compare.apply(null,arguments)};
f.add=function(d,a,c){var e=new n(d);switch(a){case "day":e.setDate(d.getDate()+c);break;case "weekday":var f=d.getDay();if(5>f+c&&0<f+c)e.setDate(d.getDate()+c);else{var g=a=0;5==f?(f=4,g=0<c?-1:1):6==f&&(f=4,g=0<c?-2:2);var f=0<c?5-f-1:-f,l=c-f,p=parseInt(l/5);0!=l%5&&(a=0<c?2:-2);e.setDate(d.getDate()+(a+7*p+l%5+f)+g)}break;case "year":e.setFullYear(d.getFullYear()+c);break;case "week":e.setDate(d.getDate()+7*c);break;case "month":d=d.getMonth();e.setMonth(d+c);break;case "hour":e.setHours(d.getHours()+
c);break;case "minute":e._addMinutes(c);break;case "second":e._addSeconds(c);break;case "millisecond":e._addMilliseconds(c)}return e};f.difference=function(d,a,c){a=a||new n;c=c||"day";var e=a.getFullYear()-d.getFullYear(),l=1;switch(c){case "weekday":e=Math.round(f.difference(d,a,"day"));l=parseInt(f.difference(d,a,"week"));c=e%7;if(0==c)e=5*l;else{var g=0,m=d.getDay();a=a.getDay();l=parseInt(e/7);c=e%7;d=new n(d);d.setDate(d.getDate()+7*l);d=d.getDay();if(0<e)switch(!0){case 5==m:g=-1;break;case 6==
m:g=0;break;case 5==a:g=-1;break;case 6==a:g=-2;break;case 5<d+c:g=-2}else if(0>e)switch(!0){case 5==m:g=0;break;case 6==m:g=1;break;case 5==a:g=2;break;case 6==a:g=1;break;case 0>d+c:g=2}e=e+g-2*l}l=e;break;case "year":l=e;break;case "month":c=a.toGregorian()>d.toGregorian()?a:d;g=a.toGregorian()>d.toGregorian()?d:a;l=c.getMonth();m=g.getMonth();if(0==e)l=c.getMonth()-g.getMonth();else{l=12-m+l;e=g.getFullYear()+1;c=c.getFullYear();for(e;e<c;e++)l+=12}a.toGregorian()<d.toGregorian()&&(l=-l);break;
case "week":l=parseInt(f.difference(d,a,"day")/7);break;case "day":l/=24;case "hour":l/=60;case "minute":l/=60;case "second":l/=1E3;case "millisecond":l*=a.toGregorian().getTime()-d.toGregorian().getTime()}return Math.round(l)};return f})},"dojox/date/islamic/Date":function(){define(["dojo/_base/lang","dojo/_base/declare","dojo/date"],function(t,m,l){var n=m("dojox.date.islamic.Date",null,{_date:0,_month:0,_year:0,_hours:0,_minutes:0,_seconds:0,_milliseconds:0,_day:0,_GREGORIAN_EPOCH:1721425.5,_ISLAMIC_EPOCH:1948439.5,
constructor:function(){var f=arguments.length;f?1==f?(f=arguments[0],"number"==typeof f&&(f=new Date(f)),f instanceof Date?this.fromGregorian(f):""==f?this._date=new Date(""):(this._year=f._year,this._month=f._month,this._date=f._date,this._hours=f._hours,this._minutes=f._minutes,this._seconds=f._seconds,this._milliseconds=f._milliseconds)):3<=f&&(this._year+=arguments[0],this._month+=arguments[1],this._date+=arguments[2],this._hours+=arguments[3]||0,this._minutes+=arguments[4]||0,this._seconds+=
arguments[5]||0,this._milliseconds+=arguments[6]||0):this.fromGregorian(new Date)},getDate:function(){return this._date},getMonth:function(){return this._month},getFullYear:function(){return this._year},getDay:function(){return this.toGregorian().getDay()},getHours:function(){return this._hours},getMinutes:function(){return this._minutes},getSeconds:function(){return this._seconds},getMilliseconds:function(){return this._milliseconds},setDate:function(f){f=parseInt(f);if(!(0<f&&f<=this.getDaysInIslamicMonth(this._month,
this._year))){var d;if(0<f)for(d=this.getDaysInIslamicMonth(this._month,this._year);f>d;f-=d,d=this.getDaysInIslamicMonth(this._month,this._year))this._month++,12<=this._month&&(this._year++,this._month-=12);else for(d=this.getDaysInIslamicMonth(0<=this._month-1?this._month-1:11,0<=this._month-1?this._year:this._year-1);0>=f;d=this.getDaysInIslamicMonth(0<=this._month-1?this._month-1:11,0<=this._month-1?this._year:this._year-1))this._month--,0>this._month&&(this._year--,this._month+=12),f+=d}this._date=
f;return this},setFullYear:function(f){this._year=+f},setMonth:function(f){this._year+=Math.floor(f/12);this._month=0<f?Math.floor(f%12):Math.floor((f%12+12)%12)},setHours:function(){var f=arguments.length,d=0;1<=f&&(d=parseInt(arguments[0]));2<=f&&(this._minutes=parseInt(arguments[1]));3<=f&&(this._seconds=parseInt(arguments[2]));4==f&&(this._milliseconds=parseInt(arguments[3]));for(;24<=d;)this._date++,f=this.getDaysInIslamicMonth(this._month,this._year),this._date>f&&(this._month++,12<=this._month&&
(this._year++,this._month-=12),this._date-=f),d-=24;this._hours=d},_addMinutes:function(f){f+=this._minutes;this.setMinutes(f);this.setHours(this._hours+parseInt(f/60));return this},_addSeconds:function(f){f+=this._seconds;this.setSeconds(f);this._addMinutes(parseInt(f/60));return this},_addMilliseconds:function(f){f+=this._milliseconds;this.setMilliseconds(f);this._addSeconds(parseInt(f/1E3));return this},setMinutes:function(f){this._minutes=f%60;return this},setSeconds:function(f){this._seconds=
f%60;return this},setMilliseconds:function(f){this._milliseconds=f%1E3;return this},toString:function(){if(isNaN(this._date))return"Invalidate Date";var f=new Date;f.setHours(this._hours);f.setMinutes(this._minutes);f.setSeconds(this._seconds);f.setMilliseconds(this._milliseconds);return this._month+" "+this._date+" "+this._year+" "+f.toTimeString()},toGregorian:function(){var f=this._year,f=this._date+Math.ceil(29.5*this._month)+354*(f-1)+Math.floor((3+11*f)/30)+this._ISLAMIC_EPOCH-1,f=Math.floor(f-
0.5)+0.5,d=f-this._GREGORIAN_EPOCH,a=Math.floor(d/146097),c=this._mod(d,146097),d=Math.floor(c/36524),e=this._mod(c,36524),c=Math.floor(e/1461),e=this._mod(e,1461),e=Math.floor(e/365),a=400*a+100*d+4*c+e;4==d||4==e||a++;d=f-(this._GREGORIAN_EPOCH+365*(a-1)+Math.floor((a-1)/4)-Math.floor((a-1)/100)+Math.floor((a-1)/400));c=this._GREGORIAN_EPOCH-1+365*(a-1)+Math.floor((a-1)/4)-Math.floor((a-1)/100)+Math.floor((a-1)/400)+Math.floor(739/12+(l.isLeapYear(new Date(a,3,1))?-1:-2)+1);c=f<c?0:l.isLeapYear(new Date(a,
3,1))?1:2;d=Math.floor((12*(d+c)+373)/367);c=this._GREGORIAN_EPOCH-1+365*(a-1)+Math.floor((a-1)/4)-Math.floor((a-1)/100)+Math.floor((a-1)/400)+Math.floor((367*d-362)/12+(2>=d?0:l.isLeapYear(new Date(a,d-1,1))?-1:-2)+1);return new Date(a,d-1,f-c+1,this._hours,this._minutes,this._seconds,this._milliseconds)},fromGregorian:function(f){f=new Date(f);var d=f.getFullYear(),a=f.getMonth(),c=f.getDate(),d=this._GREGORIAN_EPOCH-1+365*(d-1)+Math.floor((d-1)/4)+-Math.floor((d-1)/100)+Math.floor((d-1)/400)+Math.floor((367*
(a+1)-362)/12+(2>=a+1?0:l.isLeapYear(f)?-1:-2)+c),d=Math.floor(d)+0.5,d=d-this._ISLAMIC_EPOCH,a=Math.floor((30*d+10646)/10631),c=Math.ceil((d-29-this._yearStart(a))/29.5),c=Math.min(c,11);this._date=Math.ceil(d-this._monthStart(a,c))+1;this._month=c;this._year=a;this._hours=f.getHours();this._minutes=f.getMinutes();this._seconds=f.getSeconds();this._milliseconds=f.getMilliseconds();this._day=f.getDay();return this},valueOf:function(){return this.toGregorian().valueOf()},_yearStart:function(f){return 354*
(f-1)+Math.floor((3+11*f)/30)},_monthStart:function(f,d){return Math.ceil(29.5*d)+354*(f-1)+Math.floor((3+11*f)/30)},_civilLeapYear:function(f){return 11>(14+11*f)%30},getDaysInIslamicMonth:function(f,d){var a=0,a=29+(f+1)%2;11==f&&this._civilLeapYear(d)&&a++;return a},_mod:function(f,d){return f-d*Math.floor(f/d)}});n.getDaysInIslamicMonth=function(f){return(new n).getDaysInIslamicMonth(f.getMonth(),f.getFullYear())};return n})},"dojox/date/islamic/locale":function(){define("dojox/main dojo/_base/lang dojo/_base/array dojo/date dojo/i18n dojo/regexp dojo/string ./Date dojo/i18n!dojo/cldr/nls/islamic".split(" "),
function(t,m,l,n,f,d,a,c,e){function w(c,d,b,e,f){return f.replace(/([a-z])\1*/ig,function(b){var e,g,l=b.charAt(0);b=b.length;var p=["abbr","wide","narrow"];switch(l){case "G":e=d.eraAbbr[0];break;case "y":e=String(c.getFullYear());break;case "M":e=c.getMonth();3>b?(e+=1,g=!0):(l=["months-format",p[b-3]].join("-"),e=d[l][e]);break;case "d":e=c.getDate(!0);g=!0;break;case "E":e=c.getDay();3>b?(e+=1,g=!0):(l=["days-format",p[b-3]].join("-"),e=d[l][e]);break;case "a":e=12>c.getHours()?"am":"pm";e=d["dayPeriods-format-wide-"+
e];break;case "h":case "H":case "K":case "k":g=c.getHours();switch(l){case "h":e=g%12||12;break;case "H":e=g;break;case "K":e=g%12;break;case "k":e=g||24}g=!0;break;case "m":e=c.getMinutes();g=!0;break;case "s":e=c.getSeconds();g=!0;break;case "S":e=Math.round(c.getMilliseconds()*Math.pow(10,b-3));g=!0;break;case "z":if(e=n.getTimezoneName(c.toGregorian()))break;b=4;case "Z":e=c.toGregorian().getTimezoneOffset();e=[0>=e?"+":"-",a.pad(Math.floor(Math.abs(e)/60),2),a.pad(Math.abs(e)%60,2)];4==b&&(e.splice(0,
0,"GMT"),e.splice(3,0,":"));e=e.join("");break;default:throw Error("dojox.date.islamic.locale.formatPattern: invalid pattern char: "+f);}g&&(e=a.pad(e,b));return e})}function g(a,c,b,d){var e=function(a){return a};c=c||e;b=b||e;d=d||e;var f=a.match(/(''|[^'])+/g),g="'"==a.charAt(0);l.forEach(f,function(a,d){a?(f[d]=(g?b:c)(a),g=!g):f[d]=""});return d(f.join(""))}function y(a,c,b,e){e=d.escapeString(e);f.normalizeLocale(b.locale);return e.replace(/([a-z])\1*/ig,function(d){var e;e=d.charAt(0);var f=
d.length,g="";b.strict?1<f&&(g="0{"+(f-1)+"}"):g="0?";switch(e){case "y":e="\\d+";break;case "M":e=2<f?"\\S+ ?\\S+":g+"[1-9]|1[0-2]";break;case "d":e="[12]\\d|"+g+"[1-9]|3[01]";break;case "E":e="\\S+";break;case "h":e=g+"[1-9]|1[0-2]";break;case "k":e=g+"\\d|1[01]";break;case "H":e=g+"\\d|1\\d|2[0-3]";break;case "K":e=g+"[1-9]|1\\d|2[0-4]";break;case "m":case "s":e=g+"\\d|[0-5]\\d";break;case "S":e="\\d{"+f+"}";break;case "a":f=b.am||c["dayPeriods-format-wide-am"];g=b.pm||c["dayPeriods-format-wide-pm"];
b.strict?e=f+"|"+g:(e=f+"|"+g,f!=f.toLowerCase()&&(e+="|"+f.toLowerCase()),g!=g.toLowerCase()&&(e+="|"+g.toLowerCase()));break;default:e=".*"}a&&a.push(d);return"("+e+")"}).replace(/[\xa0 ]/g,"[\\s\\xa0]")}var p=m.getObject("date.islamic.locale",!0,t);p.format=function(a,c){c=c||{};var b=f.normalizeLocale(c.locale),d=c.formatLength||"short",e=p._getIslamicBundle(b),r=[],b=m.hitch(this,w,a,e,b,c.fullYear);if("year"==c.selector)return a.getFullYear();if("time"!=c.selector){var l=c.datePattern||e["dateFormat-"+
d];l&&r.push(g(l,b))}"date"!=c.selector&&(d=c.timePattern||e["timeFormat-"+d])&&r.push(g(d,b));return r.join(" ")};p.regexp=function(a){return p._parseInfo(a).regexp};p._parseInfo=function(a){a=a||{};var c=f.normalizeLocale(a.locale),c=p._getIslamicBundle(c),b=a.formatLength||"short",d=a.datePattern||c["dateFormat-"+b],b=a.timePattern||c["timeFormat-"+b],e=[];return{regexp:g("date"==a.selector?d:"time"==a.selector?b:"undefined"==typeof b?d:d+" "+b,m.hitch(this,y,e,c,a)),tokens:e,bundle:c}};p.parse=
function(a,d){a=a.replace(/[\u200E\u200F\u202A\u202E]/g,"");d||(d={});var b=p._parseInfo(d),e=b.tokens,g=b.bundle,b=b.regexp.replace(/[\u200E\u200F\u202A\u202E]/g,""),b=RegExp("^"+b+"$").exec(a);f.normalizeLocale(d.locale);if(!b)return null;var r=[1389,0,1,0,0,0,0],m="",z=["abbr","wide","narrow"];l.every(b,function(a,b){if(!b)return!0;var c=e[b-1],f=c.length;switch(c.charAt(0)){case "y":r[0]=Number(a);break;case "M":if(2<f){if(c=g["months-format-"+z[f-3]].concat(),d.strict||(a=a.replace(".","").toLowerCase(),
c=l.map(c,function(a){return a?a.replace(".","").toLowerCase():a})),a=l.indexOf(c,a),-1==a)return!1}else a--;r[1]=Number(a);break;case "D":r[1]=0;case "d":r[2]=Number(a);break;case "a":c=d.am||g["dayPeriods-format-wide-am"];f=d.pm||g["dayPeriods-format-wide-pm"];if(!d.strict){var k=/\./g;a=a.replace(k,"").toLowerCase();c=c.replace(k,"").toLowerCase();f=f.replace(k,"").toLowerCase()}if(d.strict&&a!=c&&a!=f)return!1;m=a==f?"p":a==c?"a":"";break;case "K":24==a&&(a=0);case "h":case "H":case "k":r[3]=
Number(a);break;case "m":r[4]=Number(a);break;case "s":r[5]=Number(a);break;case "S":r[6]=Number(a)}return!0});b=+r[3];"p"===m&&12>b?r[3]=b+12:"a"===m&&12==b&&(r[3]=0);return new c(r[0],r[1],r[2],r[3],r[4],r[5],r[6])};var x=[];p.addCustomFormats=function(a,c){x.push({pkg:a,name:c})};p._getIslamicBundle=function(a){var c={};l.forEach(x,function(b){b=f.getLocalization(b.pkg,b.name,a);c=m.mixin(c,b)},this);return c};p.addCustomFormats("dojo.cldr","islamic");p.getNames=function(a,c,b,d,e){var f;d=p._getIslamicBundle(d);
a=[a,b,c];"standAlone"==b&&(b=a.join("-"),f=d[b],1==f[0]&&(f=void 0));a[1]="format";return(f||d[a.join("-")]).concat()};p.weekDays=p.getNames("days","wide","format");p.months=p.getNames("months","wide","format");return p})},"widgets/SituationAwareness/js/SummaryInfo":function(){define("dojo/_base/declare dojo/Evented dojo/_base/array dojo/_base/lang dojo/_base/Color dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-style dojo/number dojo/on dojo/has dijit/form/Button jimu/dijit/Popup jimu/CSVUtils jimu/utils esri/config esri/geometry/geometryEngine esri/geometry/mathUtils esri/geometry/Point esri/geometry/webMercatorUtils esri/graphic esri/layers/FeatureLayer esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/Font esri/symbols/TextSymbol esri/tasks/query".split(" "),
function(t,m,l,n,f,d,a,c,e,w,g,y,p,x,k,v,b,s,u,r,H,z,F,M,N,A,D,E){return t("SummaryInfo",[m],{summaryLayer:null,summaryFields:[],summaryIds:[],summaryFeatures:[],summaryGeom:null,tabNum:null,symbolField:null,graphicsLayer:null,lyrRenderer:null,lyrSymbol:null,constructor:function(a,b,c){this.tab=a;this.container=b;this.parent=c;this.config=c.config;this.graphicsLayer=null},updateForIncident:function(b,c,d,e){this.tabNum=e;this.container.innerHTML="";a.add(this.container,"loading");this.summaryIds=
[];this.summaryFeatures=[];this.summaryGeom=c.geometry;if(0<this.tab.tabLayers.length){var f;"undefined"!==typeof this.tab.tabLayers[0].infoTemplate?(this.summaryLayer=this.tab.tabLayers[0],f=new F(this.summaryLayer.url),f.infoTemplate=this.tab.tabLayers[0].infoTemplate,this.tab.tabLayers.push(f),this._initGraphicsLayer(d),this.summaryFields=this._getFields(this.summaryLayer),n.hitch(this,this._queryFeatures(c.geometry))):(f=new F(this.tab.tabLayers[0].url),g(f,"load",n.hitch(this,function(){this.summaryLayer=
f;if(-1<this.tab.tabLayers[0].url.indexOf("MapServer"))for(var a=this.tab.tabLayers[0].url.split("MapServer/")[1],b=this.parent.map.itemInfo.itemData.operationalLayers,e=0;e<b.length;e++){var g=b[e];if("undefined"!==typeof g.layerObject&&g.layerObject.infoTemplates&&(g=g.layerObject.infoTemplates[a])){f.infoTemplate=g.infoTemplate;break}}this.tab.tabLayers.push(f);this._initGraphicsLayer(d);this.summaryFields=this._getFields(this.summaryLayer);n.hitch(this,this._queryFeatures(c.geometry))})))}},_initGraphicsLayer:function(a){null!==
a&&(this.graphicsLayer=a,this.graphicsLayer.clear(),this.summaryLayer&&this.summaryLayer.renderer&&(this.lyrRenderer=this.summaryLayer.renderer,this.graphicsLayer.renderer=this.lyrRenderer,"undefined"!==typeof this.summaryLayer.renderer.attributeField?this.symbolField=this.summaryLayer.renderer.attributeField:this.lyrSymbol=this.lyrRenderer.symbol))},_queryFeatures:function(a){var b=new E;b.geometry=a;this.summaryLayer.queryIds(b,n.hitch(this,function(a){a?(this.summaryIds=a,0<this.summaryIds.length?
this._queryFeaturesByIds():this._processResults()):this._processResults()}))},_queryFeaturesByIds:function(){var b=this.summaryLayer.maxRecordCount||1E3,c=this.summaryIds.slice(0,b);this.summaryIds.splice(0,b);var b=new E,d=!1;l.some(this.summaryFields,n.hitch(this,function(a){if("area"===a.type||"length"===a.type||this.graphicsLayer)return d=!0}));b.returnGeometry=d;var e=[];l.forEach(this.summaryFields,function(a){e.push(a.field)});this.symbolField&&e.push(this.symbolField);b.outFields=!0===this.config.csvAllFields||
"true"===this.config.csvAllFields?["*"]:e;b.objectIds=c;this.summaryLayer.queryFeatures(b,n.hitch(this,function(b){b.features&&(this.summaryFeatures=this.summaryFeatures.concat(b.features));this._processResults();0<this.summaryIds.length?(this.SA_SAT_download&&a.replace(this.SA_SAT_download,"processing","download"),this._queryFeaturesByIds()):this.SA_SAT_download&&a.replace(this.SA_SAT_download,"download","processing")}))},_prepResults:function(){for(var a=0;a<this.summaryFields.length;a++){var b=
this.summaryFields[a],c=b.field,d=b.total;switch(b.type){case "count":d=this.summaryFeatures.length;break;case "area":d=this._getArea();break;case "length":d=this._getLength();break;case "sum":d=this._getSum(c);break;case "avg":d=this._getSum(c)/this.summaryFeatures.length;break;case "min":d=this._getMin(c);break;case "max":d=this._getMax(c)}b.total=d}},_sortResults:function(a){return function(b,c){return b.attributes[a]<c.attributes[a]?-1:b.attributes[a]>c.attributes[a]?1:0}},_getSum:function(a){var b=
0;l.forEach(this.summaryFeatures,function(c){b+=c.attributes[a]});return b},_getMin:function(a){this.summaryFeatures.sort(this._sortResults(a));return this.summaryFeatures[0].attributes[a]},_getMax:function(a){this.summaryFeatures.sort(this._sortResults(a));this.summaryFeatures.reverse();return this.summaryFeatures[0].attributes[a]},_getArea:function(){var a=0,b=n.clone(this.config.distanceSettings);b.miles=109413;b.kilometers=109414;b.feet=109405;b.meters=109404;b.yards=109442;b.nauticalMiles=109409;
var c=b[this.config.distanceUnits];l.forEach(this.summaryFeatures,n.hitch(this,function(b){b=s.intersect(b.geometry,this.summaryGeom);null!==b&&(a+=s.geodesicArea(b,c))}));return a},_getLength:function(){var a=0,b=this.config.distanceSettings[this.config.distanceUnits];l.forEach(this.summaryFeatures,n.hitch(this,function(c){c=s.intersect(c.geometry,this.summaryGeom);null!==c&&(a+=s.geodesicLength(c,b))}));return a},_processResults:function(){this._prepResults();this.container.innerHTML="";a.remove(this.container,
"loading");if(0===this.summaryFeatures.length)this.container.innerHTML=this.parent.nls.noFeaturesFound;else{var b=this.summaryFields,d=0,e=c.create("div",{style:"width:"+220*(b.length+1)+"px;"},this.container);a.add(e,"SAT_tabPanelContent");var f=c.create("div",{},e);a.add(f,"SATcol");f=c.create("div",{"data-dojo-attach-point":"SA_SAT_download",innerHTML:this.parent.nls.downloadCSV},f);a.add(f,["btnExport","download"]);g(f,"click",n.hitch(this,this._exportToCSV));for(f=0;f<b.length;f++){var d=b[f],
k=v.stripHTML(d.alias?d.alias:"")+"\x3cbr/\x3e",d=d.alias===this.parent.nls.area||d.alias===this.parent.nls.length?d.total:Math.round(d.total);isNaN(d)&&(d=0);var r=c.create("div",{"class":"SATcol"},e),l=c.create("div",{style:"max-height: 60px;"},r);c.create("div",{"class":" SATcolWrap",style:"max-height: 30px; overflow: hidden;",innerHTML:k},l);c.create("div",{"class":" colSummary",innerHTML:w.format(d)},r)}if(null!==this.graphicsLayer){this.graphicsLayer.clear();this.tab.tabLayers[1].clear();if(this.summaryFeatures)for(b=
0;b<this.summaryFeatures.length;b++)e=this.summaryFeatures[b],this.lyrSymbol?e.symbol=this.lyrSymbol:this.graphicsLayer.renderer&&(f=this.graphicsLayer.renderer.getSymbol(e),e.symbol=f),this.graphicsLayer.add(e),this.tab.tabLayers[1].add(e);this.graphicsLayer.setVisibility(!0);this.parent._toggleTabLayersNew(this.tabNum);this.tab.restore&&this.emit("summary-complete",{bubbles:!0,cancelable:!0,tab:this.tabNum})}}},_exportToCSV:function(){if(0===this.summaryFeatures.length)return!1;var a;a=this.tab.label?
this.tab.label:this.tab.layers;var b=[],c=[];l.forEach(this.summaryFeatures,function(a){b.push(a.attributes)});if(!0===this.config.csvAllFields||"true"===this.config.csvAllFields)for(var d in b[0])c.push(d);else for(d=0;d<this.summaryFields.length;d++)c.push(this.summaryFields[d].field);d=this.summaryLayer.fields;if(this.summaryLayer&&this.summaryLayer.loaded&&d){var e={};if(this.parent.opLayers&&this.parent.opLayers._layerInfos){var f=this.parent.opLayers.getLayerInfoById(this.summaryLayer.id);f&&
(e.popupInfo=f.getPopupInfo())}var f=[],g=0;for(;g<c.length;g++){var r=c[g],p=!1,m,s=0;b:for(;s<d.length;s++)if(m=d[s],m.name===r){p=!0;break b}p?f.push(m):f.push({name:r,alias:r,show:!0,type:"esriFieldTypeString"})}e.datas=b;e.fromClient=!1;e.withGeometry=!1;e.outFields=f;e.formatDate=!0;e.formatCodedValue=!0;e.formatNumber=!1;k.exportCSVFromFeatureLayer(a,this.summaryLayer,e)}else k.exportCSV(a,b,c)},_getFields:function(a){var b=[];if(this.tab.advStat){a=this.tab.advStat.stats;for(var c in a)0<
a[c].length&&l.forEach(a[c],function(a){b.push({field:a.expression,alias:a.label+"",type:c,total:0})});return b}var d;if(a.infoTemplate)d=a.infoTemplate.info.fieldInfos;else if(-1<this.tab.tabLayers[0].url.indexOf("MapServer")){var e=this.tab.tabLayers[0].url.split("MapServer/")[1],f=this.parent.map.itemInfo.itemData.operationalLayers;d=null;for(var g=0;g<f.length;g++){var k=f[g];if(k.layerObject.infoTemplates&&(k=k.layerObject.infoTemplates[e])){d=k.infoTemplate.info.fieldInfos;break}}}else d=a.fields;
d||(d=a.fields);for(e=0;e<d.length;e++)if(f=d[e],"undefined"!==typeof a.fields){var g=a.fields[e].type,r;if(f.name!==a.objectIdField&&("esriFieldTypeDouble"===g||"esriFieldTypeInteger"===g||"esriFieldTypeSmallInteger"===g))"undefined"!==typeof f.visible?f.visible&&(r={field:f.fieldName,alias:f.label,type:"sum",total:0}):r={field:f.name,alias:f.alias,type:"sum",total:0},r&&b.push(r),r=null}return b}})})},"jimu/CSVUtils":function(){define("exports dojo/_base/lang dojo/_base/array dojo/_base/html dojo/has dojo/Deferred jimu/utils esri/lang esri/tasks/QueryTask esri/tasks/query".split(" "),
function(t,m,l,n,f,d,a,c,e,w){function g(a){var c=m.clone(a.attributes);if((a=a.geometry)&&"point"===a.type)"x"in c?c._x=a.x:c.x=a.x,"y"in c?c._y=a.y:c.y=a.y;return c}t.exportCSV=function(a,c,d){return t._createCSVStr(c,d).then(function(c){return t._download(a+".csv",c)})};t.exportCSVFromFeatureLayer=function(a,c,d){d=d||{};return t._getExportData(c,{datas:d.datas,fromClient:d.fromClient,withGeometry:d.withGeometry,outFields:d.outFields,filterExpression:d.filterExpression}).then(function(e){return t._formattedData(c,
e,{formatNumber:d.formatNumber,formatDate:d.formatDate,formatCodedValue:d.formatCodedValue,popupInfo:d.popupInfo}).then(function(c){return t.exportCSV(a,c.datas,c.columns)})})};t.exportCSVByAttributes=function(a,c,d,e){e=m.mixin({},e);e.datas=d;return t.exportCSVFromFeatureLayer(a,c,e)};t.exportCSVByGraphics=function(a,c,d,e){d=l.map(d,function(a){return a.attributes});return t.exportCSVByAttributes(a,c,d,e)};t._createCSVStr=function(a,c){var e=new d,f="",g=0,b=0,m="",n="";try{l.forEach(c,function(a){f=
f+m+a;m=","});for(var f=f+"\r\n",g=a.length,b=c.length,r=0;r<g;r++){for(var m="",t=0;t<b;t++)n=a[r][c[t]],!n&&"number"!==typeof n&&(n=""),n&&/[",\r\n]/g.test(n)&&(n='"'+n.replace(/(")/g,'""')+'"'),f=f+m+n,m=",";f+="\r\n"}e.resolve(f)}catch(z){console.error(z),e.resolve("")}return e};t._isIE11=function(){return 11===a.has("ie")};t._isEdge=function(){return a.has("edge")};t._getDownloadUrl=function(a){return window.Blob&&window.URL&&window.URL.createObjectURL?(a=new Blob(["\ufeff"+a],{type:"text/csv"}),
URL.createObjectURL(a)):"data:attachment/csv;charset\x3dutf-8,\ufeff"+encodeURIComponent(a)};t._download=function(a,c){var e=new d;try{if(f("ie")&&10>f("ie")){var g=window.top.open("about:blank","_blank");g.document.write("sep\x3d,\r\n"+c);g.document.close();g.document.execCommand("SaveAs",!0,a);g.close()}else if(10===f("ie")||t._isIE11()||t._isEdge()){var l=new Blob(["\ufeff"+c],{type:"text/csv"});navigator.msSaveBlob(l,a)}else{var b=n.create("a",{href:t._getDownloadUrl(c),target:"_blank",download:a},
document.body);if(f("safari")){var m=document.createEvent("MouseEvents");m.initEvent("click",!0,!0);b.dispatchEvent(m)}else b.click();n.destroy(b)}e.resolve()}catch(u){e.reject(u)}return e};t._getExportData=function(a,c){var e=new d,f=null,n=c.datas,b=c.withGeometry,f=c.outFields;if(!f||!f.length)f=a.fields;f=m.clone(f);if(b&&!(n&&0<n.length)){var s="",s=-1!==f.indexOf("x")?"_x":"x";f.push({name:s,alias:s,format:{digitSeparator:!1,places:6},show:!0,type:"esriFieldTypeDouble"});s=-1!==f.indexOf("y")?
"_y":"y";f.push({name:s,alias:s,format:{digitSeparator:!1,places:6},show:!0,type:"esriFieldTypeDouble"})}n&&0<n.length?e.resolve({data:n||[],outFields:f}):c.fromClient?(n=l.map(a.graphics,function(a){return b?g(a):m.clone(a)}),e.resolve({data:n||[],outFields:f})):t._getExportDataFromServer(a,f,c).then(function(a){e.resolve({data:a||[],outFields:f})});return e};t._getExportDataFromServer=function(a,c,f){var k=new d;if("esri.layers.FeatureLayer"!==a.declaredClass)return k.resolve([]),k;var m=new e(a.url),
b=new w;b.where=f.filterExpression||a.getDefinitionExpression&&a.getDefinitionExpression()||"1\x3d1";0<c.length?(a=l.map(c,function(a){return a.name}),b.outFields=a):b.outFields=["*"];b.returnGeometry=f.withGeometry;m.execute(b,function(a){a=l.map(a.features,function(a){return g(a)});k.resolve(a)},function(a){console.error(a);k.resolve([])});return k};t._formattedData=function(a,c,e){var f=new d,g=[],b=c.data;c=c.outFields;for(var m=0,n=b.length;m<n;m++){for(var r={},w=0;w<c.length;w++){var z=c[w];
r[z.alias||z.name]=t._getExportValue(b[m][z.name],z,a.objectIdField,a.typeIdField,b[m][a.typeIdField],a.types,e)}g.push(r)}a=l.map(c,function(a){return a.alias||a.name});f.resolve({datas:g,columns:a});return f};t._getExportValue=function(d,e,f,g,m,b,n){function u(a){if(r&&c.isDefined(r.fieldInfos))for(var b=0,d=r.fieldInfos.length;b<d;b++){var e=r.fieldInfos[b];if(e.fieldName===a)return e.format}return null}var r=n.popupInfo,t=!!e.domain&&n.formatCodedValue;n="esriFieldTypeDate"===e.type&&n.formatDate;
var z=f&&e.name===f;g=g&&e.name===g;return n?a.fieldFormatter.getFormattedDate(d,u(e.name)):g?a.fieldFormatter.getTypeName(d,b):t?a.fieldFormatter.getCodedValue(e.domain,d):!t&&!n&&!z&&!g?(t=null,f&&b&&0<b.length&&(f=(f=l.filter(b,function(a){return a.id===m}))&&f[0])&&(f.domains&&f.domains[e.name]&&f.domains[e.name].codedValues)&&(t=a.fieldFormatter.getCodedValue(f.domains[e.name],d)),null!==t?t:d):d}})},"widgets/SituationAwareness/js/GroupedCountInfo":function(){define("dojo/_base/declare dojo/Evented dojo/_base/array dojo/_base/lang dojo/_base/Color dojo/dom dojo/dom-class dojo/dom-construct dojo/dom-style dojo/number dojo/on dojo/has dijit/form/Button jimu/dijit/Popup jimu/CSVUtils jimu/utils esri/config esri/geometry/geometryEngine esri/geometry/mathUtils esri/geometry/Point esri/geometry/webMercatorUtils esri/graphic esri/layers/FeatureLayer esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/Font esri/symbols/TextSymbol esri/tasks/query".split(" "),
function(t,m,l,n,f,d,a,c,e,w,g,y,p,x,k,v,b,s,u,r,H,z,F,M,N,A,D,E){return t("GroupedCountInfo",[m],{summaryLayer:null,summaryFields:[],summaryIds:[],summaryFeatures:[],summaryGeom:null,tabNum:null,popupFields:[],groupedResults:{},symbolField:null,graphicsLayer:null,lyrRenderer:null,lyrSymbol:null,constructor:function(a,b,c){this.tab=a;this.container=b;this.parent=c;this.config=c.config;this.graphicsLayer=null;this.specialFields={};this.dateFields={}},updateForIncident:function(b,c,d,e){this.tabNum=
e;this.container.innerHTML="";a.add(this.container,"loading");this.summaryIds=[];this.summaryFeatures=[];this.groupedResults={};this.summaryGeom=c.geometry;if(0<this.tab.tabLayers.length){var f;"undefined"!==typeof this.tab.tabLayers[0].infoTemplate?(this.summaryLayer=this.tab.tabLayers[0],f=new F(this.summaryLayer.url),f.infoTemplate=this.tab.tabLayers[0].infoTemplate,this.tab.tabLayers[1]=f,this._initGraphicsLayer(d),this.summaryFields=this._getFields(this.tab.tabLayers[0]),n.hitch(this,this._queryFeatures(c.geometry))):
(f=new F(this.tab.tabLayers[0].url),g(f,"load",n.hitch(this,function(){this.summaryLayer=f;if(-1<this.tab.tabLayers[0].url.indexOf("MapServer"))for(var a=this.tab.tabLayers[0].url.split("MapServer/")[1],b=this.parent.map.itemInfo.itemData.operationalLayers,e=0;e<b.length;e++){var g=b[e];if("undefined"!==typeof g.layerObject&&g.layerObject.infoTemplates&&(g=g.layerObject.infoTemplates[a])){f.infoTemplate=g.infoTemplate;break}}this.tab.tabLayers[1]=f;this._initGraphicsLayer(d);this.summaryFields=this._getFields(this.tab.tabLayers[1]);
n.hitch(this,this._queryFeatures(c.geometry))})))}},_initGraphicsLayer:function(a){null!==a&&(this.graphicsLayer=a,this.graphicsLayer.clear(),this.summaryLayer&&this.summaryLayer.renderer&&(this.lyrRenderer=this.summaryLayer.renderer,this.graphicsLayer.renderer=this.lyrRenderer,"undefined"!==typeof this.summaryLayer.renderer.attributeField?this.symbolField=this.summaryLayer.renderer.attributeField:this.lyrSymbol=this.lyrRenderer.symbol))},_queryFeatures:function(a){var b=new E;b.geometry=a;this.summaryLayer.queryIds(b,
n.hitch(this,function(a){a?(this.summaryIds=a,0<this.summaryIds.length?this._queryFeaturesByIds():this._processResults()):this._processResults()}))},_queryFeaturesByIds:function(){var b=this.summaryLayer.maxRecordCount||1E3,c=this.summaryIds.slice(0,b);this.summaryIds.splice(0,b);var b=new E,d=!1;l.some(this.summaryFields,n.hitch(this,function(a){if("area"===a.type||"length"===a.type||this.graphicsLayer)return d=!0}));b.returnGeometry=d;var e=[];l.forEach(this.summaryFields,function(a){e.push(a.field)});
this.symbolField&&e.push(this.symbolField);if(!0===this.config.csvAllFields||"true"===this.config.csvAllFields)b.outFields=["*"];else{if(0<this.popupFields.length)for(var f=0;f<this.popupFields.length;f++){var g=this.popupFields[f];-1===e.indexOf(g)&&e.push(g)}b.outFields=e}b.objectIds=c;this.summaryLayer.queryFeatures(b,n.hitch(this,function(b){b.features&&(this.summaryFeatures=this.summaryFeatures.concat(b.features));this._processResults();0<this.summaryIds.length?(this.SA_SAT_download&&a.replace(this.SA_SAT_download,
"processing","download"),this._queryFeaturesByIds()):this.SA_SAT_download&&a.replace(this.SA_SAT_download,"download","processing")}))},_prepGroupedResults:function(){for(var a=0;a<this.summaryFeatures.length;a++){var b=this.summaryFeatures[a];if("undefined"!==typeof this.summaryFields&&0<this.summaryFields.length){var c=this._getFieldValue(this.summaryFields[0].field,b.attributes[this.summaryFields[0].field]),c="undefined"!==typeof c&&null!==c?v.stripHTML(c.toString()):"";c in this.groupedResults?
this.groupedResults[c].features.push(b):this.groupedResults[c]={features:[b]}}}},_prepResults:function(){for(var a in this.groupedResults){var b=this.summaryFields[0];b.total=this.groupedResults[a].features.length;this.groupedResults[a].total=b.total;this.groupedResults[a].type=b.type;this.groupedResults[a].label=b.alias}},_processResults:function(){this._prepGroupedResults();this._prepResults();this.container.innerHTML="";a.remove(this.container,"loading");var b=this.groupedResults;if(0===Object.keys(this.groupedResults).length)this.container.innerHTML=
this.parent.nls.noFeaturesFound;else{var d=Object.keys(this.groupedResults).length+1,e=0,d=c.create("div",{style:"width:"+220*d+"px;"},this.container);a.add(d,"SAT_tabPanelContent");e=c.create("div",{},d);a.add(e,"SATcol");e=c.create("div",{"data-dojo-attach-point":"SA_SAT_download",innerHTML:this.parent.nls.downloadCSV},e);a.add(e,["btnExport","download"]);g(e,"click",n.hitch(this,this._exportToCSV));var f=Object.keys(b).sort(),k;for(k in f){var e=f[k],r=b[e],l=v.stripHTML(e.toString()),e=e===this.parent.nls.area||
e===this.parent.nls.length?r.total:Math.round(r.total);isNaN(e)&&(e=0);var m=c.create("div",{"class":"SATcol"},d),p=c.create("div",{style:"max-height: 45px;"},m);c.create("div",{"class":"SATcolWrap",style:"max-height: 30px; overflow: hidden;",innerHTML:"pre"===r.type?r.label.trim():l},p);c.create("div",{"class":"SATcolWrap",style:"max-height: 30px; overflow: hidden;",innerHTML:"pre"===r.type?l:r.label.trim()},p);c.create("div",{"class":""!==r.label?"colGroupedSummary":"colSummary",innerHTML:w.format(e)},
m)}if(null!==this.graphicsLayer){this.graphicsLayer.clear();this.tab.tabLayers[1].clear();if(this.summaryFeatures)for(b=0;b<this.summaryFeatures.length;b++)k=this.summaryFeatures[b],this.lyrSymbol?k.symbol=this.lyrSymbol:this.graphicsLayer.renderer&&(d=this.graphicsLayer.renderer.getSymbol(k),k.symbol=d),this.graphicsLayer.add(k),this.tab.tabLayers[1].add(k);this.graphicsLayer.setVisibility(!0);this.parent._toggleTabLayersNew(this.tabNum);this.tab.retsore&&this.emit("summary-complete",{bubbles:!0,
cancelable:!0,tab:this.tabNum})}}},_exportToCSV:function(){if(0===this.summaryFeatures.length)return!1;var a;a=this.tab.label?this.tab.label:this.tab.layers;var b=[],c=[];l.forEach(this.summaryFeatures,function(a){b.push(a.attributes)});if(!0===this.config.csvAllFields||"true"===this.config.csvAllFields)for(var d in b[0])c.push(d);else for(d=0;d<this.summaryFields.length;d++)c.push(this.summaryFields[d].field);d=this.summaryLayer.fields;if(this.summaryLayer&&this.summaryLayer.loaded&&d){var e={};
if(this.parent.opLayers&&this.parent.opLayers._layerInfos){var f=this.parent.opLayers.getLayerInfoById(this.summaryLayer.id);f&&(e.popupInfo=f.getPopupInfo())}var f=[],g=0;for(;g<c.length;g++){var r=c[g],m=!1,n,p=0;b:for(;p<d.length;p++)if(n=d[p],n.name===r){m=!0;break b}m?f.push(n):f.push({name:r,alias:r,show:!0,type:"esriFieldTypeString"})}e.datas=b;e.fromClient=!1;e.withGeometry=!1;e.outFields=f;e.formatDate=!0;e.formatCodedValue=!0;e.formatNumber=!1;k.exportCSVFromFeatureLayer(a,this.summaryLayer,
e)}else k.exportCSV(a,b,c)},_getFields:function(a){var b=[];if("undefined"!==typeof this.tab.advStat){var c=this.tab.advStat.stats,d;for(d in c)0<c[d].length&&l.forEach(c[d],function(a){b.push({field:a.expression,alias:a.label+"",type:d,total:0})})}var e={};l.forEach(a.fields,n.hitch(this,function(b){if("esriFieldTypeDate"===b.type||b.domain){if("esriFieldTypeDate"===b.type&&a.infoTemplate)for(var c in a.infoTemplate._fieldsMap)"undefined"!==typeof a.infoTemplate._fieldsMap[c].fieldName&&(a.infoTemplate._fieldsMap[c].fieldName===
b.name&&"undefined"!==typeof a.infoTemplate._fieldsMap[c].format.dateFormat)&&(this.dateFields[b.name]=a.infoTemplate._fieldsMap[c].format.dateFormat);e[b.name]=b}}));this.specialFields=e;return b},_getFieldValue:function(a,b){var c=b;if(this.specialFields[a]){var d=this.specialFields[a];"esriFieldTypeDate"===d.type?("undefined"!==this.dateFields[a]?(d=this.dateFields[a],d=void 0!==typeof d?{dateFormat:d}:{dateFormat:"longMonthDayYear"}):d={dateFormat:"longMonthDayYear"},c=v.fieldFormatter.getFormattedDate(new Date(b),
d)):l.some(d.domain.codedValues,function(a){if(a.code===b)return c=a.name,!0})}return c}})})},"widgets/SituationAwareness/js/WeatherInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/dom-class dojo/dom-construct esri/geometry/webMercatorUtils esri/request".split(" "),function(t,m,l,n,f,d){return t("WeatherInfo",null,{constructor:function(a,c,d){this.tab=a;this.container=c;this.parent=d;this.weatherURL=a.url;this.weatherDict={119:["Cloudy","cloudy5.png","cloudy5.png"],377:["Moderate or heavy showers of ice pellets",
"hail.png","hail.png"],374:["Light showers of ice pellets","hail.png","hail.png"],350:["Ice pellets","hail.png","hail.png"],353:["Light rain shower","light_rain.png","light_rain.png"],302:["Moderate rain","light_rain.png","light_rain.png"],296:["Light rain","light_rain.png","light_rain.png"],293:["Patchy light rain","light_rain.png","light_rain.png"],266:["Light drizzle","light_rain.png","light_rain.png"],263:["Patchy light drizzle","light_rain.png","light_rain.png"],122:["Overcast","overcast.png",
"overcast.png"],359:["Torrential rain shower","shower3.png","shower3.png"],308:["Heavy rain","shower3.png","shower3.png"],365:["Moderate or heavy sleet showers","sleet.png","sleet.png"],362:["Light sleet showers","sleet.png","sleet.png"],320:["Moderate or heavy sleet","sleet.png","sleet.png"],317:["Light sleet","sleet.png","sleet.png"],314:["Moderate or Heavy freezing rain","sleet.png","sleet.png"],311:["Light freezing rain","sleet.png","sleet.png"],284:["Heavy freezing drizzle","sleet.png","sleet.png"],
281:["Freezing drizzle","sleet.png","sleet.png"],185:["Patchy freezing drizzle nearby","sleet.png","sleet.png"],182:["Patchy sleet nearby","sleet.png","sleet.png"],395:["Moderate or heavy snow in area with thunder","snow4.png","snow4.png"],335:["Patchy heavy snow","snow4.png","snow4.png"],230:["Blizzard","snow4.png","snow4.png"],227:["Blowing snow","snow4.png","snow4.png"],371:["Moderate or heavy snow showers","snow5.png","snow5.png"],338:["Heavy snow","snow5.png","snow5.png"],389:["Moderate or heavy rain in area with thunder",
"tstorm3.png","tstorm3.png"],392:["Patchy light snow in area with thunder","snow2.png","snow2_night.png"],386:["Patchy light rain in area with thunder","tstorm1.png","tstorm1_night.png"],368:["Light snow showers","snow2.png","snow2_night.png"],356:["Moderate or heavy rain shower","shower2.png","shower2_night.png"],332:["Moderate snow","snow3.png","snow3_night.png"],329:["Patchy moderate snow","snow2.png","snow2_night.png"],326:["Light snow","snow1.png","snow1_night.png"],323:["Patchy light snow",
"snow1.png","snow1_night.png"],305:["Heavy rain at times","shower2.png","shower2_night.png"],299:["Moderate rain at times","shower2.png","shower2_night.png"],260:["Freezing fog","fog.png","fog_night.png"],248:["Fog","fog.png","fog_night.png"],200:["Thundery outbreaks in nearby","tstorm1.png","tstorm1_night.png"],179:["Patchy snow nearby","snow1.png","snow1_night.png"],176:["Patchy rain nearby","shower1.png","shower1_night.png"],143:["Mist","mist.png","mist_night.png"],116:["Partly Cloudy","cloudy3.png",
"cloudy3_night.png"],113:["Clear/Sunny","sunny.png","sunny_night.png"]}},updateForIncident:function(a){this.container.innerHTML="";l.add(this.container,"loading");var c=a=a.geometry;"point"!==a.type&&(c=a.getExtent().getCenter());a=f.webMercatorToGeographic(c);a=a.y+","+a.x;c="";"Weather"!==this.tab.label?(c=this.weatherURL,this.container.innerHTML="\x3cimg style\x3d'height:100%;' src\x3d'"+this.weatherURL+"' /\x3e"):(c=this.weatherURL+"\x26q\x3d"+a,d({url:c,callbackParamName:"callback"},{useProxy:!1}).then(m.hitch(this,
function(a){return this._resultsHandler(a)}),m.hitch(this,function(a){a=this._errorHandler(a);console.log(a)})))},_resultsHandler:function(a){a=a.data;console.log(a);var c=a.current_condition;a=a.weather;var d=1;this.container.innerHTML="";l.remove(this.container,"loading");var f=n.create("div",{style:"width:"+165*(a.length+3)+"px;"},this.container);l.add(f,"SAT_tabPanelContent");var g,m;if(0<c.length){c=c[0];g=c.localObsDateTime.split(" ");m=g[2];g=g[1].split(":");g=parseInt(g[0],10);if("AM"===m){if(6>
g||12===g)d=2}else 6<g&&12>g&&(d=2);m=c.temp_F;g=c.weatherCode;g=this.weatherDict[parseInt(g,10)];g=this.parent.nls.now+"\x3cbr/\x3e\x3cimg style\x3d'height:45px' src\x3d'"+this.parent.folderUrl+"images/w/"+g[d]+"' /\x3e\x3cbr/\x3e"+m+"\x26deg;";m=n.create("div",{innerHTML:g},f);l.add(m,"SATcolSmall");g=this.parent.nls.wind+"\x3cbr/\x3e\x3cspan style\x3d'font-size: 30px; line-height:47px'\x3e"+c.winddir16Point+"\x3c/span\x3e\x3cbr/\x3e"+c.windspeedMiles+" MPH";c=n.create("div",{innerHTML:g},f);l.add(c,
"SATcolSmall")}for(m=0;m<a.length;m++){var c=a[m],p=this._getDay(c.date),t=c.tempMaxF,k=c.tempMinF;g=c.weatherCode;g=this.weatherDict[parseInt(g,10)];g=p+"\x3cbr/\x3e\x3cimg style\x3d'height:45px' src\x3d'"+this.parent.folderUrl+"images/w/"+g[d]+"' /\x3e\x3cbr/\x3e"+t+"\x26deg; | "+k+"\x26deg;";c=n.create("div",{innerHTML:g},f);l.add(c,"SATcolSmall")}a=n.create("div",{innerHTML:'\x3cbr/\x3e\x3cbr/\x3e\x3cbr/\x3e\x3cspan style\x3d"font-size:11px;color:#6e6e6e"\x3e'+this.parent.nls.poweredBy+'\x3cbr/\x3e\x3ca style\x3d"color:#6e6e6e;text-decoration:none" href\x3d"http://www.worldweatheronline.com/" title\x3d"Free Weather API" target\x3d"_blank"\x3eWorld Weather Online\x3c/a\x3e\x3c/span\x3e'},
f);l.add(a,"SATcolSmall");l.add(a,"SATcolLast")},_getDay:function(a){a=a.split("-");a="SUN MON TUE WED THU FRI SAT".split(" ")[(new Date(a[0],a[1]-1,a[2])).getDay()];return this.parent.nls[a]},_errorHandler:function(a){console.log(a.message);a=n.create("div",{innerHTML:a.message},this.container);l.add(a,"SATcolSmall")}})})},"widgets/SituationAwareness/js/ClosestInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/_base/array dojo/DeferredList dojo/dom-class dojo/dom-construct dojo/dom-style dojo/on jimu/utils esri/geometry/geometryEngine esri/geometry/Polyline esri/graphic esri/layers/FeatureLayer esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/Font esri/symbols/TextSymbol esri/tasks/query".split(" "),
function(t,m,l,n,f,d,a,c,e,w,g,y,p,x,k,v,b,s,u){return t("ClosestInfo",null,{constructor:function(a,b,c){this.tab=a;this.container=b;this.parent=c;this.graphicsLayer=this.incident=null;this.map=c.map;this.specialFields={};this.dateFields={}},updateForIncident:function(a,b,c){n.forEach(this.tab.tabLayers,m.hitch(this,function(d){if("undefined"!==typeof d.empty){var f=new x(d.url);e(f,"load",m.hitch(this,function(){this.tab.tabLayers=[f];this.processIncident(a,b,c)}))}else this.processIncident(a,b,
c)}))},processIncident:function(a,b,c){this.container.innerHTML="";d.add(this.container,"loading");var e=[];this.incident=a;b=g.buffer(a.geometry,b,this.parent.config.distanceSettings[this.parent.config.distanceUnits]);this.graphicsLayer=c;this.graphicsLayer.clear();var k=this.tab.tabLayers;c=[];for(var l=0;l<k.length;l++){var n=k[l],p=new u;p.returnGeometry=!0;p.geometry=b;p.outFields=this._getFields(n);"undefined"!==typeof n.queryFeatures&&c.push(n.queryFeatures(p))}(new f(c)).then(m.hitch(this,
function(b){for(var c=0;c<b.length;c++){var d=b[c][1],f=this._getFields(k[c]);if((d=d.features)&&0<d.length){for(var g=0;g<d.length;g++){for(var l=d[g],m={DISTANCE:this._getDistance(a.geometry,l.geometry)},n=0;n<f.length;n++)m[f[n]]=l.attributes[f[n]];l.attributes=m}d.sort(this._compareDistance);e.push(d[0])}}this._processResults(e)}))},_processResults:function(f){this.container.innerHTML="";d.remove(this.container,"loading");if(0===f.length)this.container.innerHTML=this.parent.nls.noFeaturesFound;
else{var g=a.create("div",{style:"width:"+220*f.length+"px;"},this.container);d.add(g,"SAT_tabPanelContent");for(var n=this.parent.nls[this.parent.config.distanceUnits],t=0;t<f.length;t++){var u=t+1,x=f[t],A=x.geometry,D=A;"point"!==A.type&&(D=A.getExtent().getCenter());var A=x.attributes,E;"point"===this.incident.geometry.type&&(E=n+": "+Math.round(100*A.DISTANCE)/100);var C="",B=0,h;for(h in A)if("DISTANCE"!==h&&3>B){var q=this._getFieldValue(h,A[h]),q="undefined"!==typeof q&&null!==q?w.stripHTML(q.toString()):
"",G;if(x._layer&&x._layer.fields){var K=this._getField(x._layer.fields,h);K&&(G=K.alias)}if("undefined"===typeof G||G in[""," ",null,void 0])G=h;this.isURL(q)?q='\x3ca href\x3d"'+q+'" target\x3d"_blank" style\x3d"color: inherit;"\x3e'+G+"\x3c/a\x3e":this.isEmail(q)&&(q='\x3ca href\x3d"mailto:'+q+'" style\x3d"color: inherit;"\x3e'+G+"\x3c/a\x3e");C+=q+"\x3cbr/\x3e";B+=1}x=a.create("div",{},g);d.add(x,"SATcolRec");B=a.create("div",{},x);d.add(B,"SATcolRecBar");q=a.create("div",{innerHTML:u},B);d.add(q,
"SATcolRecNum");c.set(q,"backgroundColor",this.parent.config.color);e(q,"click",m.hitch(this,this._zoomToLocation,D));E&&(q=a.create("div",{innerHTML:E},B),d.add(q,"SATcolDistance"));this.parent.config.enableRouting&&(B=a.create("div",{title:this.parent.nls.get_directions},B),d.add(B,"SATcolDir"),e(B,"click",m.hitch(this,this._routeToIncident,D)));C=a.create("div",{"class":"SATcolWrap",innerHTML:C},x);d.add(C,"SATcolInfo");C=new v(v.STYLE_SOLID,new l.fromString(this.parent.config.color),1);C=new k(k.STYLE_CIRCLE,
24,C,new l.fromString(this.parent.config.color));x=new b;x.family="Arial";x.size="12px";u=new s(u,x,"#ffffff");u.setOffset(0,-4);null===A.OUTSIDE_POLYGON&&(x=new v(v.STYLE_SOLID,new l([0,0,0,1]),1),B=new y(D.spatialReference),q=this.incident.geometry,"point"!==this.incident.geometry.type&&(q=this.incident.geometry.getExtent().getCenter()),B.addPath([D,q]),this.graphicsLayer.add(new p(B,x,{})));this.graphicsLayer.add(new p(D,C,A));this.graphicsLayer.add(new p(D,u,A))}}},_getField:function(a,b){for(var c=
0;c<a.length;c++){var d=a[c];if(d.name===b||d.alias===b)return d}},_getFields:function(a){var b=[];if(this.tab.advStat&&this.tab.advStat.stats&&this.tab.advStat.stats.outFields&&0<this.tab.advStat.stats.outFields.length)n.forEach(this.tab.advStat.stats.outFields,function(a){b.push(a.expression)});else{var c;if(a.infoTemplate)c=a.infoTemplate.info.fieldInfos;else if(0<this.parent.map.itemInfo.itemData.operationalLayers.length){var d=this.parent.map.itemInfo.itemData.operationalLayers;c=null;var e=
0;a:for(;e<d.length;e++){var f=d[e];if("ArcGISMapServiceLayer"===f.layerType&&"undefined"!==typeof f.layers)for(var g=0;g<f.layers.length;g++){var k=f.layers[g];if(k.id===a.layerId&&k.popupInfo){c=k.popupInfo.fieldInfos;break a}}}c||(c=a.fields)}else c=a.fields;if(c)for(d=0;d<c.length;d++)e=c[d],"undefined"!==typeof e.visible?e.visible&&b.push(e.fieldName):b.push(e.name)}var l={};a.fields&&n.forEach(a.fields,m.hitch(this,function(b){if("esriFieldTypeDate"===b.type||b.domain){if("esriFieldTypeDate"===
b.type&&a.infoTemplate)for(var c in a.infoTemplate._fieldsMap)"undefined"!==typeof a.infoTemplate._fieldsMap[c].fieldName&&(a.infoTemplate._fieldsMap[c].fieldName===b.name&&"undefined"!==typeof a.infoTemplate._fieldsMap[c].format.dateFormat)&&(this.dateFields[b.name]=a.infoTemplate._fieldsMap[c].format.dateFormat);l[b.name]=b}}));this.specialFields=l;return b},_getFieldValue:function(a,b){var c=b;if(this.specialFields[a]){var d=this.specialFields[a];"esriFieldTypeDate"===d.type?("undefined"!==this.dateFields[a]?
(d=this.dateFields[a],d=void 0!==typeof d?{dateFormat:d}:{dateFormat:"longMonthDayYear"}):d={dateFormat:"longMonthDayYear"},c=w.fieldFormatter.getFormattedDate(new Date(b),d)):n.some(d.domain.codedValues,function(a){if(a.code===b)return c=a.name,!0})}return c},isURL:function(a){return/(https?:\/\/|ftp:)/g.test(a)},isEmail:function(a){return/\S+@\S+\.\S+/.test(a)},_getDistance:function(a,b){var c=0,d=this.parent.config.distanceUnits,c=g.distance(a,b,9001);switch(d){case "miles":c*=6.21371E-4;break;
case "kilometers":c*=0.0010;break;case "feet":c*=3.28084;break;case "yards":c*=1.09361;break;case "nauticalMiles":c*=5.39957E-4}return c},_compareDistance:function(a,b){return a.attributes.DISTANCE<b.attributes.DISTANCE?-1:a.attributes.DISTANCE>b.attributes.DISTANCE?1:0},_zoomToLocation:function(a){this.parent.zoomToLocation(a)},_routeToIncident:function(a){this.parent.routeToIncident(a)}})})},"widgets/SituationAwareness/js/ProximityInfo":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/Color dojo/_base/array dojo/DeferredList dojo/dom-class dojo/dom-construct dojo/dom-style dojo/on esri/geometry/geometryEngine esri/graphic esri/layers/FeatureLayer esri/symbols/SimpleMarkerSymbol esri/symbols/SimpleLineSymbol esri/symbols/Font esri/symbols/TextSymbol esri/tasks/query jimu/CSVUtils jimu/utils".split(" "),
function(t,m,l,n,f,d,a,c,e,w,g,y,p,x,k,v,b,s,u){return t("ProximityInfo",null,{constructor:function(a,b,c){this.tab=a;this.container=b;this.parent=c;this.graphicsLayer=this.incident=null;this.specialFields={};this.dateFields={};this.config=c.config},updateForIncident:function(a,b,c){n.forEach(this.tab.tabLayers,m.hitch(this,function(d){if("undefined"!==typeof d.empty){var f=new y(d.url);e(f,"load",m.hitch(this,function(){this.tab.tabLayers=[f];this.processIncident(a,b,c)}))}else this.processIncident(a,
b,c)}))},processIncident:function(a,c,e){this.container.innerHTML="";this.buffer=c;d.add(this.container,"loading");var g=[];this.incident=a;this.graphicsLayer=e;var k=this.tab.tabLayers;e=[];for(var l=0;l<k.length;l++){var n=k[l],p=new b;p.returnGeometry=!0;p.geometry=c.geometry;p.outFields="true"===this.parent.config.csvAllFields||!0===this.parent.config.csvAllFields?["*"]:this._getFields(n);"undefined"!==typeof n.queryFeatures&&e.push(n.queryFeatures(p))}(new f(e)).then(m.hitch(this,function(b){for(var c=
0;c<b.length;c++){var d=b[c][1],e=this._getFields(k[c]);if(d&&d.features)for(var d=d.features,f=0;f<d.length;f++){for(var l=d[f],m=this._getDistance(a.geometry,l.geometry),n={DISTANCE:m},p=0;p<e.length;p++)n[e[p]]=l.attributes[e[p]];!0===this.config.csvAllFields||"true"===this.config.csvAllFields?l.attributes.DISTANCE=m:l.attributes=n;g.push(l)}}this._processResults(g)}))},_processResults:function(b){this.container.innerHTML="";d.remove(this.container,"loading");this.graphicsLayer.clear();if(0===
b.length&&this.buffer)this.container.innerHTML=this.parent.nls.noFeaturesFound;else{0===b.length&&!this.buffer&&(this.container.innerHTML=this.parent.nls.defaultTabMsg);b.sort(this._compareDistance);var f=b.length+1,s=a.create("div",{style:"width:"+(220*f+20)+"px;"},this.container);d.add(s,"SAT_tabPanelContent");var t=a.create("div",{},s);d.add(t,"SATcol");t=a.create("div",{innerHTML:this.parent.nls.downloadCSV},t);d.add(t,"btnExport");e(t,"click",m.hitch(this,this._exportToCSV,b));var t=this.parent.nls[this.parent.config.distanceUnits],
w;"undefined"!==typeof this.tab.advStat?w=this.tab.advStat.stats.outFields:(w=[],0<this.tab.tabLayers.length&&n.forEach(this.tab.tabLayers,m.hitch(this,function(a){"undefined"!==typeof a.popupInfo?n.forEach(a.popupInfo.fieldInfos,m.hitch(this,function(a){if(a.visible){var b={value:0};b.expression=a.fieldName;b.label=a.label;w.push(b)}})):a.infoTemplate?n.forEach(a.infoTemplate.info.fieldInfos,m.hitch(this,function(a){if(a.visible){var b={value:0};b.expression=a.fieldName;b.label=a.label;w.push(b)}})):
n.forEach((a.layerObject?a.layerObject:a).fields,m.hitch(this,function(a){var b={value:0};b.expression=a.name;b.label=a.alias;w.push(b)}))})));for(var y=0,A=0;A<b.length;A++){var D=A+1,E=b[A],C=E.geometry,B=C;"point"!==C.type&&(B=C.getExtent().getCenter());var C=E.attributes,h;"point"===this.incident.geometry.type&&(h=t+": "+Math.round(100*C.DISTANCE)/100);var q="",G=0,K;for(K in C)if("DISTANCE"!==K&&3>G&&"undefined"!==typeof w)for(var J=0;J<w.length;J++)if(w[J].expression===K){var I=this._getFieldValue(K,
C[K]),I="undefined"!==typeof I&&null!==I?u.stripHTML(I.toString()):"",O;if(E._layer&&E._layer.fields){var P=this._getField(E._layer.fields,K);P&&(O=P.alias)}if("undefined"===typeof O||O in[""," ",null,void 0])O=K;this.isURL(I)?I='\x3ca href\x3d"'+I+'" target\x3d"_blank" style\x3d"color: inherit;"\x3e'+O+"\x3c/a\x3e":this.isEmail(I)&&(I='\x3ca href\x3d"mailto:'+I+'" style\x3d"color: inherit;"\x3e'+O+"\x3c/a\x3e");q+=I+"\x3cbr/\x3e";G+=1}E=a.create("div",{},s);d.add(E,"SATcolRec");G=a.create("div",
{},E);d.add(G,"SATcolRecBar");J=a.create("div",{innerHTML:D},G);d.add(J,"SATcolRecNum");c.set(J,"backgroundColor",this.parent.config.color);e(J,"click",m.hitch(this,this._zoomToLocation,B));h&&(J=a.create("div",{innerHTML:h},G),d.add(J,"SATcolDistance"));this.parent.config.enableRouting&&(G=a.create("div",{title:this.parent.nls.get_directions},G),d.add(G,"SATcolDir"),e(G,"click",m.hitch(this,this._routeToIncident,B)));q=a.create("div",{"class":"SATcolWrap",innerHTML:q},E);d.add(q,"SATcolInfo");y+=
E.clientWidth;q=new x(x.STYLE_SOLID,new l.fromString(this.parent.config.color),1);q=new p(p.STYLE_CIRCLE,24,q,new l.fromString(this.parent.config.color));E=new k;E.family="Arial";E.size="12px";D=new v(D,E,"#ffffff");D.setOffset(0,-4);this.graphicsLayer.add(new g(B,q,C));this.graphicsLayer.add(new g(B,D,C))}c.set(s,"width",y+240+f+"px")}},_exportToCSV:function(a){if(0===a.length)return!1;var b;b=this.tab.label?this.tab.label:this.tab.layers;var c=[],d=[];n.forEach(a,function(a){c.push(a.attributes)});
for(var e in c[0])d.push(e);this.summaryLayer=this.tab.tabLayers[0];a=this.summaryLayer.fields;if(this.summaryLayer&&this.summaryLayer.loaded&&a){e={};if(this.parent.opLayers&&this.parent.opLayers._layerInfos){var f=this.parent.opLayers.getLayerInfoById(this.summaryLayer.id);f&&(e.popupInfo=f.getPopupInfo())}var f=[],g=0;for(;g<d.length;g++){var k=d[g],l=!1,m,p=0;b:for(;p<a.length;p++)if(m=a[p],m.name===k){l=!0;break b}l?f.push(m):f.push({name:k,alias:k,show:!0,type:"esriFieldTypeString"})}e.datas=
c;e.fromClient=!1;e.withGeometry=!1;e.outFields=f;e.formatDate=!0;e.formatCodedValue=!0;e.formatNumber=!1;s.exportCSVFromFeatureLayer(b,this.summaryLayer,e)}else s.exportCSV(b,c,d)},_getField:function(a,b){for(var c=0;c<a.length;c++){var d=a[c];if(d.name===b||d.alias===b)return d}},_getFields:function(a){var b=[];if(this.tab.advStat&&this.tab.advStat.stats&&this.tab.advStat.stats.outFields&&0<this.tab.advStat.stats.outFields.length)n.forEach(this.tab.advStat.stats.outFields,function(a){b.push(a.expression)});
else{var c;if(a.infoTemplate)c=a.infoTemplate.info.fieldInfos;else if(0<this.parent.map.itemInfo.itemData.operationalLayers.length){var d=this.parent.map.itemInfo.itemData.operationalLayers;c=null;var e=0;a:for(;e<d.length;e++){var f=d[e];if("ArcGISMapServiceLayer"===f.layerType&&"undefined"!==typeof f.layers)for(var g=0;g<f.layers.length;g++){var k=f.layers[g];if(k.popupInfo&&k.id===a.layerId){c=k.popupInfo.fieldInfos;break a}}}c||(c=a.fields)}else c=a.fields;for(d=0;d<c.length;d++)e=c[d],"undefined"!==
typeof e.visible?e.visible&&b.push(e.fieldName):b.push(e.name)}var l={};n.forEach(a.fields,m.hitch(this,function(b){if("esriFieldTypeDate"===b.type||b.domain){if("esriFieldTypeDate"===b.type&&a.infoTemplate)for(var c in a.infoTemplate._fieldsMap)"undefined"!==typeof a.infoTemplate._fieldsMap[c].fieldName&&(a.infoTemplate._fieldsMap[c].fieldName===b.name&&"undefined"!==typeof a.infoTemplate._fieldsMap[c].format.dateFormat)&&(this.dateFields[b.name]=a.infoTemplate._fieldsMap[c].format.dateFormat);l[b.name]=
b}}));this.specialFields=l;return b},_getFieldValue:function(a,b){var c=b;if(this.specialFields[a]){var d=this.specialFields[a];"esriFieldTypeDate"===d.type?("undefined"!==this.dateFields[a]?(d=this.dateFields[a],d=void 0!==typeof d?{dateFormat:d}:{dateFormat:"longMonthDayYear"}):d={dateFormat:"longMonthDayYear"},c=u.fieldFormatter.getFormattedDate(new Date(b),d)):n.some(d.domain.codedValues,function(a){if(a.code===b)return c=a.name,!0})}return c},isURL:function(a){return/(https?:\/\/|ftp:)/g.test(a)},
isEmail:function(a){return/\S+@\S+\.\S+/.test(a)},_getDistance:function(a,b){var c=0,d=this.parent.config.distanceUnits,c=w.distance(a,b,9001);switch(d){case "miles":c*=6.21371E-4;break;case "kilometers":c*=0.0010;break;case "feet":c*=3.28084;break;case "yards":c*=1.09361;break;case "nauticalMiles":c*=5.39957E-4}return c},_compareDistance:function(a,b){return a.attributes.DISTANCE<b.attributes.DISTANCE?-1:a.attributes.DISTANCE>b.attributes.DISTANCE?1:0},_zoomToLocation:function(a){this.parent.zoomToLocation(a)},
_routeToIncident:function(a){this.parent.routeToIncident(a)}})})},"widgets/SituationAwareness/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:dijit/templates/ProgressBar.html":'\x3cdiv class\x3d"dijitProgressBar dijitProgressBarEmpty" role\x3d"progressbar"\r\n\t\x3e\x3cdiv  data-dojo-attach-point\x3d"internalProgress" class\x3d"dijitProgressBarFull"\r\n\t\t\x3e\x3cdiv class\x3d"dijitProgressBarTile" role\x3d"presentation"\x3e\x3c/div\r\n\t\t\x3e\x3cspan style\x3d"visibility:hidden"\x3e\x26#160;\x3c/span\r\n\t\x3e\x3c/div\r\n\t\x3e\x3cdiv data-dojo-attach-point\x3d"labelNode" class\x3d"dijitProgressBarLabel" id\x3d"${id}_label"\x3e\x3c/div\r\n\t\x3e\x3cspan data-dojo-attach-point\x3d"indeterminateHighContrastImage"\r\n\t\t   class\x3d"dijitInline dijitProgressBarIndeterminateHighContrastImage"\x3e\x3c/span\r\n\x3e\x3c/div\x3e\r\n',
"url:esri/dijit/editing/templates/AttachmentEditor.html":"\x3cdiv class\x3d\"attachmentEditor\"\x3e\r\n    \x3cbr /\x3e\r\n    \x3cdiv\x3e\r\n        \x3cb\x3e${NLS_attachments}\x3c/b\x3e\r\n        \x3chr /\x3e\r\n        \x3cdiv dojoAttachPoint\x3d\"_attachmentError\" style\x3d'color:red;display:none'\x3e\x3c/div\x3e\r\n        \x3cbr /\x3e\r\n        \x3cspan dojoAttachPoint\x3d'_attachmentList' style\x3d'word-wrap: break-word;'\x3e\x3c/span\x3e\r\n        \x3cbr\x3e\x3cbr\x3e\r\n        \x3cdiv data-dojo-type\x3d\"dijit/ProgressBar\" dojoAttachPoint\x3d\"_attachmentProgress\" indeterminate\x3d\"true\" style\x3d'display:none'\x3e\x3c/div\x3e\r\n        \x3cbr /\x3e        \r\n        \x3cform dojoAttachPoint\x3d'_uploadForm'\x3e ${NLS_add}:\x26nbsp;\x26nbsp;\x3cinput type\x3d'file' name\x3d'attachment' dojoAttachPoint\x3d'_uploadField' /\x3e \x3c/form\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e",
"url:dijit/templates/Calendar.html":'\x3cdiv class\x3d"dijitCalendarContainer dijitInline" role\x3d"presentation" aria-labelledby\x3d"${id}_mddb ${id}_year"\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarMonthContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarDecrementArrow\' data-dojo-attach-point\x3d"decrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarIncrementArrow\' data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode" class\x3d"dijitInline"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"grid" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\x3cthead\x3e\r\n\t\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t\t${!dayCellsHtml}\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/thead\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t\t${!dateRowsHtml}\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarYearContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:esri/dijit/templates/AttributeInspector.html":'\x3cdiv class\x3d"esriAttributeInspector"\x3e\r\n    \x3cdiv class\x3d"atiLayerName" dojoAttachPoint\x3d"layerName"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiAttributes" dojoAttachPoint\x3d"attributeTable"\x3e\x3c/div\x3e\r\n    \x3cdiv dojoAttachPoint\x3d"attachmentEditor"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiEditorTrackingInfo" dojoAttachPoint\x3d"editorTrackingInfoDiv"\x3e\x3c/div\x3e\r\n    \x3cdiv class\x3d"atiButtons" dojoAttachPoint\x3d"editButtons"\x3e\r\n        \x3cbutton  dojoType\x3d"dijit.form.Button" class\x3d"atiButton atiDeleteButton"  dojoAttachPoint\x3d"deleteBtn" dojoAttachEvent\x3d"onClick: onDeleteBtn" showLabel\x3d"true" type\x3d"button"\x3e${NLS_deleteFeature}\x3c/button\x3e\r\n        \x3cdiv class\x3d"atiNavButtons" dojoAttachPoint\x3d"navButtons"\x3e\r\n            \x3cdiv class\x3d"atiNavMessage" dojoAttachPoint\x3d"navMessage"\x3e\x3c/div\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiFirstIcon" dojoAttachPoint\x3d"firstFeatureButton" dojoAttachEvent\x3d"onClick: onFirstFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_first}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiPrevIcon" dojoAttachPoint\x3d"prevFeatureButton" dojoAttachEvent\x3d"onClick: onPreviousFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_previous}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiNextIcon" dojoAttachPoint\x3d"nextFeatureButton" dojoAttachEvent\x3d"onClick: onNextFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_next}\x3c/button\x3e\r\n            \x3cbutton  dojoType\x3d"dijit.form.Button" iconClass\x3d"atiButton atiLastIcon" dojoAttachPoint\x3d"lastFeatureButton" dojoAttachEvent\x3d"onClick: onLastFeature" showLabel\x3d"false" type\x3d"button"\x3e${NLS_last}\x3c/button\x3e\r\n        \x3c/div\x3e\r\n    \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/SituationAwareness/Widget.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"panelBottom" class\x3d"panelBottom"\x3e\r\n\r\n    \x3c!-- Panel Footer --\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"footerNode" class\x3d"SA_panelFooter jimu-main-background"\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"panelLeft" class\x3d"SA_panelLeft" data-dojo-attach-event\x3d"onclick:_navTabsLeft"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"footerContentNode" class\x3d"SA_panelFooterContent"\x3e\r\n        \x3c!-- Tabs --\x3e\r\n        \x3cdiv data-dojo-attach-point\x3d"tabsNode" class\x3d"SA_SAT_tabs"\x3e\x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"panelRight" class\x3d"SA_panelRight" data-dojo-attach-event\x3d"onclick:_navTabsRight"\x3e\x3c/div\x3e\r\n      \x3cdiv class\x3d"SA_panelClose" data-dojo-attach-event\x3d"onclick:_close"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n\r\n    \x3c!--Panel Container --\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"panelContainer" class\x3d"panelContainer"\x3e\r\n      \x3c!-- Panel Incident --\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"innerBL" class\x3d"innerBL" data-dojo-attach-event\x3d"onclick:_navLeft"\x3e\x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"SA_tabPanel0" class\x3d"SAT_tabPanel"\x3e\r\n        \x3cdiv class\x3d"SAT_tabPanelContent" style\x3d"width: 660px"\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"incidentsLocate" class\x3d"SATcol"\x3e\r\n            \x3cdiv class\x3d"label"\x3e\r\n              ${nls.locate_incident}\r\n            \x3c/div\x3e\r\n            \x3cbr /\x3e\r\n            \x3cdiv class\x3d"colBar"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"imgContainer"\x3e\r\n                \x3cspan class\x3d"btn32"\x3e \x3cimg data-dojo-attach-point\x3d"SA_btn0"\x3e \x3c/img\x3e \x3c/span\x3e\r\n                \x3cspan class\x3d"btn32"\x3e \x3cimg data-dojo-attach-point\x3d"SA_btn1"\x3e \x3c/img\x3e \x3c/span\x3e\r\n                \x3cspan class\x3d"btn32"\x3e \x3cimg data-dojo-attach-point\x3d"SA_btn2"\x3e \x3c/img\x3e \x3c/span\x3e\r\n              \x3c/div\x3e\r\n              \x3cspan class\x3d"btn32 btnClear" data-dojo-attach-event\x3d"onclick:_clear"\x3e \x3cimg data-dojo-attach-point\x3d"SA_btn3"\x3e \x3c/img\x3e \x3c/span\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv class\x3d"SATcol"\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"buffer_lbl" class\x3d"label"\x3e\x3c/div\x3e\r\n            \x3cbr /\x3e\r\n            \x3cdiv class\x3d"colBar"\x3e\r\n              \x3cdiv data-dojo-attach-point\x3d"horizontalSliderDiv"\x3e\x3c/div\x3e\r\n              \x3cdiv class\x3d"sliderValueDIV"\x3e\r\n                \x3cinput data-dojo-attach-point\x3d"sliderValue" data-dojo-type\x3d"dijit/form/TextBox" class\x3d"sliderValue" name\x3d"sliderValue" value\x3d"15" /\x3e\r\n              \x3c/div\x3e\r\n            \x3c/div\x3e\r\n          \x3c/div\x3e\r\n          \x3cdiv data-dojo-attach-point\x3d"div_reverse_geocoding" class\x3d"SATcol reverseGeocodingDIV"\x3e\r\n            \x3cdiv class\x3d"label"\x3e\r\n              ${nls.reverse_geocoded_address}\r\n            \x3c/div\x3e\r\n            \x3c/br\x3e\r\n            \x3cdiv data-dojo-attach-point\x3d"div_reversed_address" class\x3d"label reversedAddressDIV"\x3e\x3c/div\x3e\r\n          \x3c/div\x3e\r\n        \x3c/div\x3e\r\n      \x3c/div\x3e\r\n      \x3cdiv data-dojo-attach-point\x3d"innerBR" class\x3d"innerBR" data-dojo-attach-event\x3d"onclick:_navRight"\x3e\x3c/div\x3e\r\n    \x3c/div\x3e\r\n    \x3c!-- Panel Message --\x3e\r\n    \x3cdiv data-dojo-attach-point\x3d"messageNode" class\x3d"SA_panelMessage"\x3e\r\n      \x3cspan data-dojo-attach-point\x3d"messageTextNode"\x3e\x3c/span\x3e\r\n    \x3c/div\x3e\r\n  \x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:widgets/SituationAwareness/css/style.css":".jimu-widget-SAT {color: #ffffff !important; background-color: #4c4c4c; left: 0px; right: 0px; bottom: 0px; height: 150px !important; display: block; z-index: 100 !important;}.action2 {padding-left: 10px;}.jimu-widget-SAT .innerBL {display: none; width: 10px; height: 20px; background-image: url('images/nav_left.png'); background-repeat: no-repeat; background-size:cover; position: fixed; bottom: 45px; left: 0px; z-index: 2; background-size:cover; opacity: .6;}.jimu-rtl .jimu-widget-SAT .innerBL {right: 0px;}.jimu-widget-SAT .innerBL:hover {width: 20px; height: 35px; opacity: 1; cursor: pointer; bottom: 40px;}.jimu-widget-SAT .innerBR {display: none; width: 10px; height: 20px; background-image: url('images/nav_right.png'); background-repeat: no-repeat; background-size:cover; position: fixed; bottom: 45px; right: 0px; z-index: 2; opacity: .6;}.jimu-rtl .jimu-widget-SAT .innerBR {left: 0px;}.jimu-widget-SAT .innerBR:hover {width: 20px; height: 35px; opacity: 1; cursor: pointer; bottom: 40px;}.jimu-widget-SAT .rounded {-moz-border-radius: 5px 5px 5px 5px; -webkit-border-radius: 5px 5px 5px 5px; border-radius: 5px 5px 5px 5px;}.jimu-widget-SAT .roundedL {-moz-border-radius: 5px 0px 0px 5px; -webkit-border-radius: 5px 0px 0px 5px; border-radius: 5px 0px 0px 5px;}.jimu-widget-SAT .roundedR {-moz-border-radius: 0px 5px 5px 0px; -webkit-border-radius: 0px 5px 5px 0px; border-radius: 0px 5px 5px 0px;}.jimu-widget-SAT .reverseGeocodingDIV {visibility: hidden;}.jimu-widget-SAT .reversedAddressDIV {width:100%;}.jimu-widget-SAT .sliderValue {width: 60px; align: left;}.jimu-widget-SAT .sliderValueDIV {text-align: center; margin-top: -4px;}.jimu-widget-SAT .panelBottom {position: absolute; width: 100%; height: 150px; left: 0px; top: 0px; text-align: center; color: #ffffff; padding: 0px;}.jimu-widget-SAT .SA_panelMessage {position: absolute; top: 0px; text-align: center; width: 100%; height: 40px; line-height: 40px; display: none;}.jimu-widget-SAT .SA_panelFooter {position: absolute; top: 0px; left: 0px; right: 0px; height: 40px; line-height: 40px; overflow: hidden; border-bottom: 1px solid #353535; border-bottom: 1px solid rgba(0, 0, 0, 0.3);}.jimu-widget-SAT .SA_panelFooterContent {position: absolute; left: 0px; right: 24px; height: 40px; overflow-x: hidden; overflow-y: hidden; display: block;}.jimu-rtl .jimu-widget-SAT .SA_panelFooterContent {position: absolute; left: 24px; right: 0px;}.jimu-widget-SAT .SA_panelClose {position: absolute; left: auto; right: 0px; width: 24px; height: 40px; line-height: 40px; text-align: center; display: block; cursor: pointer; background-image: url('images/x.png'); background-repeat: no-repeat; background-position: center center; background-size: 12px;}.jimu-widget-SAT .SA_panelRight {display: none; position: absolute; left: auto; right: 24px; width: 34px; height: 40px; line-height: 40px; cursor: pointer; background-image: url('images/nav_right.png'); background-repeat: no-repeat; background-position: center center; background-size: 10px; opacity: .4;}.jimu-widget-SAT .SA_panelRight:hover {opacity: 1; background-size: 16px;}.jimu-widget-SAT .SA_panelLeft {display: none; position: absolute; left: 0px; right: auto; height: 40px; line-height: 40px; cursor: pointer; background-image: url('images/nav_left.png'); background-repeat: no-repeat; background-position: center center; background-size: 10px; opacity: .4;}.jimu-widget-SAT .SA_panelLeft:hover {opacity: 1; background-size: 16px;}.jimu-rtl .jimu-widget-SAT .SA_panelClose {position: absolute; left: 0px; right: auto;}.jimu-widget-SAT .panelContainer {position: absolute; top: 40px; width: 100%; height: 110px; overflow: hidden; display: block;}.jimu-widget-SAT .SAT_tabPanel {position: absolute; top: 10px; left: 0px; right: 0px; height: 100px; display: none; overflow: auto;}.jimu-widget-SAT .SAT_tabPanelContent {position: absolute; top: 0px; height: 80px; white-space: nowrap; display: block; user-select: none; -moz-user-select: none; -khtml-user-select: none; -webkit-user-select: none; -o-user-select: none;}.jimu-widget-SAT .SA_SAT_tabs {position: absolute; white-space: nowrap; height: 40px; padding: 0px; overflow-x: visible; overflow-y: hidden;}.jimu-widget-SAT .SATTab {width: auto; max-width: 220px; overflow: hidden; text-overflow: ellipsis; height: 40px; float: left; line-height: 40px; font-size: 13px; padding: 0 10px 0 35px; background-image: url('images/tab.png'); background-repeat: no-repeat; background-position: left center; cursor: pointer; user-select: none; -moz-user-select: none; -khtml-user-select: none; -webkit-user-select: none; -o-user-select: none; opacity: .85;}.jimu-rtl .jimu-widget-SAT .SATTab {float: right;}.jimu-widget-SAT .active {color: #ffffff; background-color: #353535; background-color: rgba(0, 0, 0, 0.3); background-image: url('images/tabon.png'); background-position: left center; background-repeat: no-repeat; opacity: 1;}.jimu-widget-SAT .activeBlack {color: #ffffff; background-color: #353535; background-image: url('images/tabon.png'); background-position: left center; background-repeat: no-repeat; opacity: 1;}.jimu-widget-SAT .SATcol {float: left; height: 80px; width: 220px; border-left: none; border-right: 1px solid #ffffff; border-right: 1px solid rgba(255, 255, 255, 0.5); margin-left: 0; padding: 0 10px; user-select: none; -moz-user-select: none; -khtml-user-select: none; -webkit-user-select: none; -o-user-select: none;}.jimu-widget-SAT .SATcolWrap {white-space: pre-wrap; white-space: -moz-pre-wrap; word-wrap: break-word;}.jimu-widget-SAT .SATcolSave {float: left; height: 90px; width: 220px; border-left: none; border-right: 1px solid #ffffff; border-right: 1px solid rgba(255, 255, 255, 0.5); margin-left: 0; padding: 0 5px; overflow: hidden;}.jimu-rtl .jimu-widget-SAT .SATcolSave {float: right; border-left: 1px solid #ffffff; border-left: 1px solid rgba(255, 255, 255, 0.5); border-right: none;}.jimu-rtl .jimu-widget-SAT .SATcol {float: right; border-left: 1px solid #ffffff; border-left: 1px solid rgba(255, 255, 255, 0.5); border-right: none;}.jimu-widget-SAT .SATcolSmall {float: left; height: 90px; width: 165px; border-left: none; border-right: 1px solid #ffffff; border-right: 1px solid rgba(255, 255, 255, 0.5); margin-left: 0; padding: 0 20px; overflow: hidden; text-overflow: ellipsis;}.jimu-rtl .jimu-widget-SAT .SATcolSmall {float: right; border-left: 1px solid #ffffff; border-left: 1px solid rgba(255, 255, 255, 0.5); border-right: none;}.jimu-widget-SAT .SATcolLast {border-left: none; border-right: none;}.jimu-widget-SAT .SATcol .label,.jimu-widget-SAT .SATcolSmall .label {font-size: 13px; padding: 2px 0;}.jimu-widget-SAT .SATcol .colBar {position: relative; height: 32px; display: block;}.jimu-widget-SAT .SATcolSave .colBar {position: relative; height: 69px; display: block;}.jimu-widget-SAT .btn32 {float: left; width: 32px; height: 32px; padding: 0; color: #ffffff; background-color: #393939; background-color: rgba(0, 0, 0, 0.25); border-radius: 2px; display: block; margin-right: 8px; cursor: pointer;}.jimu-widget-SAT .btn32Save {float: left; width: 32px; height: 32px; padding: 0; color: #ffffff; background-color: #393939; background-color: rgba(0, 0, 0, 0.25); border-radius: 2px; display: block; margin-right: 6px; cursor: pointer;}.jimu-widget-SAT .btn32SaveDisabled {float: left; width: 32px; height: 32px; padding: 0; color: #999999; background-color: #999999; border-radius: 2px; display: block; margin-right: 6px; cursor:default;}.jimu-rtl .jimu-widget-SAT .btn32 {float: right;}.jimu-rtl .jimu-widget-SAT .btn32Save {float: right;}.jimu-widget-SAT .btn32:hover {background-color: #262626; background-color: rgba(0, 0, 0, 0.5);}.jimu-widget-SAT .btn32Save:hover {background-color: #262626; background-color: rgba(0, 0, 0, 0.5);}.jimu-widget-SAT .btnOn {border: 1px solid #ffffff; border: 1px solid rgba(255, 255, 255, 0.75); background-color: #262626; background-color: rgba(0, 0, 0, 0.5);}.jimu-widget-SAT .btn32 img {padding: 8px;}.jimu-widget-SAT .btn32Save img {padding: 8px;}.jimu-widget-SAT .btn32SaveDisabled img {padding: 8px;}.jimu-widget-SAT .btnClear {background-color: #bb0000; margin-left: 16px;}.jimu-rtl .jimu-widget-SAT .btnClear {margin-right: 16px; margin-left: 0;}.jimu-widget-SAT .btnClear:hover {background-color: #ff0000;}.jimu-widget-SAT .dijitTextBox,.jimu-widget-SAT .dijitTextBoxHover,.jimu-widget-SAT .dijitTextBoxFocused,.jimu-widget-SAT .dijitTextBoxHoverFocused {background-color: #393939; background-color: rgba(0, 0, 0, 0.25) !important; color: #ffffff !important; border: 1px solid #a6a6a6; border: 1px solid rgba(255, 255, 255, 0.5) !important; height: 26px !important; line-height: 26px !important;}.jimu-widget-SAT .dijitTextBoxFocused,.jimu-widget-SAT .dijitInputInner,.jimu-widget-SAT .dijitInputContainer {background: transparent !important; color: #ffffff !important; height: 26px !important; line-height: 26px !important;}.jimu-widget-SAT .dijitInputField {padding: 0px 10px !important;}.jimu-widget-SAT .btnExport {background-color: #393939; background-color: rgba(0, 0, 0, 0.25); border-radius: 2px; padding: 10px 44px 10px 10px; background-image: url('images/download.png'); background-repeat: no-repeat; background-position: right center; cursor: pointer;}.jimu-widget-SAT .btnExport:hover {background-color: #262626; background-color: rgba(0, 0, 0, 0.5);}.jimu-widget-SAT .download {background-image: url('images/download.png'); background-repeat: no-repeat; background-position: right 0px center;}.jimu-widget-SAT .processing {background-image: url('images/processing.gif'); background-repeat: no-repeat; background-position: right 10px center;}.jimu-widget-SAT .loading {background-image: url('images/loading.gif'); background-repeat: no-repeat; background-position: center 10px;}.jimu-widget-SAT .colSummary {font-size: 28px; padding-top: 10px;}.jimu-widget-SAT .colGroupedSummary {font-size: 28px; padding-top: 3px;}.jimu-widget-SAT .SATcolRec {float: left; height: 100%; border-left: none; border-right: 1px solid #ffffff; border-right: 1px solid rgba(255, 255, 255, 0.5); margin-left: 0; padding: 0 10px; text-align: left; text-overflow: ellipsis; user-select: none; -moz-user-select: none; -khtml-user-select: none; -webkit-user-select: none; -o-user-select: none; min-width: 220px; max-width: 300px;}.jimu-rtl .jimu-widget-SAT .SATcolRec {float: right; border-left: 1px solid #ffffff; border-left: 1px solid rgba(255, 255, 255, 0.5); border-right: none; text-align: right;}.jimu-widget-SAT .SATcolRecBar {position: relative; height: 26px; width: 100%; display: block;}.jimu-widget-SAT .SATcolRecNum {position: absolute; width: 26px; height: 26px; background-color: #4c4c4c; color: #ffffff; line-height: 26px; text-align: center; border-radius: 13px; font-size: 11px; cursor: pointer;}.jimu-widget-SAT .SATcolDir {position: absolute; right: 0px; width: 26px; height: 26px; background-image: url('images/car.png'); background-repeat: no-repeat; background-position: center center; cursor: pointer;}.jimu-rtl .jimu-widget-SAT .SATcolDir {position: absolute; left: 0px; right: auto;}.jimu-widget-SAT .SATcolDistance {position: absolute; left: 30px; right: 30px; height: 26px; font-size: 11px; line-height: 26px;}.jimu-widget-SAT .SATcolInfo {position: relative; margin-top: 5px; width: 100%; display: block; overflow: hidden;}.claro .dijitSlider {background: transparent; border: 0 none; -webkit-border-radius: 3px; border-radius: 3px; padding: 0;}.claro .dijitSliderBar {border-style: solid; outline: 1px;}.claro .dijitRuleLabelsContainer {color: #2b2e34;}.claro .dijitSliderDisabled {opacity: 0.65; -ms-filter: \"progid:DXImageTransform.Microsoft.Alpha(Opacity\x3d65)\"; filter: alpha(opacity\x3d65);}.claro .dijitRuleLabelsContainerH {padding: 8px 0 !important; color: #6e6e6e !important;}.claro .dijitSliderBarH,.claro .dijitSliderBumperH {height: 4px;}.claro .dijitSlider .dijitSliderLeftBumper {-webkit-border-radius: 2px 0 0 2px; border-radius: 2px 0 0 2px; border-width: 1px 0 1px 1px; margin-left: 4px;}.claro .dijitSlider .dijitSliderRightBumper {-webkit-border-radius: 0 2px 2px 0; border-radius: 0 2px 2px 0; border-width: 1px 1px 1px 0; margin-left: -2px; margin-right: 4px;}.claro .dijitSlider .dijitSliderProgressBarH {border-color: #ebebeb; background-color: #ebebeb; background-image: none; -webkit-box-shadow: none; box-shadow: none;}.claro .dijitSlider .dijitSliderLeftBumper {border-color: #ebebeb; background-color: #ebebeb; background-image: none; -webkit-box-shadow: none; box-shadow: none; -webkit-border-radius: 2px 0 0 2px; border-radius: 2px 0 0 2px;}.claro .dijitSlider .dijitSliderRemainingBarH,.claro .dijitSlider .dijitSliderRightBumper {border-color: #878787; background-color: #878787; -webkit-border-radius: 2px; border-radius: 2px;}.claro .dijitSliderHover .dijitSliderProgressBarH,.claro .dijitSliderHover .dijitSliderLeftBumper {border-color: #ebebeb; background-color: #ebebeb; background-image: none; -webkit-box-shadow: none; box-shadow: none;}.claro .dijitSliderFocused .dijitSliderProgressBarH,.claro .dijitSliderFocused .dijitSliderLeftBumper {border-color: #ebebeb;}.claro .dijitSliderFocused .dijitSliderRemainingBarH,.claro .dijitSliderFocused .dijitSliderRightBumper {border-color: #878787; background-color: #878787; -webkit-box-shadow: none; box-shadow: none;}.claro .dijitSliderImageHandle {background: #ffffff; -webkit-border-radius: 50%; border-radius: 50%; border: 0 none; width: 16px; height: 16px; margin-top: -2px; position: absolute;}.claro .dijitSliderImageHandle:after {content: \"\"; display: block; background: #6e6e6e; -webkit-border-radius: 50%; border-radius: 50%; height: 8px; width: 8px; left: 4px; top: 4px; position: absolute;}.claro .dijitSliderDisabled.dijitSliderFocused .dijitSliderImageHandle:after {display: none; outline: none;}.claro .dijitSliderDecrementIconH,.claro .dijitSliderIncrementIconH {padding: 0; height: 20px; width: 20px; background-color: transparent; border: 0 none;}.claro .dijitButtonText{padding-left: 3px;}.esriAttributeInspector .atiRichTextField{}.esriAttributeInspector div.dijitEditorIFrameContainer {height: 78px; width: 100%;}.esriAttributeInspector .dijitTextBox.dijitTextArea {height: 32px;}.esriAttributeInspector .atiButton {padding-top:2px; margin-right: 10px; display: inline-table;}.esriAttributeInspector .atiButtons {height:30px; width:100%; display:inline-block; width:100%;}.esriAttributeInspector {display:inline-block;} .esriAttributeInspector .dijitArrowButtonContainer {margin-top:0px; margin-right:0px; margin-bottom:0px; width:18px;}.esriAttributeInspector .atiNavButtons {display:none; visibility:hidden; height: 0px;}.esriPopup .spinner {display: none;}",
"*now":function(t){t(['dojo/i18n!*preload*widgets/SituationAwareness/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","hr","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dijit/_WidgetsInTemplateMixin dijit/form/Button jimu/BaseWidget jimu/dijit/Message jimu/utils jimu/LayerInfos/LayerInfos dojo/_base/Color dojo/_base/html dojo/dom dojo/on dojo/dom-style dojo/dom-class dojo/dom-construct dojo/dom-geometry dojo/_base/lang dojo/_base/array dojo/_base/xhr dojo/query dojo/json dijit/form/HorizontalSlider dijit/form/HorizontalRuleLabels esri/geometry/Extent esri/geometry/geometryEngine esri/geometry/Polygon esri/geometry/Point esri/geometry/Multipoint esri/geometry/Polyline esri/geometry/webMercatorUtils esri/geometry/jsonUtils esri/graphic esri/layers/GraphicsLayer esri/layers/FeatureLayer esri/symbols/Font esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/symbols/SimpleMarkerSymbol esri/symbols/TextSymbol esri/tasks/locator esri/tasks/BufferParameters esri/tasks/GeometryService esri/toolbars/draw esri/domUtils esri/dijit/AttributeInspector esri/dijit/Popup esri/tasks/query ./js/SummaryInfo ./js/GroupedCountInfo ./js/WeatherInfo ./js/ClosestInfo ./js/ProximityInfo dojo/keys dojo/domReady!".split(" "),function(t,
m,l,n,f,d,a,c,e,w,g,y,p,x,k,v,b,s,u,r,H,z,F,M,N,A,D,E,C,B,h,q,G,K,J,I,O,P,R,S,Q,L,aa,T,ba,U,V,W,$,X,Y,Z){return t([n,m],{baseClass:"jimu-widget-SAT",name:"IncidentAnalysis",opLayers:null,curTab:0,lyrBuffer:null,lyrIncidents:null,lyrClosest:null,lyrProximity:null,lyrSummary:null,lyrEdit:null,toolbar:null,tool:-1,symPoint:null,symLine:null,symPoly:null,symBuffer:null,symRoute:null,incident:null,buffer:null,gsvc:null,locator:null,stops:[],initalLayerVisibility:{},updateFeature:null,startX:0,mouseDown:!1,
btnNodes:[],panelNodes:[],tabNodes:[],currentSumLayer:null,currentGrpLayer:null,mapBottom:null,mapResize:null,Incident_Local_Storage_Key:"SAT_Incident",SLIDER_MAX_VALUE:1E4,postCreate:function(){this.inherited(arguments);this.widgetActive=!0;window.localStorage.setItem(this.Incident_Local_Storage_Key,null)},startup:function(){this.inherited(arguments);this.btnNodes=[];this.panelNodes=[];this.tabNodes=[];this.editTemplate=this.config.editTemplate;this.saveEnabled=this.config.saveEnabled;this.summaryDisplayEnabled=
this.config.summaryDisplayEnabled;this.isSafari=-1!==navigator.userAgent.indexOf("Safari");this._getStyleColor();this._createUI();this._loadUI();this._initLayers();this._verifyRouting();this._getAttributeTable();this.SLIDER_MAX_VALUE=this.config.bufferRange.maximum;this.opLayers=this.map.itemInfo.itemData.operationalLayers;this._mapLoaded()},onOpen:function(){this.inherited(arguments);this.widgetActive=!0;this.map.infoWindow.isShowing&&this.map.infoWindow.hide();this.setPosition();this.windowResize=
g(window,"resize",v.hitch(this,this._resize));null===this.mapResize&&(this.mapResize=this.map.on("resize",v.hitch(this,this._mapResize)));this._mapResize();this._storeInitalVisibility();this._initEditInfo();this._addActionLink();this._clickTab(0);this._restoreIncidents()},onClose:function(){this._storeIncidents();this._toggleTabLayersOld();this._resetInfoWindow();this._removeActionLink();this.mapResize&&(this.mapResize.remove(),this.mapResize=null);this.windowResize.remove();this.windowResize=null;
this._clear();this.widgetActive=!1;this.saveEnabled&&(this.scSignal.remove(),this.sfSignal.remove());this._mapResize();this._resetInitalVisibility();this.inherited(arguments)},onDeActive:function(){this._clickIncidentsButton(-1)},destroy:function(){this._clear();this._toggleTabLayersOld();this.lyrBuffer&&this.map.removeLayer(this.lyrBuffer);this.lyrIncidents&&this.map.removeLayer(this.lyrIncidents);this.lyrClosest&&this.map.removeLayer(this.lyrClosest);this.lyrProximity&&this.map.removeLayer(this.lyrProximity);
this.lyrSummary&&this.map.removeLayer(this.lyrSummary);this.lyrGroupedSummary&&this.map.removeLayer(this.lyrGroupedSummary);this.inherited(arguments)},onAppConfigChanged:function(a,b){switch(b){case "styleChange":this._updateUI();break;case "widgetPoolChange":this._verifyRouting();break;case "mapChange":window.localStorage.setItem(this.Incident_Local_Storage_Key,null)}},_addActionLink:function(){var a=this.nls.actionLabel,b;this.hideContainer=!1;var c=this.map.infoWindow,d=u(".actionList",c.domNode);
0<d.length?b=d[0]:c.popupInfoView&&c.popupInfoView.container&&(b=c.popupInfoView.container,this.hideContainer=!0);b&&(d=u("#SA_actionLink",b),a=0<d.length?d[0]:x.create("a",{"class":"action",id:"SA_actionLink",innerHTML:a,href:"javascript: void(0);"},b),this.hideContainer&&(p.add("SA_actionLink","action2"),this.own(g(c,"show",v.hitch(this,this._handlePopup)))),this.own(g(a,"click",v.hitch(this,this._setEventLocation,this.hideContainer))))},_handlePopup:function(){this._clearMobileSetAsIncidentStyle();
var a=w.byId("main-page"),b,c,d;this.map.infoWindow.popupInfoView?(b=this.map.infoWindow.popupInfoView.container,c=".mainSection { overflow-y: auto; height: "+(a.clientHeight-60).toString()+"px; }",d=".atiAttributes {overflow: auto; height: "+(a.clientHeight-130).toString()+"px; }"):(b=u("div.atiAttributes",this.map.infoWindow.domNode)[0],c=".mainSection { overflow-y: none; }",d=".atiAttributes {overflow: none; }");a.clientHeight&&b&&(a=document.createElement("style"),a.type="text/css",a.id="_tempMainSectionOverride",
b.appendChild(a),a.sheet.insertRule(c,0),a.sheet.insertRule(d,1))},_removeActionLink:function(){w.byId("SA_actionLink")&&x.destroy(w.byId("SA_actionLink"))},_updateUI:function(){this._getStyleColor()},_getStyleColor:function(){setTimeout(v.hitch(this,function(){var a=window.getComputedStyle(this.footerNode,null).getPropertyValue("background-color");this.config.color=c.fromRgb(a).toHex();(this.isBlackTheme="#000000"===this.config.color?!0:!1)?(p.remove(this.tabNodes[this.curTab],"active"),p.add(this.tabNodes[this.curTab],
"activeBlack")):(p.remove(this.tabNodes[this.curTab],"activeBlack"),p.add(this.tabNodes[this.curTab],"active"));this._setupSymbols();this._bufferIncident()}),500)},setPosition:function(a,b){if(this.widgetActive){var c,f,g=w.byId("map");"TabTheme"===this.appConfig.theme.name?(f=this.widgetManager.getControllerWidgets()[0],this.position=c={left:f.domNode.clientWidth?f.domNode.clientWidth.toString()+"px":"54px",right:"0",bottom:"24px",height:"150px",relativeTo:"browser"},c=d.getPositionStyle(this.position),
c.position="absolute",e.place(this.domNode,window.jimuConfig.layoutId),e.setStyle(this.domNode,c),this.started&&this.resize(),g.style.bottom="150px",this.map.resize(!0),"TabTheme"===this.appConfig.theme.name&&this.widgetManager.minimizeWidget(f.id)):(this.position=c={left:"0",right:"0",bottom:"0",height:"150px",relativeTo:"browser"},c=d.getPositionStyle(this.position),c.position="absolute",e.place(this.domNode,window.jimuConfig.layoutId),e.setStyle(this.domNode,c),this.started&&this.resize(),g.style.bottom=
"150px",this.map.resize(!0))}},disableWebMapPopup:function(){this.map&&this.map.setInfoWindowOnClick(!1)},enableWebMapPopup:function(){this.map&&this.map.setInfoWindowOnClick(!0)},_setEventLocation:function(a){this.lyrIncidents.clear();this.lyrBuffer.clear();var b={eventType:"IncidentLocation",dataValue:this.map.infoWindow.getSelectedFeature()};this.onReceiveData("","",b);this.map.infoWindow.isShowing&&this.map.infoWindow.hide();a&&(a=this.map.infoWindow,a.popupNavigationBar&&(b=u(".esriMobileNavigationBar",
a.popupNavigationBar.domNode),0<b.length&&e.setStyle(b[0],"display","none")),a.popupInfoView&&(b=u(".esriMobileInfoView",a.popupInfoView.domNode),0<b.length&&e.setStyle(b[0],"display","none")))},_initLayers:function(){this.gsvc=new Q(this.config.geometryService.url);this.locator=new R(this.config.geocodeService.url);this.own(g(this.locator,"location-to-address-complete",v.hitch(this,this._showIncidentAddress)));this.own(g(this.locator,"error",v.hitch(this,this._onAddressError)));this.lyrBuffer=new q;
this.map.addLayer(this.lyrBuffer);this.lyrIncidents=new q;this.map.addLayer(this.lyrIncidents);this.lyrClosest=new q;this.lyrClosest.setVisibility(!1);this.map.addLayer(this.lyrClosest);this.lyrProximity=new q;this.lyrProximity.setVisibility(!1);this.map.addLayer(this.lyrProximity);this.summaryDisplayEnabled&&(this.lyrSummary=new q,this.lyrSummary.setVisibility(!1),this.map.addLayer(this.lyrSummary));this.summaryDisplayEnabled&&(this.lyrGroupedSummary=new q,this.lyrGroupedSummary.setVisibility(!1),
this.map.addLayer(this.lyrGroupedSummary))},_mapLoaded:function(){u("[data-reference]").style("z-index",0);this.map.itemId&&a.getInstance(this.map,this.map.itemInfo).then(v.hitch(this,function(a){this.opLayers=a;this._processOperationalLayers();if(this.saveEnabled){a=this.map.infoWindow;this.lyrEdit=this.opLayers.getLayerInfoById(this.config.editLayer).layerObject;this.scSignal=g(a,"selection-change",v.hitch(this,this._selectionChanged));this.sfSignal=g(a,"set-features",v.hitch(this,this._setPopupFeature));
var b=u(".esriPopupWrapper",a.domNode);0<b.length&&("undefined"!==typeof b[0].clientHeight&&"undefined"!==typeof b[0].clientWidth)&&(this.defaultPopupSize={width:b[0].clientWidth});a.highlight=!0;this.own(g(this.lyrEdit,"click",v.hitch(this,function(a){a.graphic&&(this.updateFeature=a.graphic,this._updatePopup(this.updateFeature))})));this.editLayerPrototype=this.editTemplate.prototype}}));var b=this.map.itemInfo.itemData.baseMap.baseMapLayers[0];if("ArcGISTiledMapServiceLayer"!==b.layerType||!b.resourceInfo.singleFusedMapCache)this.config.defaultZoomLevel=
0.5;this._clickTab(0)},_initEditInfo:function(){this.saveEnabled&&this.lyrEdit&&(this.map.infoWindow.resize(350,340),this.defaultContent=this.lyrEdit.infoTemplate?this.lyrEdit.infoTemplate.content:void 0,this.lyrEdit.infoTemplate.setContent(v.hitch(this,this._setEditLayerPopup)))},_setPopupFeature:function(){this.updateFeature=this.map.infoWindow.getSelectedFeature()},_selectionChanged:function(){(this.updateFeature=this.map.infoWindow.getSelectedFeature())&&this._updatePopup(this.updateFeature)},
_setEditLayerPopup:function(a){for(var b=[],c=this._getPopupFields(this.lyrEdit),d=0;d<c.length;d++){var e=c[d];e.isEditable&&e.isEditableOnLayer&&b.push({fieldName:e.fieldName,isEditable:e.isEditable})}this.attInspector=new T({layerInfos:[{featureLayer:this.lyrEdit,showAttachments:!1,isEditable:!0,fieldInfos:b}]},x.create("div"));b=new l({label:this.nls.update_btn},x.create("div"));x.place(b.domNode,this.attInspector.deleteBtn.domNode.parentNode);this.own(g(b,"click",v.hitch(this,function(){this.lyrEdit.applyEdits(null,
[this.updateFeature],null,v.hitch(this,function(){new f({message:this.nls.updateComplete});this.map.infoWindow.hide()}),function(a){var b="Error";"undefined"!==typeof a.details&&(b=a.details);"undefined"!==typeof a.message&&(b=a.message);new f({message:b})})})));this.own(g(this.attInspector,"attribute-change",v.hitch(this,function(a){this.updateFeature=a.feature;this.updateFeature.attributes[a.fieldName]=a.fieldValue})));this.own(g(this.attInspector,"next",v.hitch(this,function(a){this.updateFeature=
a.feature})));this.own(g(this.attInspector,"delete",v.hitch(this,function(a){var b=!1;this.incident&&(M.equals(a.feature.geometry,this.incident.geometry)&&(b=!0),!b&&0<this.lyrBuffer.graphics.length&&M.equals(a.feature.geometry,this.lyrBuffer.graphics[0].geometry)&&(b=!0));this.lyrEdit.applyEdits(null,null,[a.feature],v.hitch(this,function(){new f({message:this.nls.deleteComplete})}),function(a){var b="Error";"undefined"!==typeof a.details&&(b=a.details);"undefined"!==typeof a.message&&(b=a.message);
new f({message:b})});this.updateFeature=this.editLayerPrototype;b&&this._clear();this.map.infoWindow.hide()})));this.updateFeature=a;this.attInspector.showFeature(this.updateFeature);return this.attInspector.domNode},_getPopupFields:function(a){var b;if(a.infoTemplate)b=a.infoTemplate.info.fieldInfos;else if(-1<this.tab.tabLayers[0].url.indexOf("MapServer")){var c=this.tab.tabLayers[0].url.split("MapServer/")[1],d=this.parent.map.itemInfo.itemData.operationalLayers;b=null;for(var e=0;e<d.length;e++){var f=
d[e];if(f.layerObject.infoTemplates&&(f=f.layerObject.infoTemplates[c])){b=f.infoTemplate.info.fieldInfos;break}}}else b=a.fields;b||(b=a.fields);return b},_updatePopup:function(a){if("undefined"!==typeof a){var b=new U;a.hasOwnProperty("attributes")?b.objectIds=[a.attributes[a.getLayer().objectIdField]]:b.objectIds=[a];this.lyrEdit.selectFeatures(b,G.SELECTION_NEW,v.hitch(this,function(a){0<a.length&&(this.updateFeature=a[0],this.attInspector||this._setEditLayerPopup(this.updateFeature),this.attInspector&&
this.attInspector.showFeature(this.updateFeature))}))}},_processOperationalLayers:function(){for(var a=0;a<this.config.tabs.length;a++){var b=this.config.tabs[a];b.layers&&""!==b.layers&&(b.tabLayers=this._getTabLayers(b.layers))}},_createUI:function(){var a=this.config.distanceUnits,b=d.stripHTML(this.config.bufferLabel?this.config.bufferLabel:""),b=b+(" ("+this.nls[a]+")");this.buffer_lbl.innerHTML=b;a=this.horizontalSliderDiv;b=document.createElement("div");a.appendChild(b);b=document.createElement("div");
a.appendChild(b);var b=new z({container:"bottomDecoration",minimum:this.config.bufferRange.minimum,maximum:this.config.bufferRange.maximum,labels:[this.config.bufferRange.minimum,this.config.bufferRange.maximum],style:"height:2em;font-size:75%;color:#fff"},b),c=Math.abs(Math.round(this.config.bufferRange.maximum-this.config.bufferRange.minimum))+1,e=this.config.bufferRange.minimum;e>this.config.bufferRange.maximum&&(e=this.config.bufferRange.minimum);this.horizontalSlider=new H({value:e,minimum:this.config.bufferRange.minimum,
maximum:this.config.bufferRange.maximum,discreteValues:c,intermediateChanges:!1,showButtons:!1,style:"width:180px;"},a);this.own(g(this.horizontalSlider,"change",v.hitch(this,this._sliderChange)));this.horizontalSlider.startup();b.startup();this.sliderValue.set("value",e);this.config.tabs.splice(0,0,{type:"incidents",label:this.nls.incident,color:this.config.color});this.panelNodes.push(this.SA_tabPanel0);a=this.panelContainer;b=this.tabsNode;for(e=c=0;e<this.config.tabs.length;e++){var f=this.config.tabs[e],
h=f.label;"weather"===f.type&&(h=this.nls.weather);if(!h||""===h)h=f.layers;h=x.create("div",{"data-dojo-attach-point":"SA_tab"+e,innerHTML:d.stripHTML(h?h:"")},b);this.tabNodes.push(h);p.add(h,"SATTab");c+=k.position(h).w;g(h,"click",v.hitch(this,this._clickTab,e));0<e&&(h=x.create("div",{"data-dojo-attach-point":"SA_tabPanel"+e,innerHTML:this.nls.defaultTabMsg},a),this.panelNodes.push(h),p.add(h,"SAT_tabPanel"),"summary"===f.type&&(f.summaryInfo=new V(f,h,this),this.own(g(f.summaryInfo,"summary-complete",
v.hitch(this,this.restore)))),"groupedSummary"===f.type&&(f.groupedSummaryInfo=new W(f,h,this),this.own(g(f.groupedSummaryInfo,"summary-complete",v.hitch(this,this.restore)))),"weather"===f.type&&(f.weatherInfo=new $(f,h,this)),"closest"===f.type&&(f.closestInfo=new X(f,h,this)),"proximity"===f.type&&(f.proximityInfo=new Y(f,h,this)))}c+=10;y.set(b,"width",c+"px");c>k.position(this.footerNode).w&&(y.set(this.footerContentNode,"right","58px"),y.set(this.panelRight,"display","block"),g(b,"scroll",v.hitch(this,
this._onPanelScroll)))},restore:function(a){a.tab===this.curTab&&this._clickTab(a.tab)},_loadUI:function(){var a={"0":this.nls.drawPoint,1:this.nls.drawLine,2:this.nls.drawPolygon,3:this.nls.clearIncident,4:this.nls.saveIncident};this.btnNodes=[this.SA_btn0,this.SA_btn1,this.SA_btn2,this.SA_btn3];var b=4;this.saveEnabled&&(p.remove(this.incidentsLocate,"SATcol"),p.add(this.incidentsLocate,"SATcolSave"),b=5,this.saveSpan=x.create("span",{"class":"btn32SaveDisabled"},this.imgContainer),this.btnNodes.push(x.create("img",
{"data-dojo-attach-point":"SA_btn4"},this.saveSpan)));for(var c=0;c<b;c++){var d=this.btnNodes[c];this.saveEnabled&&(p.remove(d.parentNode,"btn32"),4>c&&p.add(d.parentNode,"btn32Save"));e.setAttr(d,"src",this.folderUrl+"images/btn"+c+".png");e.setAttr(d,"title",a[c]);this.own(g(d,"click",v.hitch(this,this._clickIncidentsButton,c)))}this.toolbar=new L(this.map,{tooltipOffset:20,drawTime:90});this.toolbar.on("draw-end",v.hitch(this,this._drawIncident));this.own(g(this.horizontalSlider,"change",v.hitch(this,
this._sliderChange)));this.own(g(this.sliderValue,"blur",v.hitch(this,function(a){this._updateSliderValue(!0)})));this.own(g(this.sliderValue,"keyup",v.hitch(this,function(a){a.keyCode===Z.ENTER?this._updateSliderValue(!0):this._updateSliderValue(!1)})))},_locateBuffer:function(a){if(null!==a&&(a="extent"===a.type?a:a.geometry.getExtent(),null!==a)){a=a.expand(1.5);var b=80/this.map.height,c=a.getHeight();a.update(a.xmin,a.ymin-c*b,a.xmax,a.ymax-c*b,this.map.spatialReference);this.map.setExtent(a,
!0)}},_clickIncidentsButton:function(a){var b,c=this.saveEnabled?5:4;if(a<c){for(var d=0;d<c;d++)b=this.btnNodes[d],p.remove(b,"btnOn");-1<a&&a!==this.tool?(b=this.btnNodes[a],a<c-1&&p.add(b,"btnOn"),this.tool=a):this.tool=-1;switch(this.tool){case -1:this.toolbar.deactivate();this.enableWebMapPopup();break;case 0:this._clear();this.toolbar.activate(L.POINT);this.disableWebMapPopup();break;case 1:this._clear();this.toolbar.activate(L.POLYLINE);this.disableWebMapPopup();break;case 2:this._clear();
this.toolbar.activate(L.POLYGON);this.disableWebMapPopup();break;case 4:this.incident&&this._saveIncident()}}else this._clear()},_saveIncident:function(){var a=[];1>this.lyrBuffer.graphics.length&&"polygon"!==this.incident.geometry.type&&new f({message:this.nls.notPolySave});for(var b=0;b<this.lyrBuffer.graphics.length;b++){var c=this.lyrBuffer.graphics[b],d=new h;d.geometry=c.geometry;c=r.parse(r.stringify(this.editTemplate.prototype));d.setAttributes(c.attributes);a.push(d)}0<a.length&&this.lyrEdit.applyEdits(a,
null,null,v.hitch(this,function(a){if(0<a.length&&a[0].success&&(a[0].hasOwnProperty("objectId")&&this._updatePopup(a[0].objectId),new f({message:this.nls.editComplete}),!this.map.infoWindow.isShowing&&0<this.lyrBuffer.graphics.length)){a=this.lyrBuffer.graphics[0].geometry.getCentroid();var b=this.map.toScreen(a);this.map.emit("click",{bubbles:!0,cancelable:!0,screenPoint:b,mapPoint:a})}}),function(a){var b="Error";"undefined"!==typeof a.details&&(b=a.details);"undefined"!==typeof a.message&&(b=
a.message);new f({message:b})});this._clickIncidentsButton(-1)},_clear:function(){this.map.graphics.clear();this.lyrIncidents.clear();this.lyrBuffer.clear();this.lyrProximity.clear();this.lyrClosest.clear();this.summaryDisplayEnabled&&this.lyrSummary&&this.lyrSummary.clear();this.summaryDisplayEnabled&&this.lyrGroupedSummary&&this.lyrGroupedSummary.clear();this.saveEnabled&&(p.remove(this.saveSpan,"btn32Save"),p.add(this.saveSpan,"btn32SaveDisabled"));this.buffer=this.incident=null;this.div_reversed_address&&
(this.div_reversed_address.innerHTML="");this.div_reverse_geocoding&&e.setStyle(this.div_reverse_geocoding,"visibility","hidden");for(var a=1;a<this.config.tabs.length;a++)this.panelNodes[a]&&(this.panelNodes[a].innerHTML=this.nls.defaultTabMsg);this._clearGraphics();this.lyrEdit&&(this.updateFeature=this.editLayerPrototype);this._clearMobileSetAsIncidentStyle()},_clearMobileSetAsIncidentStyle:function(){x.destroy(w.byId("_tempMainSectionOverride"))},_sliderChange:function(){this.sliderValue.set("value",
this.horizontalSlider.value);this._bufferIncident()},_sliderTextChange:function(){0>this.sliderValue.value||this.sliderValue.value>this.SLIDER_MAX_VALUE?this.sliderValue.set("value",this.horizontalSlider.value):this.horizontalSlider.set("value",this.sliderValue.value)},_updateSliderValue:function(a){var b=this.sliderValue.get("value");isNaN(b)&&this.sliderValue.set("value",this.horizontalSlider.value);"string"===typeof b&&(b=parseInt(b,10));b<this.config.bufferRange.minimum?this.sliderValue.set("value",
this.config.bufferRange.minimum):b>this.SLIDER_MAX_VALUE&&this.sliderValue.set("value",this.SLIDER_MAX_VALUE);a&&(0>this.sliderValue.displayedValue||this.sliderValue.displayedValue>this.SLIDER_MAX_VALUE?this.sliderValue.set("value",this.horizontalSlider.value):this.horizontalSlider.set("value",this.sliderValue.displayedValue))},_clickTab:function(a){this._toggleTabs(a);this._toggleTabLayers(a);this.curTab=a;this._clickIncidentsButton(-1)},_toggleTabs:function(a){for(var b=0;b<this.config.tabs.length;b++)b===
a?(p.add(this.tabNodes[b],this.isBlackTheme?"activeBlack":"active"),y.set(this.panelNodes[b],"display","block")):(p.remove(this.tabNodes[b],"active"),p.remove(this.tabNodes[b],"activeBlack"),y.set(this.panelNodes[b],"display","none"));this._scrollToTab(a)},_toggleTabLayers:function(a){this._toggleTabLayersOld();this._toggleTabLayersNew(a)},_toggleTabLayersOld:function(){var a=this.config.tabs[this.curTab];a&&(this.lyrClosest.setVisibility(!1),this.lyrProximity.setVisibility(!1),this.lyrSummary&&this.lyrSummary.setVisibility(!1),
this.lyrGroupedSummary&&this.lyrGroupedSummary.setVisibility(!1),a.tabLayers&&b.forEach(a.tabLayers,function(a){"undefined"!==typeof a.visible&&a.setVisibility(!1)}))},_toggleTabLayersNew:function(a){var c=this.config.tabs[a];switch(c.type){case "summary":var d=!1;this.lyrSummary&&(this.currentSumLayer!==a&&(d=!0),this.lyrSummary.clear());c.tabLayers&&1<c.tabLayers.length&&(this.lyrSummary.infoTemplate=c.tabLayers[1].infoTemplate,b.forEach(c.tabLayers[1].graphics,v.hitch(this,function(a){this.lyrSummary.add(a)})),
this.lyrSummary.setVisibility(!0),d&&(this.currentSumLayer=a,this._toggleTabLayersNew(a)));this.incident&&!0===c.updateFlag&&(d=this.summaryDisplayEnabled?this.lyrSummary:null,this.buffer&&c.summaryInfo.updateForIncident(this.incident,this.buffer,d,a),c.updateFlag=!1,this.currentSumLayer=a);break;case "groupedSummary":this.lyrGroupedSummary&&(this.currentSumLayer!==a&&(d=!0),this.lyrGroupedSummary.clear());c.tabLayers&&1<c.tabLayers.length&&(this.lyrGroupedSummary.infoTemplate=c.tabLayers[1].infoTemplate,
b.forEach(c.tabLayers[1].graphics,v.hitch(this,function(a){this.lyrGroupedSummary.add(a)})),this.lyrGroupedSummary.setVisibility(!0),d&&(this.currentSumLayer=a,this._toggleTabLayersNew(a)));this.incident&&!0===c.updateFlag&&(d=this.summaryDisplayEnabled?this.lyrGroupedSummary:null,this.buffer&&c.groupedSummaryInfo.updateForIncident(this.incident,this.buffer,d,a),c.updateFlag=!1,this.currentGrpLayer=a);break;case "weather":c.tabLayers&&b.forEach(c.tabLayers,function(a){a.setVisibility(!0)});this.incident&&
!0===c.updateFlag&&(c.weatherInfo.updateForIncident(this.incident),c.updateFlag=!1);break;case "closest":c.tabLayers&&b.forEach(c.tabLayers,function(a){"undefined"!==typeof a.visible&&a.setVisibility(!0)});this.lyrClosest.setVisibility(!0);this.incident&&(c.closestInfo&&c.closestInfo.container&&(c.closestInfo.container.innerHTML="",p.add(c.closestInfo.container,"loading")),!1===c.updateFlag&&this.lyrClosest.clear(),c.closestInfo.updateForIncident(this.incident,this.config.maxDistance,this.lyrClosest),
c.updateFlag=!1);break;case "proximity":c.tabLayers&&b.forEach(c.tabLayers,function(a){"undefined"!==typeof a.visible&&a.setVisibility(!0)}),this.lyrProximity.setVisibility(!0),this.incident&&this.buffer?(c.proximityInfo&&c.proximityInfo.container&&(c.proximityInfo.container.innerHTML="",p.add(c.proximityInfo.container,"loading")),!1===c.updateFlag&&this.lyrProximity.clear(),c.proximityInfo.updateForIncident(this.incident,this.buffer,this.lyrProximity),c.updateFlag=!1):this.incident&&(!0===c.updateFlag&&
!this.buffer)&&(c.proximityInfo.container.innerHTML=this.nls.defaultTabMsg)}c.updateFlag=!1},_drawIncident:function(a,b){var c=a.geometry.type,d=this.symPoint;"polyline"===c&&(d=this.symLine);"polygon"===c&&(d=this.symPoly);this.incident=new h(a.geometry,d);this.lyrIncidents.add(this.incident);this.toolbar.deactivate();this._clickIncidentsButton(-1);this.saveEnabled&&(p.remove(this.saveSpan,"btn32SaveDisabled"),p.add(this.saveSpan,"btn32Save"));this._bufferIncident(b);"point"===c&&this._getIncidentAddress(a.geometry);
this.div_reversed_address.innerHTML="";e.setStyle(this.div_reverse_geocoding,"visibility","hidden")},_getIncidentAddress:function(a){this.map.graphics.clear();this.locator.locationToAddress(C.webMercatorToGeographic(a),100)},_showIncidentAddress:function(a){if(a.address.address){var b=a.address.address.Address,c=C.geographicToWebMercator(a.address.location),d=new K;d.family="Arial";d.size="18px";d=new P(b,d,"#000000");d.setOffset(20,-4);d.horizontalAlignment="left";this.map.graphics.add(new h(c,d,
{}));this.div_reversed_address.innerHTML=b+"\x3c/br\x3e"+a.address.address.City+", "+a.address.address.Region+" "+a.address.address.Postal;e.setStyle(this.div_reverse_geocoding,"visibility","visible")}},_onAddressError:function(){this.div_reversed_address.innerHTML=this.nls.reverse_geocoded_error;e.setStyle(this.div_reverse_geocoding,"visibility","visible")},_bufferIncident:function(a){if(null!==this.incident){for(var b=0;b<this.config.tabs.length;b++)this.config.tabs[b].updateFlag=!0;b=this.incident;
this.buffer=null;this.lyrBuffer.clear();var c=this.horizontalSlider.value,d=this.config.distanceSettings[this.config.distanceUnits];if(0<c){var e=b.geometry.spatialReference.wkid,b=4326===e||3857===e||102100===e&&!this.isSafari?M.geodesicBuffer(b.geometry,c,d):M.buffer(b.geometry,c,d);this._handleBuffer(b,this.symBuffer,a)}else"polygon"===b.geometry.type&&this._handleBuffer(b.geometry,this.symPoly,a)}},_handleBuffer:function(a,b,c){c||this._locateBuffer(a.getExtent());this.buffer=new h(a,b);this.lyrBuffer.add(this.buffer);
this._performAnalysis()},_performAnalysis:function(){this._toggleTabLayersNew(this.curTab)},_verifyRouting:function(){if(this.config.enableRouting){this.config.enableRouting=!1;var a=this.appConfig.getConfigElementsByName("Directions");b.forEach(a,v.hitch(this,function(a){"Directions"===a.name&&(this.dirConfig=a,this.config.enableRouting=!0)}))}},_getAttributeTable:function(){var a=this.appConfig.getConfigElementsByName("AttributeTable");b.forEach(a,v.hitch(this,function(a){"AttributeTable"===a.name&&
(this.attributeTable=a)}))},zoomToLocation:function(a){var b;if(0.5===this.config.defaultZoomLevel){var c;this.buffer?c=this.buffer._extent:"point"!==this.incident.geometry.type&&(c=this.incident._extent);c&&(b=c.expand(0.5))}b?(this.map.setExtent(b),this.map.centerAt(a)):this.map.centerAndZoom(a,this.config.defaultZoomLevel)},routeToIncident:function(a){var b=this.incident.geometry,c=b;"point"!==b.type&&(c=null);this.stops=[c,a];this.widgetManager.triggerWidgetOpen(this.dirConfig.id).then(v.hitch(this,
function(a){if(a&&"closed"!==a.state){var b=a._dijitDirections;b?this._addStops(b):a.getDirectionsDijit().then(v.hitch(this,function(a){this._addStops(a)}))}}))},_addStops:function(a){a.clearDirections();a.removeStops();a.reset();a.addStops(this.stops)},_getTabLayers:function(a){var c=[];b.forEach(this.opLayers._layerInfos,v.hitch(this,function(b){0<b.newSubLayers.length?this._recurseOpLayers(b.newSubLayers,c,a):-1<a.indexOf(b.title)&&(c.push(b.layerObject),"undefined"!==typeof b.layerObject.visible&&
!b.layerObject.visible&&(b.layerObject.setVisibility(!0),b.layerObject.setVisibility(!1)))}));return c},_recurseOpLayers:function(a,c,d){b.forEach(a,v.hitch(this,function(a){0<a.newSubLayers.length?this._recurseOpLayers(a.newSubLayers,c,d):-1<d.indexOf(a.title)&&c.push(a.layerObject)}))},_setupSymbols:function(){var a=c.fromString(this.config.color),b=a.toRgb();b.push(0.2);var d=c.fromString("#000000"),a=c.blendColors(a,d,0.2).toRgb(),d=new J(J.STYLE_SOLID,new c([255,255,255,0.25]),1);this.symPoint=
new O(O.STYLE_CIRCLE,20,d,new c([a[0],a[1],a[2],0.7]));this.symLine=new J(J.STYLE_SOLID,new c([a[0],a[1],a[2],0.7]),3);this.symPoly=new I(I.STYLE_SOLID,this.symLine,new c([a[0],a[1],a[2],0.3]));this.symBuffer=new I(I.STYLE_SOLID,d,new c(b))},onReceiveData:function(a,b,c){null!==c&&c.eventType&&("IncidentLocation"===c.eventType?c.dataValue&&null!==c.dataValue&&(this._clickTab(0),a=c.dataValue,a.attributes[this.shapeFlagFieldName]?(this.incident=a,this._bufferIncident()):this._drawIncident(a)):"WebMapChanged"===
c.eventType&&this._storeIncidents())},_storeIncidents:function(){if(null!==this.incident){var a={location:r.stringify(this.incident.geometry.toJson()),hasBuffer:0<this.lyrBuffer.graphics.length,buffer_dist:this.horizontalSlider.value,unit:this.config.distanceUnits,curTab:this.curTab,extent:r.stringify(this.map.extent.toJson())},a=r.stringify(a);window.localStorage.setItem(this.Incident_Local_Storage_Key,a);console.log("Inclident saved to storage")}},_restoreIncidents:function(){var a=window.localStorage.getItem(this.Incident_Local_Storage_Key);
if(null!==a&&"null"!==a){window.localStorage.setItem(this.Incident_Local_Storage_Key,null);var a=r.parse(a,!0),b=a.buffer_dist,c=r.parse(a.location),c={geometry:B.fromJson(c)};this.sliderValue.set("value",b);this.horizontalSlider.set("value",b);for(b=0;b<this.config.tabs.length;b++)this.config.tabs[b].restore=!0;this._drawIncident(c,!0);this._clickTab(a.curTab,!0);a=B.fromJson(r.parse(a.extent));this.map.setExtent(a,!0)}},_mapResize:function(){var a;if(this.attributeTable){var b=w.byId(this.attributeTable.id);
b&&(a=parseInt(b.style.height.toString().replace("px",""),10))}var b=w.byId("map"),c=parseInt(b.style.bottom.toString().replace("px",""),10);if("opened"===this.state||"active"===this.state){var d=parseInt(this.position.height.toString().replace("px",""),10),e=parseInt(this.position.bottom.toString().replace("px",""),10),d=d+e,e=!1;if(d>a){if(this.mapBottom!==d||this.mapBottom!==c)e=!0,this.mapBottom=d}else if(a>d&&(this.mapBottom!==a||this.mapBottom!==c))e=!0,this.mapBottom=a;e&&(b.style.bottom=this.mapBottom.toString()+
"px",this.map.resize(!1),this.map.reposition())}else b.style.bottom="undefined"!==typeof a?a.toString()+"px":"0px",this.map.resize(!0),this.map.reposition()},_resize:function(a){try{this._onPanelScroll(this.curTab),this.hideContainer&&this._handlePopup(),this._clearMobileSetAsIncidentStyle(),this._removeActionLink(),this._resetInfoWindow(),this._initEditInfo(),this._addActionLink()}catch(b){console.log(b)}},_onPanelScroll:function(a){var b,c,d,e;a=this.footerContentNode.getBoundingClientRect();for(var f=
0;f<this.tabsNode.children.length;f++)if(e=this.tabsNode.children[f],e=e.getBoundingClientRect(),0<=e.left){b=f;d=e.left;break}for(f=0;f<this.tabsNode.children.length;f++)if(e=this.tabsNode.children[f],e=e.getBoundingClientRect(),e.right>a.right){c=f;break}a=this.footerContentNode;c=c<=this.tabsNode.children.length;y.set(a,"right",c?"58px":"24px");y.set(this.panelRight,"display",c?"block":"none");c=34;"TabTheme"===this.appConfig.theme.name&&(c+=54);b=1<=b||d>c;y.set(a,"left",b?"34px":"0px");y.set(this.panelLeft,
"display",b?"block":"none");y.set(this.panelLeft,"width",b?"34px":"0px")},_scrollToTab:function(a){var b=k.position(this.footerContentNode).w;if(k.position(this.tabsNode).w>b){var c=k.getMarginBox(this.tabNodes[a]);this.footerContentNode.scrollLeft=c.l-(b-c.w)/2}this._onPanelScroll(a)},_navLeft:function(a){},_navRight:function(a){},_navTabsLeft:function(a){this._navTabs(!1)},_navTabsRight:function(a){this._navTabs(!0)},_navTabs:function(a){for(var b=this.footerContentNode.getBoundingClientRect(),
c=0;c<this.tabsNode.children.length;c++){var d=this.tabsNode.children[c].getBoundingClientRect();if(a){if(d.right>b.right){this._scrollToTab(c);break}}else if(0<d.right){this._scrollToTab(c);break}}},_storeInitalVisibility:function(){b.forEach(this.config.tabs,v.hitch(this,function(a){b.forEach(a.tabLayers,v.hitch(this,function(a){"undefined"!==typeof a.visible&&(a.id in this.initalLayerVisibility||(this.initalLayerVisibility[a.id]=a.visible),a.setVisibility(!1))}))}))},_resetInitalVisibility:function(){b.forEach(this.config.tabs,
v.hitch(this,function(a){b.forEach(a.tabLayers,v.hitch(this,function(a){"undefined"!==typeof a.visible&&a.id in this.initalLayerVisibility&&(a.setVisibility(this.initalLayerVisibility[a.id]),a.hasOwnProperty("visible")&&(a.visible=this.initalLayerVisibility[a.id]),a.redraw?a.redraw():a.refresh&&a.refresh())}))}));this.initalLayerVisibility=[]},_clearGraphics:function(){b.forEach(this.config.tabs,v.hitch(this,function(a){if("summary"===a.type&&a.tabLayers&&1<a.tabLayers.length)for(var b=1;b<a.tabLayers.length;b++)a.tabLayers.pop()}))},
_resetInfoWindow:function(){this.defaultContent&&this.lyrEdit.infoTemplate.setContent(this.defaultContent);this.defaultPopupSize&&this.map.infoWindow.resize(this.defaultPopupSize.width,"auto");var a=u(".actionList",this.map.infoWindow.domNode);0<a.length&&0<a[0].innerHTML.indexOf(this.nls.actionLabel)&&x.destroy("SA_actionLink");this.map.infoWindow.isShowing&&this.map.infoWindow.hide()},_close:function(){this.widgetManager.closeWidget(this.id)}})});