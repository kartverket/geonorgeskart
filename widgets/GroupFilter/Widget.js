// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://@sbaseurl@/jsapi/jsapi/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"jimu/dijit/FilterParameters":function(){define("dojo/on dojo/Evented dojo/Deferred dojo/promise/all dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/_base/lang dojo/_base/html dojo/_base/array dojo/query dijit/registry jimu/filterUtils jimu/utils ./_SingleFilterParameter ./_filter/ValueProviderFactory".split(" "),function(p,r,h,m,q,g,b,f,a,e,c,d,s,l,n,u,k){return q([g,b,f,r],{baseClass:"jimu-filter-parameters",templateString:'\x3cdiv\x3e\x3ctable style\x3d"width:100%;border-collapse:collapse;"\x3e\x3ctbody data-dojo-attach-point\x3d"tbody"\x3e\x3c/tbody\x3e\x3c/table\x3e\x3c/div\x3e',
_filterUtils:null,_spObj:null,nls:null,partsObj:null,layerInfo:null,OPERATORS:null,url:null,featureLayerId:null,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;this._filterUtils=new l;this.OPERATORS=a.clone(this._filterUtils.OPERATORS);this._spObj={}},destroy:function(){this.clear();this._filterUtils=null;this.inherited(arguments)},getFilterExpr:function(){var a=this._getNewValidPartsObj(this.partsObj,!0);return a?this._getFilterExprByPartsObj(a):null},getValueProviders:function(){for(var a=
[],c=this._getAllInteractiveSinglePartArray(this.partsObj),k=0;k<c.length;k++){var e=c[k].spId;e&&(e=this._getSingleFilterParameterBySpId(e),a.push(e))}return a},_getNewValidPartsObj:function(e,k){e=a.clone(e);for(var d={logicalOperator:e.logicalOperator,parts:[]},b=a.hitch(this,function(a){if(a.spId){var c=this._getSingleFilterParameterBySpId(a.spId);a.valueObj=c.getValueObject();return c.getStatus()}return a.valueObj?1:-1}),l=a.hitch(this,function(a){var c=b(a);0<c&&d.parts.push(a);return c}),f=
a.hitch(this,function(e){var k=[];e.parts=c.filter(e.parts,a.hitch(this,function(a){a=b(a);k.push(a);return 0<a}));1===e.parts.length?d.parts.push(e.parts[0]):2<=e.parts.length&&d.parts.push(e);return Math.min.apply(k,k)}),n=0;n<e.parts.length;n++){var g=e.parts[n];if(g.parts){if(0>f(g)&&k)return null}else if(0>l(g)&&k)return null}return d},_getFilterExprByPartsObj:function(a){this._filterUtils.isHosted=n.isHostedService(this.url);return this._filterUtils.getExprByFilterObj(a)},_getSingleFilterParameterBySpId:function(a){var c=
null;return c=this._spObj[a]},_getCascadeFilterExpr:function(e){for(var k="1\x3d1",d={logicalOperator:this.partsObj.logicalOperator,parts:[]},b=a.clone(this.partsObj),l=0;l<b.parts.length;l++){var f=b.parts[l];f.majorCascadeIndex<e.majorCascadeIndex?d.parts.push(f):f.parts&&f.majorCascadeIndex===e.majorCascadeIndex&&(f=a.clone(f),f.parts=c.filter(f.parts,a.hitch(this,function(a){return a.minorCascadeIndex<e.minorCascadeIndex})),d.parts.push(f))}(d=this._getNewValidPartsObj(d,!1))&&(k=this._getFilterExprByPartsObj(d));
k||(k="1\x3d1");return k},clear:function(){this.featureLayerId=this.url=null;var k=d(".jimu-widget-query-single-parameter",this.tbody);c.forEach(k,a.hitch(this,function(a){s.byNode(a).destroy()}));e.empty(this.tbody);this.layerInfo=this.partsObj=null},build:function(b,y,l,f){var n=new h;this.clear();this.url=b;this.layerInfo=y;this.partsObj=a.clone(l);this.featureLayerId=f;this._setCascadeIndexForPartsObj(this.partsObj);b=this._getAllInteractiveSinglePartArray(this.partsObj);if(0<b.length){var g=
new k({nls:this.nls,url:this.url,layerDefinition:y,featureLayerId:this.featureLayerId});b=c.map(b,a.hitch(this,function(c){var k=e.create("tr",{innerHTML:"\x3ctd\x3e\x3c/td\x3e"},this.tbody),k=d("td",k)[0],b=this._getFieldInfo(c.fieldObj.name,this.layerInfo),b=new u({nls:this.nls,url:this.url,layerDefinition:y,fieldInfo:b,part:c,valueProviderFactory:g});this.own(p(b,"change",a.hitch(this,this._onSingleFilterParameterChanged)));b.placeAt(k);b.startup();c.spId=b.id;return this._spObj[b.id]=b}));c.forEach(b,
a.hitch(this,function(c){c.valueProvider.getCascadeFilterExpr=a.hitch(this,this._getCascadeFilterExpr,c.part)}));b=c.map(b,a.hitch(this,function(a){return a.init()}));m(b).then(a.hitch(this,function(){n.resolve()}),a.hitch(this,function(){n.reject()}))}else n.resolve();return n},_setCascadeIndexForPartsObj:function(a){for(var c=0;c<a.parts.length;c++){var k=a.parts[c];k.majorCascadeIndex="AND"===a.logicalOperator?c:0;k.minorCascadeIndex=0;k.cascadeIndex=k.majorCascadeIndex;if(k.parts)for(var e=0;e<
k.parts.length;e++){var b=k.parts[e];b.majorCascadeIndex=k.majorCascadeIndex;b.minorCascadeIndex="AND"===k.logicalOperator?e:0;b.cascadeIndex=parseFloat(b.majorCascadeIndex+"."+b.minorCascadeIndex)}}},_getFieldInfo:function(a,c){for(var k=c.fields,e=0;e<k.length;e++){var b=k[e];if(a===b.name)return b}return null},_getAllInteractiveSinglePartArray:function(a){for(var c=[],k=0;k<a.parts.length;k++){var e=a.parts[k];if(e.parts)for(var b=0;b<e.parts.length;b++){var d=e.parts[b];d.interactiveObj&&c.push(d)}else e.interactiveObj&&
c.push(e)}return c},_onSingleFilterParameterChanged:function(){this.emit("change",this.getFilterExpr(!1))}})})},"jimu/dijit/_SingleFilterParameter":function(){define("dojo/on dojo/Evented dojo/Deferred dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilterParameter.html dojo/_base/lang".split(" "),function(p,r,h,m,q,g,b,f,a){return m([q,g,b,r],{baseClass:"jimu-single-filter-parameter",templateString:f,valueProvider:null,nls:null,
url:null,layerDefinition:null,fieldInfo:null,part:null,valueProviderFactory:null,postCreate:function(){this.inherited(arguments);this.valueProvider=this.valueProviderFactory.getValueProvider(this.part);this.valueProvider.placeAt(this.valueProviderTd);this.own(p(this.valueProvider,"change",a.hitch(this,this._onValueProviderChanged)));this.valueProvider.bindChangeEvents()},getValueObject:function(){return this.valueProvider.getValueObject()},init:function(){return this.build(this.fieldInfo,this.part)},
build:function(a,c){var b=null;this.fieldInfo=a;this.part=c;if(b=c.interactiveObj)this.promptNode.innerHTML=b.prompt||"",this.hintNode.innerHTML=b.hint||"";b=this.valueProvider.setValueObject(this.part.valueObj);b&&"function"===typeof b.then||(b=new h,b.resolve());return b},disable:function(){this.valueProvider.disable()},enable:function(){this.valueProvider.enable()},isEnabled:function(){return this.valueProvider.isEnabled()},getStatus:function(){return this.valueProvider.getStatus()},_showValidationErrorTip:function(a){!a.validate()&&
a.domNode&&a.focusNode&&(a.focusNode.focus(),a.focusNode.blur())},_onValueProviderChanged:function(){this.emit("change")}})})},"jimu/dijit/_filter/ValueProviderFactory":function(){define("dojo/_base/lang dojo/_base/declare ./SimpleValueProvider ./TwoNumbersValueProvider ./TwoDatesValueProvider ./ListValueProvider jimu/LayerInfos/LayerInfos".split(" "),function(p,r,h,m,q,g,b){var f={stringOperatorIs:{value:{normal:"SIMPLE_VALUE_PROVIDER",codedValue:"LIST_VALUE_PROVIDER"},unique:{normal:"LIST_VALUE_PROVIDER"}},
stringOperatorIsNot:{value:{normal:"SIMPLE_VALUE_PROVIDER"},unique:{normal:"LIST_VALUE_PROVIDER"}},stringOperatorStartsWith:{value:{normal:"SIMPLE_VALUE_PROVIDER"}},stringOperatorEndsWith:{value:{normal:"SIMPLE_VALUE_PROVIDER"}},stringOperatorContains:{value:{normal:"SIMPLE_VALUE_PROVIDER"}},stringOperatorDoesNotContain:{value:{normal:"SIMPLE_VALUE_PROVIDER"}},stringOperatorIsBlank:null,stringOperatorIsNotBlank:null,numberOperatorIs:{value:{normal:"SIMPLE_VALUE_PROVIDER",codedValue:"LIST_VALUE_PROVIDER"},
unique:{normal:"LIST_VALUE_PROVIDER"}},numberOperatorIsNot:{value:{normal:"SIMPLE_VALUE_PROVIDER"},unique:{normal:"LIST_VALUE_PROVIDER"}},numberOperatorIsAtLeast:{value:{normal:"SIMPLE_VALUE_PROVIDER"},unique:{normal:"LIST_VALUE_PROVIDER"}},numberOperatorIsLessThan:{value:{normal:"SIMPLE_VALUE_PROVIDER"},unique:{normal:"LIST_VALUE_PROVIDER"}},numberOperatorIsAtMost:{value:{normal:"SIMPLE_VALUE_PROVIDER"},unique:{normal:"LIST_VALUE_PROVIDER"}},numberOperatorIsGreaterThan:{value:{normal:"SIMPLE_VALUE_PROVIDER"},
unique:{normal:"LIST_VALUE_PROVIDER"}},numberOperatorIsBetween:{value:{normal:"TWO_NUMBERS_VALUE_PROVIDER"}},numberOperatorIsNotBetween:{value:{normal:"TWO_NUMBERS_VALUE_PROVIDER"}},numberOperatorIsBlank:null,numberOperatorIsNotBlank:null,dateOperatorIsOn:{value:{normal:"SIMPLE_VALUE_PROVIDER"}},dateOperatorIsNotOn:{value:{normal:"SIMPLE_VALUE_PROVIDER"}},dateOperatorIsBefore:{value:{normal:"SIMPLE_VALUE_PROVIDER"}},dateOperatorIsAfter:{value:{normal:"SIMPLE_VALUE_PROVIDER"}},dateOperatorIsBetween:{value:{normal:"TWO_DATES_VALUE_PROVIDER"}},
dateOperatorIsNotBetween:{value:{normal:"TWO_DATES_VALUE_PROVIDER"}},dateOperatorIsBlank:null,dateOperatorIsNotBlank:null};return r([],{nls:null,url:null,layerDefinition:null,layerInfo:null,featureLayerId:null,constructor:function(a){p.mixin(this,a);a=b.getInstanceSync();this.featureLayerId&&(this.layerInfo=a.getLayerOrTableInfoById(this.featureLayerId))},getValueProvider:function(a){var e=null,c=a.operator,b=f[c];if(b){var s=a.valueObj.type,l=this._getFieldInfo(this.layerDefinition,a.fieldObj.name),
n=this._getCodedValues(l),s=b[s],b=s.normal;n&&s.codedValue&&(b=s.codedValue);a={nls:this.nls,url:this.url,layerDefinition:this.layerDefinition,partObj:a,fieldInfo:l,codedValues:n,layerInfo:this.layerInfo};"SIMPLE_VALUE_PROVIDER"===b?e=new h(a):"TWO_NUMBERS_VALUE_PROVIDER"===b?e=new m(a):"TWO_DATES_VALUE_PROVIDER"===b?e=new q(a):"LIST_VALUE_PROVIDER"===b&&(a.showNullValues="stringOperatorIs"===c||"stringOperatorIsNot"===c||"numberOperatorIs"===c||"numberOperatorIsNot"===c?!0:!1,e=new g(a))}else console.error("Invalid operator: "+
c);return e},_getFieldInfo:function(a,b){for(var c=a.fields,d=0;d<c.length;d++){var f=c[d];if(b===f.name)return f}return null},_getCodedValues:function(a){var b=null;if((a=a.domain)&&"codedValue"===a.type&&a.codedValues&&0<a.codedValues.length)b=a.codedValues;return b}})})},"jimu/dijit/_filter/SimpleValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/NumberTextBox".split(" "),function(p,r,h,m,q,g){return r([h],
{templateString:"\x3cdiv\x3e\x3c/div\x3e",_dijit:null,postCreate:function(){this.inherited(arguments);p.addClass(this.domNode,"jimu-filter-simple-value-provider");this._dijit="string"===this.shortType?new m({required:!1,trim:!0}):"number"===this.shortType?new g({required:!1,intermediateChanges:!0,constraints:{pattern:"#####0.##########"}}):new q({required:!1,trim:!0,value:new Date});p.setStyle(this._dijit.domNode,"width","100%");this._dijit.placeAt(this.domNode)},getDijits:function(){return[this._dijit]},
setValueObject:function(b){"date"===this.shortType?this._dijit.set("value",new Date(b.value)):this._dijit.set("value",b.value)},getValueObject:function(){if(this.isValidValue()){var b=this._dijit.get("value");"date"===this.shortType?b=b.toDateString():"number"===this.shortType&&(b=parseFloat(b));return{isValid:!0,type:this.partObj.valueObj.type,value:b}}return null}})})},"jimu/dijit/_filter/ValueProvider":function(){define("dojo/on dojo/Evented dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin jimu/utils".split(" "),
function(p,r,h,m,q,g,b,f,a){return g([b,f,r],{baseClass:"jimu-filter-value-provider",codedValues:null,fieldName:null,shortType:null,_enabled:!1,cascade:!1,nls:null,url:null,layerDefinition:null,fieldInfo:null,partObj:null,layerInfo:null,postMixInProperties:function(){this.inherited(arguments);this.shortType=this.partObj.fieldObj.shortType;this.fieldName=this.partObj.fieldObj.name;this.cascade=this.partObj.interactiveObj&&this.partObj.interactiveObj.cascade},getDijits:function(){return[]},bindChangeEvents:function(){var a=
this.getDijits();q.forEach(a,h.hitch(this,function(a){a.declaredClass&&0===a.declaredClass.indexOf("dijit.")&&m.addClass(a.domNode,a.declaredClass.replace(/\./g,"-"));this.own(p(a,"change",h.hitch(this,this._onChanged)))}))},_onChanged:function(){this.emit("change")},tryLocaleNumber:function(b){var c=a.localizeNumber(b);if(null===c||void 0===c)c=b;return c},getPartObject:function(){var a=this.getValueObject();if(!a)return null;var b=h.clone(this.partObj);b.valueObj=a;return b},setValueObject:function(){},
getValueObject:function(){},getStatus:function(){var a=1,b=this.getDijits();0<b.length&&(a=q.map(b,h.hitch(this,function(a){return this.getStatusForDijit(a)})),a=Math.min.apply(a,a));return a},getStatusForDijit:function(a){return a.validate()?a.get("DisplayedValue")?1:0:-1},isInvalidValue:function(){return 0>this.getStatus()},isEmptyValue:function(){return 0===this.getStatus()},isValidValue:function(){return 0<this.getStatus()},getFilterExpr:function(){var a="1\x3d1",a=this.getLayerFilterExpr();if(this.cascade)var b=
this.getCascadeFilterExpr(),a="("+a+") AND ("+b+")";return a},getLayerFilterExpr:function(){var a="1\x3d1";this.layerInfo&&(a=this.layerInfo.getFilter());a||(a="1\x3d1");return a},getCascadeFilterExpr:function(){return"1\x3d1"},disable:function(){this._enabled=!1},enable:function(){this._enabled=!0},isEnabled:function(){return this._enabled}})})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(p,r,h){return p("dijit.form.DateTextBox",h,
{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:r,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),function(p,r,h,m,q,g,b,f,a,e,c,d,s,l,n,u,k){var w=m("dijit.Calendar",
[s,l,n],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){f.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new w._MonthDropDownButton({id:this.id+"_mddb",tabIndex:-1,onMonthSelect:e.hitch(this,"_onMonthSelect"),lang:this.lang,
dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(c(this.domNode,"keydown",e.hitch(this,"_onKeyDown")),c(this.dateRowsNode,"mouseover",e.hitch(this,"_onDayMouseOver")),c(this.dateRowsNode,"mouseout",e.hitch(this,"_onDayMouseOut")),c(this.dateRowsNode,"mousedown",e.hitch(this,"_onDayMouseDown")),c(this.dateRowsNode,"mouseup",e.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var b=new this.dateClassObj(this.currentFocus);b.setDate(1);
b.setMonth(a);a=this.dateModule.getDaysInMonth(b);var k=this.currentFocus.getDate();b.setDate(Math.min(k,a));this._setCurrentFocusAttr(b)},_onDayMouseOver:function(a){if((a=g.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!g.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode))g.add(a,"dijitCalendarHoveredDate"),this._currentNode=a},_onDayMouseOut:function(a){this._currentNode&&!(a.relatedTarget&&a.relatedTarget.parentNode==
this._currentNode)&&(a="dijitCalendarHoveredDate",g.contains(this._currentNode,"dijitCalendarActiveDate")&&(a+=" dijitCalendarActiveDate"),g.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){if((a=a.target.parentNode)&&a.dijitDateValue&&!g.contains(a,"dijitCalendarDisabledDate"))g.add(a,"dijitCalendarActiveDate"),this._currentNode=a},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&g.remove(a,"dijitCalendarActiveDate")},handleKey:function(b){var k=
-1,c,e=this.currentFocus;switch(b.keyCode){case a.RIGHT_ARROW:k=1;case a.LEFT_ARROW:c="day";this.isLeftToRight()||(k*=-1);break;case a.DOWN_ARROW:k=1;case a.UP_ARROW:c="week";break;case a.PAGE_DOWN:k=1;case a.PAGE_UP:c=b.ctrlKey||b.altKey?"year":"month";break;case a.END:e=this.dateModule.add(e,"month",1),c="day";case a.HOME:e=new this.dateClassObj(e);e.setDate(1);break;default:return!0}c&&(e=this.dateModule.add(e,c,k));this._setCurrentFocusAttr(e);return!1},_onKeyDown:function(a){this.handleKey(a)||
(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},getClassForDate:function(){}});w._MonthDropDownButton=m("dijit.Calendar._MonthDropDownButton",k,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new w._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.dropDown.set("months",
b);this.containerNode.innerHTML=(6==d("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});w._MonthDropDown=m("dijit.Calendar._MonthDropDown",[l,u,n],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML=
"";p.forEach(a,function(a,k){b.create("div",{className:"dijitCalendarMonthLabel",month:k,innerHTML:a},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(q.get(a.target,"month"))},onChange:function(){}});return w})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(p,r,h,m,q,g,b,f,a,e,c,d,s,l,n){var u=r("dijit.CalendarLite",[s,l],{templateString:n,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",dayOffset:-1,currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=
new this.dateClassObj(a);b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,b){"string"==typeof a&&(a=g.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){a&&
(a=new this.dateClassObj(a),a.setHours(1,0,0,0));return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),b=a.getDay(),c=this.dateModule.getDaysInMonth(a),e=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),f=new this.dateClassObj,l=0<=this.dayOffset?this.dayOffset:h.getFirstDayOfWeek(this.lang);l>b&&
(l-=7);if(!this.summary){var d=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",d[a.getMonth()])}this._date2cell={};p.forEach(this.dateCells,function(d,n){var g=n+l,h=new this.dateClassObj(a),m="dijitCalendar",s=0;g<b?(g=e-b+g+1,s=-1,m+="Previous"):g>=b+c?(g=g-b-c+1,s=1,m+="Next"):(g=g-b+1,m+="Current");s&&(h=this.dateModule.add(h,"month",s));h.setDate(g);this.dateModule.compare(h,f,"date")||(m="dijitCalendarCurrentDate "+m);this.isDisabledDate(h,
this.lang)?(m="dijitCalendarDisabledDate "+m,d.setAttribute("aria-disabled","true")):(m="dijitCalendarEnabledDate "+m,d.removeAttribute("aria-disabled"),d.setAttribute("aria-selected","false"));(s=this.getClassForDate(h,this.lang))&&(m=s+" "+m);d.className=m+"Month dijitCalendarDateTemplate";m=h.valueOf();this._date2cell[m]=d;d.dijitDateValue=m;this._setText(this.dateLabels[n],h.getDateLocalized?h.getDateLocalized(this.lang):h.getDate())},this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);
a.setDate(1);this.monthWidget.set("month",a);var b=a.getFullYear()-1,c=new this.dateClassObj;p.forEach(["previous","current","next"],function(a){c.setFullYear(b++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(c,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(b){this.dateModule=b.datePackage?a.getObject(b.datePackage,!1):m;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=b.datePackage?
a.getObject(b.datePackage+".locale",!1):q},_createMonthWidget:function(){return u._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var a=this.dowTemplateString,c=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),e=0<=this.dayOffset?this.dayOffset:h.getFirstDayOfWeek(this.lang);this.dayCellsHtml=d.substitute([a,a,a,a,a,a,a].join(""),{d:""},function(){return c[e++%7]});a=d.substitute(this.weekTemplateString,
{d:this.dateTemplateString});this.dateRowsHtml=[a,a,a,a,a,a].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);b.setSelectable(this.domNode,!1);a=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",a,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var b=a.hitch(this,function(b,c,d){this[b].dojoClick=!0;return e(this[b],"click",a.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,
c,d))}))});this.own(b("incrementMonth","month",1),b("decrementMonth","month",-1),b("nextYearLabelNode","year",1),b("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,b){var e=this.currentFocus,d=this._getNodeByDate(e);a=this._patchDate(a);this._set("currentFocus",a);if(!this._date2cell||0!=this.dateModule.difference(e,a,"month"))this._populateGrid(),this._populateControls(),this._markSelectedDates([this.value]);e=this._getNodeByDate(a);e.setAttribute("tabIndex",this.tabIndex);(this.focused||
b)&&e.focus();d&&d!=e&&(c("webkit")?d.setAttribute("tabIndex","-1"):d.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue;a=a.parentNode);a&&!f.contains(a,"dijitCalendarDisabledDate")&&this.set("value",a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(b){function c(a,
b){f.toggle(b,"dijitCalendarSelectedDate",a);b.setAttribute("aria-selected",a?"true":"false")}p.forEach(this._selectedCells||[],a.partial(c,!1));this._selectedCells=p.filter(p.map(b,this._getNodeByDate,this),function(a){return a});p.forEach(this._selectedCells,a.partial(c,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});u._MonthWidget=r("dijit.CalendarLite._MonthWidget",s,{_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",
this.lang,a),e=6==c("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+p.map(b,function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=e+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});return u})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(p,r,h,m,q,g,b,f){new Date("X");return m("dijit.form._DateTimeTextBox",[g,b],{templateString:f,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:r.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(a,b){var c=this._isInvalidDate(a),d=this._isInvalidDate(b);if(c||d)return c&&d?0:!c?1:-1;var c=this.format(a,this._unboundedConstraints),d=this.format(b,this._unboundedConstraints),
f=this.parse(c,this._unboundedConstraints),l=this.parse(d,this._unboundedConstraints);return c==d?0:p.compare(f,l,this._selector)},autoWidth:!0,format:function(a,b){return!a?"":this.dateLocaleModule.format(a,b)},parse:function(a,b){return this.dateLocaleModule.parse(a,b)||(this._isEmpty(a)?null:void 0)},serialize:function(a,b){a.toGregorian&&(a=a.toGregorian());return h.toISOString(a,b)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(a){a=
a||{};this.dateModule=a.datePackage?q.getObject(a.datePackage,!1):p;this.dateClassObj=this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=a.datePackage?q.getObject(a.datePackage+".locale",!1):r;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||
(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(a){a.selector=this._selector;a.fullYear=!0;var b=h.fromISOString;"string"==typeof a.min&&(a.min=b(a.min),this.dateClassObj instanceof Date||(a.min=new this.dateClassObj(a.min)));"string"==typeof a.max&&(a.max=b(a.max),this.dateClassObj instanceof Date||(a.max=new this.dateClassObj(a.max)));this.inherited(arguments);this._unboundedConstraints=q.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(a){return!a||
isNaN(a)||"object"!=typeof a||a.toString()==this._invalidDate},_setValueAttr:function(a,b,c){void 0!==a&&("string"==typeof a&&(a=h.fromISOString(a)),this._isInvalidDate(a)&&(a=null),a instanceof Date&&!(this.dateClassObj instanceof Date)&&(a=new this.dateClassObj(a)));this.inherited(arguments,[a,b,c]);this.value instanceof Date&&(this.filterString="");!1!==b&&this.dropDown&&this.dropDown.set("value",a,!1)},_set:function(a,b){if("value"==a){b instanceof Date&&!(this.dateClassObj instanceof Date)&&
(b=new this.dateClassObj(b));var c=this._get("value");if(c instanceof this.dateClassObj&&0==this.compare(b,c))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(a){this._isInvalidDate(a)&&(a=new this.dateClassObj);this._set("dropDownDefaultValue",a)},openDropDown:function(a){this.dropDown&&this.dropDown.destroy();var b=q.isString(this.popupClass)?q.getObject(this.popupClass,!1):this.popupClass,c=this,d=this.get("value");this.dropDown=new b({onChange:function(a){c.set("value",
a,!0)},id:this.id+"_popup",dir:c.dir,lang:c.lang,value:d,textDir:c.textDir,currentFocus:!this._isInvalidDate(d)?d:this.dropDownDefaultValue,constraints:c.constraints,filterString:c.filterString,datePackage:c.datePackage,isDisabledDate:function(a){return!c.rangeCheck(a,c.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(a,b){this._setValueAttr(this.parse(a,this.constraints),b,a)}})})},"jimu/dijit/_filter/TwoNumbersValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./TwoNumbersValueProvider.html dijit/form/NumberTextBox".split(" "),
function(p,r,h,m,q,g){return r([h,m,q],{templateString:g,postCreate:function(){this.inherited(arguments);p.addClass(this.domNode,"jimu-two-numbers-filter-value-provider")},_onRangeNumberBlur:function(){if(this._dijit1.validate()&&this._dijit2.validate()){var b=parseFloat(this._dijit1.get("value")),f=parseFloat(this._dijit2.get("value"));b>f&&(this._dijit1.set("value",f),this._dijit2.set("value",b))}},getDijits:function(){return[this._dijit1,this._dijit2]},setValueObject:function(b){this._dijit1.set("value",
b.value1);this._dijit2.set("value",b.value2)},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:this.partObj.valueObj.type,value1:parseFloat(this._dijit1.get("value")),value2:parseFloat(this._dijit2.get("value"))}:null}})})},"jimu/dijit/_filter/TwoDatesValueProvider":function(){define("dojo/_base/html dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./TwoDatesValueProvider.html dijit/form/DateTextBox".split(" "),function(p,r,h,m,
q,g){return r([h,m,q],{templateString:g,postCreate:function(){this.inherited(arguments);p.addClass(this.domNode,"jimu-two-dates-filter-value-provider")},_onRangeDateBlur:function(){if(this._dijit1.validate()&&this._dijit2.validate()){var b=this._dijit1.get("value"),f=b.getTime(),a=this._dijit2.get("value"),e=a.getTime();f>e&&(this._dijit1.set("value",a),this._dijit2.set("value",b))}},getDijits:function(){return[this._dijit1,this._dijit2]},setValueObject:function(b){this._dijit1.set("value",new Date(b.value1));
this._dijit2.set("value",new Date(b.value2))},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:this.partObj.valueObj.type,value1:this._dijit1.get("value").toDateString(),value2:this._dijit2.get("value").toDateString()}:null}})})},"jimu/dijit/_filter/ListValueProvider":function(){define("dojo/aspect dojo/Deferred dojo/_base/lang dojo/_base/html dojo/_base/array dojo/_base/declare ./ValueProvider dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./ListValueProvider.html dojo/store/Memory jimu/utils dijit/form/FilteringSelect".split(" "),
function(p,r,h,m,q,g,b,f,a,e,c,d){return g([b,f,a],{templateString:e,codedValues:null,showNullValues:!1,postCreate:function(){this.inherited(arguments);m.addClass(this.domNode,"jimu-filter-list-value-provider");this._uniqueValueCache={};var a=new c({idProperty:"id",data:[]});this.valuesSelect.set("store",a);!this.codedValues&&"function"===typeof this.valuesSelect._onDropDownMouseDown&&this.own(p.before(this.valuesSelect,"_onDropDownMouseDown",h.hitch(this,this._onBeforeDropDownMouseDown)))},_onBeforeDropDownMouseDown:function(){this._tryUpdatingUniqueValues(void 0,
!0);return arguments},getDijits:function(){return[this.valuesSelect]},setValueObject:function(a){return this.codedValues?this._setValueForCodedValues(a.value):this._tryUpdatingUniqueValues(a.value,!1)},getValueObject:function(){return this.isValidValue()?{isValid:!0,type:"unique",value:this.valuesSelect.get("item").value}:null},_setValueForCodedValues:function(a){var b=null,c=-1,b=null;this.codedValues&&(b=q.map(this.codedValues,h.hitch(this,function(b,d){var e={id:d,value:b.code,label:b.name};e.value===
a&&(c=d);return e})),this.valuesSelect.store.setData(b),0<=c&&(b=this.valuesSelect.store.get(c))&&this.valuesSelect.set("item",b))},_uniqueValueLoadingDef:null,_uniqueValueLoadingExpr:"",_uniqueValueCache:null,_tryUpdatingUniqueValues:function(a,b){var c=new r;if(this.valuesSelect._opened)c.resolve();else{var d=this.getFilterExpr();d!==this._uniqueValueLoadingExpr?(this.valuesSelect.readOnly=!0,this._uniqueValueLoadingDef&&(this._uniqueValueLoadingDef.reject(),this._uniqueValueLoadingDef=null),this._uniqueValueLoadingExpr=
d,this._uniqueValueLoadingDef=this._getUniqueValues(d),this._uniqueValueLoadingDef.then(h.hitch(this,function(d){this.domNode&&(this._uniqueValueLoadingDef=null,this.valuesSelect.readOnly=!1,this._setValueForUniqueValues(a,d),this._hideLoadingIcon(),b&&this.valuesSelect.toggleDropDown(),c.resolve())}),h.hitch(this,function(a){this.domNode&&(this._uniqueValueLoadingDef=null,this.valuesSelect.readOnly=!1,this._hideLoadingIcon(),c.reject(a))}))):c.resolve()}return c},_setValueForUniqueValues:function(a,
b){this.showNullValues||(b=q.filter(b,h.hitch(this,function(a){return"\x3cNull\x3e"!==a&&null!==a})));if(void 0===a){var c=this.getValueObject();c&&(a=c.value)}var d=-1,c=null,e=q.map(b,h.hitch(this,function(b,c){var e=b;"number"===this.shortType&&"\x3cNull\x3e"!==b&&(b=parseFloat(b),e=this.tryLocaleNumber(b));e={id:c,value:b,label:e};b===a&&(d=c);return e}));this.valuesSelect.store.setData(e);0<=d&&(c=this.valuesSelect.store.get(d));this.valuesSelect.set("item",c)},_showLoadingIcon:function(){m.addClass(this.valuesSelect.domNode,
"loading")},_hideLoadingIcon:function(){m.removeClass(this.valuesSelect.domNode,"loading")},_getUniqueValues:function(a){var b=new r;this._uniqueValueCache[a]?b.resolve(this._uniqueValueCache[a]):(this._showLoadingIcon(),d.getUniqueValues(this.url,this.fieldName,a).then(h.hitch(this,function(c){this.domNode&&(this._uniqueValueCache[a]=c,b.resolve(c),this._hideLoadingIcon())}),h.hitch(this,function(a){this.domNode&&(b.reject(a),this._hideLoadingIcon())})));return b}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare",
"dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(p,r,h,m,q){return p("dijit.form.FilteringSelect",[m,q],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(g,b,f,a){b&&b[this.searchAttr]!==this._lastQuery||!b&&g.length&&this.store.getIdentity(g[0])!=this._lastQuery||
(g.length?this.set("item",g[0],a):this.set("value","",a||void 0===a&&!this.focused,this.textbox.value,null))},_openResultList:function(g,b,f){b[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(g,b,f,a){this._onChangeActive||(b=null);if(void 0===a){if(null===g||""===g)if(g="",!r.isString(f)){this._setDisplayedValueAttr(f||"",b);
return}var e=this;this._lastQuery=g;h(this.store.get(g),function(a){e._callbackSetLabel(a?[a]:[],void 0,void 0,b)})}else this.valueNode.value=g,this.inherited(arguments,[g,b,f,a])},_setItemAttr:function(g,b,f){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(g){return g.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(g,b){null==g&&(g="");if(!this._created){if(!("displayedValue"in this.params))return;b=!1}if(this.store){this.closeDropDown();
var f=r.clone(this.query),a=this._getDisplayQueryString(g),e;this.store._oldAPI?e=a:(e=this._patternToRegExp(a),e.toString=function(){return a});this._lastQuery=f[this.searchAttr]=e;this._lastDisplayedValue=this.textbox.value=g;this._set("displayedValue",g);var c=this,d={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};r.mixin(d,this.fetchProperties);this._fetchHandle=this.store.query(f,d);h(this._fetchHandle,function(a){c._fetchHandle=null;c._callbackSetLabel(a||[],f,d,b)},function(a){c._fetchHandle=
null;c._cancelingQuery||console.error("dijit.form.FilteringSelect: "+a.toString())})}},undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"widgets/GroupFilter/SaveJSON":function(){define("dojo/Evented dojo/_base/declare dojo/Deferred dojo/_base/html dojo/has jimu/utils".split(" "),function(p,r,h,m,q,g){return r([p],{declaredClass:"saveJSON",config:null,constructor:function(b){r.safeMixin(this,b)},_getDownloadUrl:function(b){return window.Blob&&window.URL&&window.URL.createObjectURL?
(b=new Blob([b],{type:"text/json"}),URL.createObjectURL(b)):"data:attachment/json;charset\x3dutf-8,"+encodeURIComponent(b)},exportsJson:function(b,f){var a=JSON.stringify(f),e=new h;try{if(q("ie")&&10>q("ie")){var c=window.top.open("about:blank","_blank");c.document.write("sep\x3d,\r\n"+a);c.document.close();c.document.execCommand("SaveAs",!0,b);c.close();this.savePrompt()}else if(10===q("ie")||this._isIE11()||this._isEdge()){var d=new Blob([a],{type:"text/json"});navigator.msSaveBlob(d,b);this.savePrompt()}else{var g=
m.create("a",{href:this._getDownloadUrl(a),target:"_blank",download:b},document.body);if(q("safari")){var l=document.createEvent("MouseEvents");l.initEvent("click",!0,!0);g.dispatchEvent(l)}else g.click();this.savePrompt();m.destroy(g)}e.resolve()}catch(n){e.reject(n)}return e},_isIE11:function(){return 11===g.has("ie")},_isEdge:function(){return g.has("edge")},savePrompt:function(){this.emit("complete",{})}})})},"widgets/GroupFilter/ReadJSON":function(){define("dojo/Evented dojo/_base/declare dojo/has dojo/_base/lang jimu/utils jimu/dijit/Message".split(" "),
function(p,r,h,m,q,g){return r([p],{declaredClass:"readJSON",config:null,jsonFile:null,constructor:function(b){r.safeMixin(this,b)},checkFileReader:function(){this.supportHTML5()?(console.log("HTML 5 loader"),this._processFiles(this.jsonFile)):!this.supportHTML5()&&!h("safari")&&this.isEnabledFlash()?q.file.loadFileAPI().then(m.hitch(this,function(){console.log("loading FileAPI")})):console.log("no loader")},_processFiles:function(b){0<b.length&&(b=b[0],-1!==b.name.indexOf(".json")?b&&this.handleJson(b):
new g({message:"Not a json file"}))},handleJson:function(b){if(this.supportHTML5()){var f=new FileReader;f.onload=function(a){return function(){-1<f.result.indexOf("groups")?a.completePrompt(f.result):(new g({message:"json file is Invalid"}),a.errorPrompt("error"))}}(this);f.readAsText(b)}else window.FileAPI.readAsText(b,m.hitch(this,function(a){}))},supportHTML5:function(){return window.File&&window.FileReader&&window.FileList&&window.Blob?!0:!1},supportFileAPI:function(){return h("safari")&&6>h("safari")?
!1:window.FileAPI&&window.FileAPI.readAsDataURL?!0:!1},isEnabledFlash:function(){var b=null;if(document.all)try{b=new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(f){b=null}else navigator.plugins&&0<navigator.plugins.length&&(b=navigator.plugins["Shockwave Flash"]);return!!b},completePrompt:function(b){this.emit("complete",{UserSettings:b})},errorPrompt:function(){this.emit("error",{UserSettings:"error"})}})})},"widgets/GroupFilter/LayersHandler":function(){define("dojo/Evented dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/promise/all esri/request".split(" "),
function(p,r,h,m,q,g,b){return r([p],{declaredClass:"LayersHandler",layers:null,layerStore:[],fieldName:null,childList:null,validFieldTypes:"esriFieldTypeInteger esriFieldTypeSmallInteger esriFieldTypeDouble esriFieldTypeSingle esriFieldTypeString esriFieldTypeDate esriFieldTypeGeometry esriFieldTypeOID esriFieldTypeBlob esriFieldTypeGlobalID esriFieldTypeRaster esriFieldTypeGUID esriFieldTypeXML".split(" "),layersOnly:!1,constructor:function(b){r.safeMixin(this,b)},getAllMapLayers:function(){var b=
[],a=new q,e;this.layerStore=[];m.forEach(this.layers,h.hitch(this,function(a){a.featureCollection||("undefined"!==typeof a.originOperLayer&&a.originOperLayer.layerType&&("ArcGISFeatureLayer"===a.originOperLayer.layerType||"ArcGISImageServiceLayer"===a.originOperLayer.layerType)?"undefined"===typeof a.originOperLayer.featureCollection&&(e={label:a.title,id:a.id,url:a.url,fieldName:this.fieldName,type:"Feature Layer",checked:!1,children:[],layer:a.layerObject},b.push(this._getLayerInfo(e)),this.layerStore.push(e)):
0<a.newSubLayers.length?(this.childList=[],"undefined"!==typeof a.originOperLayer.layerType&&"ArcGISTiledMapServiceLayer"===a.originOperLayer.layerType||(m.forEach(a.layerObject.layerInfos,h.hitch(this,function(d){d={label:d.name,id:a.id+"."+d.id,url:a.originOperLayer.url+"/"+d.id,type:"Layer",fieldName:this.fieldName,checked:!1,children:[],layer:a.layerObject};this.childList.push(d);b.push(this._getLayerInfo(d))})),e={label:a.title,id:a.id,url:a.originOperLayer.url,type:"Service",checked:!1,children:this.childList,
layer:a.layerObject},this.layerStore.push(e))):"ArcGISMapServiceLayer"===a.originOperLayer.layerType&&(this.childList=[],m.forEach(a.layerObject.layerInfos,h.hitch(this,function(d){d={label:d.name,id:a.id+"."+d.id,url:a.originOperLayer.url+"/"+d.id,type:"Layer",fieldName:this.fieldName,checked:!1,children:[],layer:a.layerObject};this.childList.push(d);b.push(this._getLayerInfo(d))})),e={label:a.title,id:a.id,url:a.originOperLayer.url,type:"MapService",checked:!1,children:this.childList,layer:a.layerObject},
this.layerStore.push(e)))}));g(b).then(h.hitch(this,function(){var b=this._controlComplete();this.emit("complete",b);a.resolve(b)}),h.hitch(this,function(){a.resolve(null)}));return a.promise},_getLayerInfo:function(f){var a=new q;f.url?0===f.url.length?a.resolve():b({url:f.url,content:{f:"json"},callbackParamName:"callback"}).then(h.hitch(this,function(b){if(b.hasOwnProperty("fields")&&!1===this.layersOnly){var c=m.map(b.fields,h.hitch(this,function(a){return{label:a.alias,id:f.id+"."+a.name,name:a.name,
type:"Field",fieldType:a.type,checked:!1}})),c=m.filter(c,h.hitch(this,function(a){return 0<=m.indexOf(this.validFieldTypes,a.fieldType)}));f.children=c}f.geometryType=b.geometryType;f.visible=!0;this.geometryTypes&&!m.some(this.geometryTypes,function(a){if(a===f.geometryType)return!0})&&(f.visible=!1);a.resolve(b)}),function(){a.resolve(null)}):a.resolve();return a.promise},_controlComplete:function(){m.forEach(this.layerStore,function(b){if(b.children&&0<b.children.length){var a=m.filter(b.children,
function(a){return a.hasOwnProperty("visible")?a.visible:!0});b.children=a;0===b.children.length&&(b.visible=!1)}});return this.store={data:{identifier:"id",label:"label",items:m.filter(this.layerStore,function(b){return b.hasOwnProperty("visible")?b.visible:!0})}}}})})},"widgets/GroupFilter/_build-generate_module":function(){define(["dojo/text!./Widget.html","dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:jimu/dijit/templates/_SingleFilterParameter.html":'\x3cdiv\x3e\r\n  \x3ctable style\x3d"width:100%;"\x3e\r\n    \x3ctbody\x3e\r\n      \x3ctr class\x3d"first-tr"\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"prompt" data-dojo-attach-point\x3d"promptNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"second-tr"\x3e\r\n        \x3ctd data-dojo-attach-point\x3d"valueProviderTd"\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n      \x3ctr class\x3d"third-tr"\x3e\r\n        \x3ctd\x3e\r\n          \x3cdiv class\x3d"hint" data-dojo-attach-point\x3d"hintNode"\x3e\x3c/div\x3e\r\n        \x3c/td\x3e\r\n      \x3c/tr\x3e\r\n    \x3c/tbody\x3e\r\n  \x3c/table\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Calendar.html":'\x3cdiv class\x3d"dijitCalendarContainer dijitInline" role\x3d"presentation" aria-labelledby\x3d"${id}_mddb ${id}_year"\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarMonthContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarDecrementArrow\' data-dojo-attach-point\x3d"decrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarIncrementArrow\' data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode" class\x3d"dijitInline"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"grid" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\x3cthead\x3e\r\n\t\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t\t${!dayCellsHtml}\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/thead\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t\t${!dateRowsHtml}\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarYearContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/_filter/TwoNumbersValueProvider.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":false,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit2" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":false,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/TwoDatesValueProvider.html":'\x3cdiv\x3e\r\n\t\x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"width:100%;border-collapse:collapse;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit1" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:false,trim:true\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"_dijit2" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:false,trim:true\' style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/_filter/ListValueProvider.html":'\x3cdiv\x3e\r\n  \x3cdiv data-dojo-attach-point\x3d"valuesSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"label",required:false,intermediateChanges:true\' style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',"url:widgets/GroupFilter/Widget.html":'\x3cdiv\x3e\r\n\t\x3cdiv class\x3d"groupContainer" data-dojo-attach-point\x3d"widgetIntro"\x3e\r\n\t\t\x3cdiv class\x3d"group-picker"\x3e\r\n\t\t\t\x3ctable width\x3d"100%" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"groupHeader"\x3e${nls.labels.selectGroup}\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"saveTD" data-dojo-attach-point\x3d"optionsIcon" id\x3d"saveTD" data-dojo-attach-event\x3d"click:toggleSaveFilter"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2"\x3e\x3cdiv data-dojo-attach-point\x3d"groupPicker" id\x3d"groupPicker"\x3e\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd colspan\x3d"2" id\x3d"groupDesc" data-dojo-attach-point\x3d"groupDesc"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"container" data-dojo-attach-point\x3d"filterBlock" id\x3d"filterBlock"\x3e\r\n\t\t\x3cdiv class\x3d"filter-block" data-dojo-attach-point\x3d"filterBlockInner" id\x3d"filterBlockInner"\x3e\r\n\t\t\t\x3ctable id\x3d"tblPredicates" class\x3d"tableFormat" border\x3d0 cellspacing\x3d"0" cellpadding\x3d"0"\x3e\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\r\n\t\x3cdiv class\x3d"saveContainer" data-dojo-attach-point\x3d"saveBlock" id\x3d"saveBlock"\x3e\r\n\t\t\x3cdiv class\x3d"save-block" data-dojo-attach-point\x3d"saveBlockInner" id\x3d"saveBlockInner"\x3e\r\n\t\t\t\x3ctable id\x3d"tblSave" class\x3d"tableFormat" border\x3d0 cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\t\t\x3ctr class\x3d"rowHeader"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdFirstLabel"\x3e${nls.labels.saveHeading}\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"close-save" data-dojo-attach-event\x3d"click:toggleSaveFilter"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdData"\x3e\x3cdiv class\x3d"jimu-btn saveFunction" data-dojo-attach-event\x3d"click:saveJsonToFile" \x3e${nls.buttons.save}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"rowHeader"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdLabel"\x3e${nls.labels.uploadHeading}\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr class\x3d"rowHeader"\x3e\r\n\t\t\t\t\t\x3ctd\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdData"\x3e\x3cinput type\x3d"file" id\x3d"jsonFileInput" data-dojo-attach-point\x3d"jsonFileInput" data-dojo-attach-event\x3d"change:readJsonToConfig" accept\x3d".json"\x3e\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"loadProgressHeader" id\x3d"tdProgress"\x3e\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\t\x3cbr\x3e\r\n\t\t\t\x3ctable id\x3d"tblSave" class\x3d"tableFormat" border\x3d0 cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\t\t\x3ctr class\x3d"rowHeader"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdLabel"\x3e${nls.labels.layerOptionHeading}\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr style\x3d"height:0px; display:none;"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdData"\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkAppendToDef" data-dojo-props\x3d"value:true,checked:false"/\x3e ${nls.labels.AppendDefHeading}\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"slAppendChoice" data-dojo-type\x3d"dijit/form/Select"\x3e\r\n\t\t\t\t\t\t    \x3coption value\x3d"OR"\x3e${nls.inputs.optionOR}\x3c/option\x3e\r\n\t\t\t\t\t\t    \x3coption value\x3d"AND"\x3e${nls.inputs.optionAND}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"tdData"\x3e\x3cinput type\x3d"checkbox" data-dojo-type\x3d"dijit/form/CheckBox"  data-dojo-attach-point\x3d"chkPersistDef" data-dojo-props\x3d"value:true,checked:false"/\x3e ${nls.labels.PersistDefHeading}\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/table\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\r\n\r\n\t\x3cdiv class\x3d"buttonContainer"\x3e\r\n\t\t\x3ctable class\x3d"buttonContainerTable" border\x3d0\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"filter-add-criteria"\x3e\x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"btnCriteria" data-dojo-attach-event\x3d"click:btnNewRowAction"\x3e${nls.buttons.addCriteria}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3ctable class\x3d"buttonContainerSubtable" border\x3d0\x3e\r\n\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\x3ctd class\x3d"filter-button-apply"\x3e\x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"btnApply" data-dojo-attach-event\x3d"click:setFilterLayerDef"\x3e${nls.buttons.applyCriteria}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\t\t\t\x3ctd class\x3d"filter-button-cancel"\x3e\x3cdiv class\x3d"jimu-btn" data-dojo-attach-point\x3d"btnReset" data-dojo-attach-event\x3d"click:resetLayerDef"\x3e${nls.buttons.removeCriteria}\x3c/div\x3e\x3c/td\x3e\r\n\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\r\n\x3c/div\x3e',
"url:widgets/GroupFilter/css/style.css":'.jimu-widget-map-filter {width:100%; height:100%;}.jimu-widget-map-filter .groupContainer {display: block;}.jimu-widget-map-filter .container {border-color: #e1e1e1; border-top: 3px solid; width: 100%; height: 60%; position:relative; overflow-y: auto; overflow-x: auto; display: block;}.jimu-widget-map-filter .saveContainer {width: 100%; height: 100%; position:absolute; top: 0px; left: 0px; z-index: 999; overflow-y: auto; overflow-x: auto; display: none;}.jimu-widget-map-filter .save-block {position: absolute; left: 5px;}.jimu-widget-map-filter .close-save {position:relative; float: right; content: url("../images/setting_default.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .close-save:after {position:relative; float: right; content: url("../images/setting_default.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .headerTable {width: 100%;}.jimu-widget-map-filter .groupHeader {font-size: 10pt; padding-left: 0px; padding-bottom: 5px; width: 100%;}.jimu-widget-map-filter .saveTD {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .saveTD:after {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .saveTDClose {content: url("../images/setting_default.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .saveTDClose:after {content: url("../images/setting_default.png"); cursor: hand; cursor: pointer;}.jimu-widget-map-filter .group-picker {padding-bottom: 5px;}.jimu-widget-map-filter .filter-block {position: absolute; left: 0px; top: 5px;}.jimu-widget-map-filter .filter-row {position: relative; width: 100%;}.jimu-widget-map-filter .tableFormat {table-layout: fixed; width:100%;}.jimu-widget-map-filter .rowHeader {color: #000000;}.jimu-widget-map-filter .saveFunction {margin-top: 5px;}.jimu-widget-map-filter .tableRow {background-color: #E3E3E3;}.jimu-widget-map-filter .tdOperatorHide {display: block; width: 75px;}.jimu-widget-map-filter .operatorSelect {}.jimu-widget-map-filter .tdValue {width: 200px; height: 20px; padding-left: 5px;}.jimu-widget-map-filter .userInputNormal {width: 95%;}.jimu-widget-map-filter .tdConjunction {width: 75px;}.jimu-widget-map-filter .conjuncSelect {width: 70px;}.jimu-widget-map-filter .tdRemove {width: 16px; text-align: right;}.jimu-widget-map-filter .tdFirstLabel {text-align: left; padding-left: 5px; padding-top: 5px; padding-bottom: 0px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdLabel {text-align: left; padding-left: 5px; padding-top: 15px; padding-bottom: 2px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdData {text-align: left; padding-left: 5px; padding-top: 5px; padding-bottom: 5px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdUploadData {text-align: left; padding-left: 5px; padding-top: 10px; padding-bottom: 0px; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .tdSave {text-align: right; padding-right: 5px; width: 100%;}.jimu-widget-map-filter .loadProgressHeader {display: none; width: 16px;}.jimu-widget-map-filter .loadProgressShow {content: url("../images/validating.gif"); display: none; width: 16px;}.jimu-widget-map-filter .loadProgressShow:after {content: url("../images/validating.gif"); display: none; width: 16px;}.jimu-widget-map-filter .advModeOffset {content: url("../images/setting_default.png"); padding-right: 10px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .advModeOffset:after {content: url("../images/setting_default.png"); padding-right: 10px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .advModeClose {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer; width: 16px; height: 16px;}.jimu-widget-map-filter .advModeClose:after {content: url("../images/setting_disabled.png"); cursor: hand; cursor: pointer; width: 16px; height: 16px;}.jimu-widget-map-filter .advModeOpen {content: url(""); cursor: hand; cursor: pointer; width: 16px; height: 16px;}.jimu-widget-map-filter .deleteCell {content: url("../images/delete.png"); width: 16px; height: 16px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .deleteCell:after {content: url("../images/delete.png"); width: 16px; height: 16px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .deleteCell:hover {content: url("../images/delete_hover.png"); width: 16px; height: 16px; cursor: hand; cursor: pointer;}.jimu-widget-map-filter .buttonContainer {position: absolute; left: 0px; bottom: 0px; width: 100%;}.jimu-widget-map-filter .buttonContainerTable {width: 100%;}.jimu-widget-map-filter .buttonContainerSubtable {float: right;}.jimu-widget-map-filter .filter-add-criteria {text-align: left;}.jimu-widget-map-filter .filter-button-apply {text-align: right; padding-right: 5px;}.jimu-widget-map-filter .filter-button-cancel {text-align: right;}.jimu-widget-map-filter .criteriaCellSize {width: 90%; vertical-align: top; padding-top: 5px; padding-left: 2px;}.jimu-widget-map-filter .deleteCellSize {width: 20px; text-align: right; vertical-align: top; padding-top: 5px;}.jimu-widget-map-filter .hide-items {display: none;}.jimu-widget-map-filter .operator-class {}.jimu-widget-map-filter .value-class {}',
"*now":function(p){p(['dojo/i18n!*preload*widgets/GroupFilter/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","hr","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dijit/_WidgetsInTemplateMixin jimu/BaseWidget dijit jimu/dijit/FilterParameters dojo/dom dojo/dom-construct dojo/dom-class dojo/dom-attr dojo/dom-style dojo/on dojo/query dojo/string dojo/_base/lang dojo/_base/array dojo/date/locale dijit/form/Select dijit/form/TextBox dijit/form/DateTextBox dijit/form/NumberTextBox dijit/registry jimu/LayerInfos/LayerInfos jimu/utils jimu/FilterManager esri/tasks/query esri/tasks/QueryTask esri/geometry/geometryEngine esri/layers/FeatureLayer ./SaveJSON ./ReadJSON ./LayersHandler dojox/html/entities dijit/form/CheckBox".split(" "),function(p,
r,h,m,q,g,b,f,a,e,c,d,s,l,n,u,k,w,y,F,A,G,v,I,D,B,C,H,J,K,L,E){return p([h,r],{baseClass:"jimu-widget-map-filter",layerList:null,msLayersDesc:null,grpSelect:null,groupCounter:0,groupCurrVal:null,defaultDef:null,runTimeConfig:null,useDomain:null,useDate:null,useValue:null,runInitial:!1,graphicsHolder:null,slAppendChoice:null,chkAppendToDef:null,filterExt:null,postCreate:function(){this.inherited(arguments);this.defaultDef=[];this.graphicsHolder=[]},startup:function(){this.inherited(arguments);this.config.optionsMode&&
f.add(this.optionsIcon,"hide-items");""!==this.config.groups[0].defaultVal&&""!==this.config.groups[0].operator&&(this.runInitial=!0);"undefined"!==typeof this.config.webmapAppendMode&&(this.chkAppendToDef.checked=this.config.webmapAppendMode,this.slAppendChoice.value=this.config.slAppendChoice);this.createMapLayerList()},btnNewRowAction:function(){this.createNewRow({operator:"\x3d",value:"",conjunc:"OR",state:"new"})},createMapLayerList:function(){G.getInstance(this.map,this.map.itemInfo).then(l.hitch(this,
function(a){a._layerInfos&&0<a._layerInfos.length&&(this.layerList=a._layerInfos,this._pullMapServiceFields(a._layerInfos),n.forEach(this.layerList,l.hitch(this,function(a){"ArcGISTiledMapServiceLayer"!==a.originOperLayer.layerType&&"undefined"===typeof a.originOperLayer.featureCollection&&("undefined"!==typeof a.layerObject._defnExpr?this.defaultDef.push({layer:a.id,definition:a.layerObject._defnExpr,visible:a.layerObject.visible}):"undefined"!==typeof a.layerObject.defaultDefinitionExpression&&
"function"===typeof a.layerObject.getDefinitionExpression()?this.defaultDef.push({layer:a.id,definition:a.layerObject.getDefinitionExpression(),visible:a.layerObject.visible}):"undefined"!==typeof a.layerObject.layerDefinitions?this.defaultDef.push({layer:a.id,definition:a.layerObject.layerDefinitions,visible:a._visible}):this.defaultDef.push({layer:a.id,definition:"",visible:a.layerObject.visible}))})))}))},_pullMapServiceFields:function(a){this.msLayersDesc=[];a=new L({layers:a});this.own(c(a,"complete",
l.hitch(this,function(a){n.forEach(a.data.items,l.hitch(this,function(a){0<a.children.length&&this.msLayersDesc.push(a)}));this.createGroupSelection()})));this.own(c(a,"error",l.hitch(this,function(){console.log("error")})));a.getAllMapLayers()},checkDomainUse:function(a){this.useValue=this.useDomain=null;n.forEach(this.config.groups,l.hitch(this,function(b){b.name===a.group&&n.forEach(b.layers,l.hitch(this,function(a){n.forEach(this.layerList,l.hitch(this,function(b){"undefined"!==typeof b.newSubLayers&&
(0<b.newSubLayers.length?n.forEach(this.msLayersDesc,l.hitch(this,function(b){n.forEach(b.children,l.hitch(this,function(b){b.id===a.layer&&n.forEach(b.children,l.hitch(this,function(b){b.name===a.field&&""!==a.useDomain&&(this.useValue=a.useDomain)}))}))})):a.layer===b.id&&n.forEach(b.layerObject.fields,l.hitch(this,function(b){b.name===a.field&&""!==a.useDomain&&(this.useValue=a.useDomain,"undefined"!==typeof b.domain&&(this.useDomain=b.domain))})))}))}))}))},checkDateUse:function(a){this.useDate=
null;n.forEach(this.config.groups,l.hitch(this,function(b){b.name===a.group&&n.forEach(b.layers,l.hitch(this,function(a){n.forEach(this.layerList,l.hitch(this,function(b){a.layer===b.id&&n.forEach(b.layerObject.fields,l.hitch(this,function(b){b.name===a.field&&0<=b.type.indexOf("Date")&&(this.useDate=!0)}))}))}))}))},createGroupSelection:function(){var a=[],b="";n.forEach(this.config.groups,l.hitch(this,function(b){var c={};c.value=b.name;c.label=b.name;c.selected=!1;a.push(c)}));this.grpSelect=(new k({options:a})).placeAt(this.groupPicker);
this.grpSelect.startup();this.own(c(this.grpSelect,"change",l.hitch(this,function(a){this.resetLayerDef({group:this.groupCurrVal});this.removeAllRows();this.checkDomainUse({group:a});this.checkDateUse({group:a});this.reconstructRows(a);this.updateGroupDesc(a);this.groupCurrVal=a;setTimeout(l.hitch(this,this.setFilterLayerDef),1E3)})));this.checkDomainUse({group:this.grpSelect.value});this.checkDateUse({group:this.grpSelect.value});this.groupCurrVal=this.grpSelect.value;"undefined"!==typeof this.config.groups[0]&&
(b=this.config.groups[0].desc,this.groupDesc.innerHTML=b);var b=this.checkDefaultValue(this.config.groups[0]),d=this.checkDefaultOperator(this.config.groups[0]);this.createNewRow({operator:d,value:b,conjunc:"OR",state:"new"})},createNewRow:function(a){var c=g.byId("tblPredicates"),t;"new"===a.state&&(1<c.rows.length?(t=c.rows[c.rows.length-1].cells[0].firstChild,t=t.rows[2].cells[0],this.createConditionSelection(t,a)):1===c.rows.length&&(t=c.rows[c.rows.length-1].cells[0].firstChild,t=t.rows[2].cells[0],
this.createConditionSelection(t,a)));t=c.insertRow(-1);var x=t.insertCell(0),h=t.insertCell(1);f.add(x,"criteriaCellSize");f.add(h,"deleteCellSize");var z=b.create("table",{border:"0",width:"100%"},x),x=z.insertRow(-1),m=x.insertCell(0),n=z.insertRow(-1).insertCell(0),z=z.insertRow(-1).insertCell(0);e.set(z,{paddingLeft:"3px",paddingRight:"3px"});f.add(x,"operator-class");this.colorRows();this.createOperatorSelection(m,a);this.removeTableRow(h,t,c.rows.length);this.createInputFilter(n,a);this.resize();
this.config.simpleMode&&(f.add(this.btnCriteria,"hide-items"),f.add(x,"hide-items"),d(".container").style("borderTop","0px"),e.set(n,{paddingLeft:"0px",paddingRight:"0px"}));"reload"===a.state?""!==a.conjunc&&(t=c.rows[c.rows.length-1].cells[0].firstChild,t=t.rows[2].cells[0],this.createConditionSelection(t,a)):this.runInitial&&(this.runInitial=!1,setTimeout(l.hitch(this,this.setFilterLayerDef),1E3))},colorRows:function(){var a=g.byId("tblPredicates").rows;n.forEach(a,function(a,b){0===b%2?f.remove(a,
"tableRow"):f.add(a,"tableRow")})},createOperatorSelection:function(a,b){var d=(new k({options:[{value:"\x3d",label:this.nls.inputs.optionEQUAL},{value:"\x3c\x3e",label:this.nls.inputs.optionNOTEQUAL},{value:"\x3e",label:this.nls.inputs.optionGREATERTHAN},{value:"\x3e\x3d",label:this.nls.inputs.optionGREATERTHANEQUAL},{value:"\x3c",label:this.nls.inputs.optionLESSTHAN},{value:"\x3c\x3d",label:this.nls.inputs.optionLESSTHANEQUAL},{value:"START",label:this.nls.inputs.optionSTART},{value:"END",label:this.nls.inputs.optionEND},
{value:"LIKE",label:this.nls.inputs.optionLIKE},{value:"NOT LIKE",label:this.nls.inputs.optionNOTLIKE}],"class":"operatorSelect"})).placeAt(a);d.startup();d.set("value",E.decode(b.operator));this.own(c(d,"click",l.hitch(this,function(){})));this.own(c(d,"change",l.hitch(this,function(){})))},createInputFilter:function(a,c){b.empty(a);if(null!==this.useDomain)if("undefined"!==typeof this.useDomain.codedValues){var d=new q;d.placeAt(a);d.startup();this.createValueList(c,d)}else d="",""!==c.value&&(d=
Number(c.value)),(new F({value:d,placeHolder:s.substitute(this.nls.inputs.textboxNumber,{"0":this.useDomain.minValue,1:this.useDomain.maxValue}),"class":"userInputNormal",constraints:{min:this.useDomain.minValue,max:this.useDomain.maxValue}})).placeAt(a).startup(),this.formatSpacing(a);else if(!0===this.useValue)d=new q,d.placeAt(a),d.startup(),this.createValueList(c,d);else{if(!0===this.useDate){var d=u.format(""!==c.value?new Date(c.value):new Date,{selector:"date",fullYear:!0}),e=(new y({value:d,
placeHolder:d,"class":"userInputNormal"})).placeAt(a);e.startup();e.set("displayedValue",d)}else(new w({value:c.value,placeHolder:this.nls.inputs.textboxText,"class":"userInputNormal"})).placeAt(a).startup();this.formatSpacing(a)}},createValueList:function(a,b){var d={},e=[];n.forEach(this.config.groups,l.hitch(this,function(g){g.name===this.grpSelect.value&&n.forEach(g.layers,l.hitch(this,function(g){n.forEach(this.layerList,l.hitch(this,function(f){0<f.newSubLayers.length?n.forEach(this.msLayersDesc,
l.hitch(this,function(f){n.forEach(f.children,l.hitch(this,function(f){if(f.id===g.layer&&!0===g.useDomain){var h=new H(f.url);this.own(c(h,"load",l.hitch(this,function(){this._callFilterDijit(g,a,f.url,h,e,d,b)})))}}))})):g.layer===f.id&&!0===g.useDomain&&this._callFilterDijit(g,a,f.layerObject.url,f.layerObject,e,d,b)}))}))}))},_callFilterDijit:function(b,c,e,g,f,h,m){var k={fieldObj:{}};k.fieldObj.name=b.field;k.fieldObj.label=b.field;k.fieldObj.shortType=b.dataType.replace("esriFieldType","").toLowerCase();
if("guid"!==k.fieldObj.shortType||"globalid"!==k.fieldObj.shortType)k.fieldObj.shortType="string";"date"!==k.fieldObj.shortType&&"string"!==k.fieldObj.shortType&&(k.fieldObj.shortType="number");k.fieldObj.type=b.dataType;k.operator=k.fieldObj.shortType+"OperatorIs";k.valueObj={};k.valueObj.isValid=!0;k.valueObj.type="unique";-1<b.dataType.indexOf("Integer")||-1<b.dataType.indexOf("Double")||-1<b.dataType.indexOf("Short")?k.valueObj.value=this.useDomain?Number(c.value):c.value:k.valueObj.value=c.value;
k.interactiveObj={};k.interactiveObj.prompt="";k.interactiveObj.hint="";k.caseSensitive=!1;f.push(k);h.logicalOperator="OR";h.expr="";h.parts=f;m.build(e,g,h).then(l.hitch(this,function(){}));b=d(".jimu-single-filter-parameter");n.forEach(b,function(b){var c=d("table",b);n.forEach(c,function(b){a.set(b,"cellpadding","1");a.set(b,"cellspacing","1")});b=d("colgroup",b);0<b.length&&a.set(b[0].childNodes[1],"width","0px")})},formatSpacing:function(a){e.set(a,{paddingLeft:"2px",paddingRight:"2px"})},createConditionSelection:function(a,
c){b.empty(a);var d=(new k({options:[{value:"OR",label:this.nls.inputs.optionOR},{value:"AND",label:this.nls.inputs.optionAND}],"class":"conjuncSelect"})).placeAt(a);d.startup();d.set("value",c.conjunc)},removeTableRow:function(a,d,e){1<e&&(e=b.create("div",{"class":"deleteCell",innerHTML:""}),this.own(c(e,"click",l.hitch(this,function(){b.destroy(d);var a=g.byId("tblPredicates");1<=a.rows.length&&b.empty(a.rows[a.rows.length-1].cells[0].firstChild.rows[2].cells[0]);this.colorRows()}))),b.place(e,
a))},removeAllRows:function(){var a=g.byId("tblPredicates");if(1<=a.rows.length){var c=A.byNode(a.rows[0].cells[0].firstChild.rows[1].cells[0].childNodes[0]);"undefined"!==typeof c&&m.byId(c.id).destroyRecursive(!0);b.destroy(a.rows[0]);this.removeAllRows()}},reconstructRows:function(a){""!==a?n.forEach(this.config.groups,l.hitch(this,function(b){if(b.name===a){var c="",d="\x3d";"undefined"!==typeof b.def?0<b.def.length?n.forEach(b.def,l.hitch(this,function(a){this.createNewRow({value:a.value,operator:a.operator,
conjunc:a.conjunc,state:"reload"})})):(c=this.checkDefaultValue(b),d=this.checkDefaultOperator(b),this.createNewRow({operator:d,value:c,conjunc:"OR",state:"new"})):(c=this.checkDefaultValue(b),d=this.checkDefaultOperator(b),this.createNewRow({operator:d,value:c,conjunc:"OR",state:"new"}))}})):this.createNewRow({operator:"\x3d",value:"",conjunc:"OR",state:"new"})},checkDefaultValue:function(a){var b="";""!==a.defaultVal&&(b=a.defaultVal);return b},checkDefaultOperator:function(a){var b="\x3d";""!==
a.operator&&(b=a.operator);return b},parseTable:function(){var a=[],b=g.byId("tblPredicates").rows;n.forEach(b,l.hitch(this,function(b,c){if(0<=c){var e=b.cells[0].firstChild,g=A.byNode(e.rows[0].cells[0].childNodes[0]),f=A.byNode(e.rows[1].cells[0].childNodes[0]),l={};"undefined"!==typeof e.rows[2].cells[0].childNodes[0]?l=A.byNode(e.rows[2].cells[0].childNodes[0]):l.value="";var k="";if("undefined"!==typeof f.partsObj){if(f=f.getValueProviders()[0].getValueObject())k=f.value}else k=f.value;e=d(".dijitReset.dijitInputInner",
e.rows[1].cells[0].childNodes[0]);0<e.length&&""===e[0].value&&(k="");a.push({operator:g.value,userValue:k,conjunc:l.value})}}));return a},formatDate:function(a){var b=u.format(a,{datePattern:"yyyy-MM-dd",selector:"date"});a=u.format(a,{selector:"time",timePattern:"HH:mm:ss"});return b+" "+a},createQuery:function(a,b,c,d,e,f){isNaN(d)&&(d=E.decode(d.replace(/'/g,"''")));if(""===d)return"\x3c\x3e"===c||"NOT LIKE"===c?-1<f.indexOf("Double")||-1<f.indexOf("Single")?[b,"IS NOT NULL",e].join(" ")+" ":
[b,"\x3c\x3e '' OR",b,"IS NOT NULL",e].join(" ")+" ":-1<f.indexOf("Double")||-1<f.indexOf("Single")?[b,"IS NULL",e].join(" ")+" ":[b,"\x3d '' OR",b,"IS NULL",e].join(" ")+" ";"LIKE"===c||"NOT LIKE"===c?!1===a?(d="UPPER('%"+d+"%')",b="UPPER("+b+")"):d="'%"+d+"%'":"START"===c?(c="LIKE",!1===a?(d="UPPER('"+d+"%')",b="UPPER("+b+")"):d+="%"):"END"===c?(c="LIKE",!1===a?(d="UPPER('%"+d+"')",b="UPPER("+b+")"):d="%"+d):!1===a&&(-1<f.indexOf("Date")?"\x3d"===c||"\x3c\x3e"===c?(c="\x3d"===c?"BETWEEN":"NOT BETWEEN",
d="'"+this.formatDate(d)+"' AND '"+this.formatDate(d)+"'"):d="'"+this.formatDate(d)+"'":(d="UPPER('"+d+"')",b="UPPER("+b+")"));return[b,c,d,e].join(" ")+" "},setFilterLayerDef:function(){this.filterExt=null;this.graphicsHolder=[];var a=this.parseTable();n.forEach(this.config.groups,l.hitch(this,function(b){if(this.grpSelect.value===b.name){var c=[];n.forEach(this.layerList,l.hitch(this,function(d){var e=[],f="",g="",k="";n.forEach(b.layers,l.hitch(this,function(h,m){"undefined"!==typeof b.appendSameLayer&&
!0===b.appendSameLayer?g!==h.layer?""!==f&&(this.setupFilterToApply(d,k,f,e,!0),f=""):""!==g&&(f=f+" "+b.appendSameLayerConjunc+" ",f===" "+b.appendSameLayerConjunc+" "&&(f="")):f="";if(d.id===h.layer)b.def=[],k="FeatureLayer",n.forEach(a,l.hitch(this,function(a){n.forEach(d.layerObject.fields,l.hitch(this,function(d){if(d.name===h.field){if(-1<d.type.indexOf("Integer")||-1<d.type.indexOf("Double")||-1<d.type.indexOf("Single")){var e=v.sanitizeHTML(a.userValue);if(!1===isNaN(e)){if(0!==v.sanitizeHTML(a.userValue)%
1){var g=e.split(".");6<g[1].length&&(g[1]=g[1].substring(0,6),e=g[0]+"."+g[1]);"\x3d"===a.operator?a.operator="LIKE":"\x3c\x3e"===a.operator&&(a.operator="NOT LIKE")}f+=this.createQuery(!0,h.field,a.operator,e,a.conjunc,d.type)}else console.log("Not a Number")}else-1<d.type.indexOf("Date")?""!==a.userValue?(e=new Date(v.sanitizeHTML(a.userValue)),-1<d.type.indexOf("Time")?u.format(e,{fullYear:!0,datePattern:"yyyy-MM-dd, HH:mm:ss a"}):u.format(e,{fullYear:!0,datePattern:"yyyy-MM-dd"}),f+=this.createQuery(!1,
h.field,a.operator,e,a.conjunc,d.type)):f+=this.createQuery(!1,h.field,a.operator,v.sanitizeHTML(a.userValue),a.conjunc,d.type):f+=this.createQuery(!1,h.field,a.operator,v.sanitizeHTML(a.userValue),a.conjunc,d.type);b.def.push({field:h.field,value:v.sanitizeHTML(a.userValue),operator:a.operator,conjunc:a.conjunc});c.push({field:h.field,value:v.sanitizeHTML(a.userValue),operator:a.operator,conjunc:a.conjunc})}}))}));else if(0<=h.layer.indexOf(d.id)){b.def=[];k="MapService";var p=h.layer.split(".");
n.forEach(a,l.hitch(this,function(a){if(""!==a.userValue)if(-1<h.dataType.indexOf("Integer")||-1<h.dataType.indexOf("Double"))f+=this.createQuery(!0,h.field,a.operator,v.sanitizeHTML(a.userValue),a.conjunc,h.dataType);else if(-1<h.dataType.indexOf("Date"))if(""!==a.userValue){var d=new Date(v.sanitizeHTML(a.userValue)),d=-1<field.type.indexOf("Time")?u.format(d,{fullYear:!0,datePattern:"yyyy-MM-dd, HH:mm:ss a"}):u.format(d,{fullYear:!0,datePattern:"yyyy-MM-dd"});f+=this.createQuery(!1,h.field,a.operator,
d,a.conjunc,h.dataType)}else f+=this.createQuery(!1,h.field,a.operator,v.sanitizeHTML(a.userValue),a.conjunc,h.dataType);else f+=this.createQuery(!1,h.field,a.operator,v.sanitizeHTML(a.userValue),a.conjunc,h.dataType);else f+=this.createQuery(!1,h.field,a.operator,v.sanitizeHTML(a.userValue),a.conjunc,h.dataType);b.def.push({field:h.field,value:v.sanitizeHTML(a.userValue),operator:a.operator,conjunc:a.conjunc});c.push({field:h.field,value:v.sanitizeHTML(a.userValue),operator:a.operator,conjunc:a.conjunc})}));
""!==f&&(e[p[1]]=f.trim())}g=h.layer;"undefined"!==typeof b.appendSameLayer&&!1===b.appendSameLayer?this.setupFilterToApply(d,k,f,e,!0):m===b.layers.length-1&&this.setupFilterToApply(d,k,f,e,!0)}))}));"undefined"!==typeof c&&0<c.length&&this._publishData(c)}}))},setupFilterToApply:function(a,b,c,d,e){"FeatureLayer"===b?""!==c&&(this._applyFilter(a.layerObject,c.trim(),e),a.layerObject.setVisibility(!0)):"MapService"===b&&0<d.length&&(this.chkAppendToDef.checked?n.forEach(this.defaultDef,l.hitch(this,
function(b){b.layer===a.id&&(n.forEach(d,l.hitch(this,function(a,c){for(var e in b.definition)"undefined"!==b.definition[e]&&d[c.toString()]&&(d[c.toString()]="("+b.definition[e]+") "+this.slAppendChoice.value+" "+a)})),a.layerObject.setLayerDefinitions(d),this._zoomOnFilter(a.layerObject,e))})):(a.layerObject.setLayerDefinitions(d),this._zoomOnFilter(a.layerObject,e)),a.layerObject.setVisibility(!0))},resetLayerDef:function(a){"undefined"===typeof a.group&&(a.group=this.grpSelect.value);n.forEach(this.config.groups,
l.hitch(this,function(b){b.name===a.group&&n.forEach(b.layers,l.hitch(this,function(a){n.forEach(this.layerList,l.hitch(this,function(b){var c=!1;a.layer===b.id?c=!0:0<b.newSubLayers.length&&n.forEach(b.newSubLayers,l.hitch(this,function(d){d=b.id+"."+d.id.substring(d.id.lastIndexOf("_")+1);a.layer===d&&(c=!0)}));c&&n.forEach(this.defaultDef,l.hitch(this,function(a){a.layer===b.id&&("undefined"!==typeof b.layerObject.defaultDefinitionExpression?this._applyFilter(b.layerObject,a.definition,!1):"undefined"!==
typeof b.layerObject.layerDefinitions?b.layerObject.setLayerDefinitions(a.definition):this._applyFilter(b.layerObject,a.definition,!1),b.layerObject.setVisibility(a.visible))}))}))}))}))},updateGroupDesc:function(a){n.forEach(this.config.groups,l.hitch(this,function(b){b.name===a&&(this.groupDesc.innerHTML=b.desc)}))},toggleSaveFilter:function(){var a;0<d(".saveTD").length?(a=d(".container"),0<a.length&&(f.replace(g.byId("saveTD"),"saveTDClose","saveTD"),a.style("display","none"),d(".saveContainer").style("display",
"block"),d(".groupContainer").style("display","none"),d(".buttonContainer").style("display","none"))):(a=d(".saveTDClose"),0<a.length&&(f.replace(a[0],"saveTD","saveTDClose"),a=d(".container"),0<a.length&&(f.replace(g.byId("saveTD"),"saveTD","saveTDClose"),a.style("display","block"),d(".saveContainer").style("display","none"),d(".groupContainer").style("display","block"),d(".buttonContainer").style("display","block"))))},saveJsonToFile:function(){var a=new J({config:this.config});this.own(c(a,"complete",
l.hitch(this,function(){console.log("save done")})));a.exportsJson(this.nls.files.jsonFile+".json",this.config)},readJsonToConfig:function(){d(".loadProgressHeader").style("display","block");d(".loadProgressShow").style("display","block");var a=new K({config:this.config,jsonFile:this.jsonFileInput.files});this.own(c(a,"complete",l.hitch(this,function(a){this.config=JSON.parse(a.UserSettings);this.resetLayerDef({group:this.grpSelect.value});this.removeAllRows();this.checkDomainUse({group:this.grpSelect.value});
this.checkDateUse({group:this.grpSelect.value});this.reconstructRows(this.grpSelect.value);this.updateGroupDesc(this.grpSelect.value);setTimeout(l.hitch(this,this.setFilterLayerDef),1E3);d(".loadProgressHeader").style("display","none");d(".loadProgressShow").style("display","none");this.jsonFileInput.value=null;this.toggleSaveFilter()})));this.own(c(a,"error",l.hitch(this,function(){this.jsonFileInput.value=null;d(".loadProgressHeader").style("display","none");d(".loadProgressShow").style("display",
"none")})));a.checkFileReader();return!0},_publishData:function(a){var b=[],c=[];n.forEach(a,l.hitch(this,function(a){-1===b.indexOf(a.field)&&b.push(a.field);-1===c.indexOf(a.value)&&c.push(a.value)}));this.publishData({message:{fields:b,values:c}})},resize:function(){var b=d(".jimu-single-filter-parameter");0<b.length&&n.forEach(b,l.hitch(this,function(b){b=d("colgroup",b);0<b.length&&a.set(b[0].childNodes[1],"width","0px")}));320>=window.innerWidth?(f.add(this.btnCriteria,"hide-items"),d(".operator-class").style("display",
"none"),d(".container").style("borderTop","0px"),d(".value-class").style("paddingTop","-10px")):this.config.simpleMode||(f.remove(this.btnCriteria,"hide-items"),d(".operator-class").style("display","block"),d(".container").style("borderTop","3px solid"),d(".value-class").style("paddingTop","0px"))},_applyFilter:function(a,b,c){var d=!1;"AND"===this.slAppendChoice.value&&(d=!0);I.getInstance().applyWidgetFilter(a.id,this.id,b,this.chkAppendToDef.checked,d);this._zoomOnFilter(a,c)},_zoomOnFilter:function(a,
b){if(this.config.zoomMode)if("undefined"!==typeof a.layerDefinitions&&0<a.layerDefinitions.length)var d=c(this.map,"update-end",l.hitch(this,function(){var b=new D;b.outFields=["*"];for(var c in a.layerDefinitions)if(a.layerDefinitions.hasOwnProperty(c)){var e=a.url+"/"+c;b.where=a.layerDefinitions[c];b.returnGeometry=!0;b.outSpatialReference=this.map.spatialReference;(new B(e)).executeForExtent(b,l.hitch(this,this._queryExtentToZoom))}d.remove()}));else{var e=new D;e.outFields=["*"];if("ArcGISImageServiceLayer"===
a.type){var f=a.url;e.where=a.getDefinitionExpression();e.returnGeometry=!0;e.outSpatialReference=this.map.spatialReference;(new B(f)).executeForExtent(e,l.hitch(this,this._queryExtentToZoom))}else a.queryExtent(e,l.hitch(this,this._queryExtentToZoom))}},_queryExtentToZoom:function(a){"undefined"!==typeof a.extent&&null!==a.extent&&(a=C.geodesicBuffer(a.extent,10,9002,!1).getExtent(),null===this.filterExt&&(this.filterExt=a),a=a.update(this.filterExt.xmin<a.xmin?this.filterExt.xmin:a.xmin,this.filterExt.ymin<
a.ymin?this.filterExt.ymin:a.ymin,this.filterExt.xmax>a.xmax?this.filterExt.xmax:a.xmax,this.filterExt.ymax>a.ymax?this.filterExt.ymax:a.ymax,a.spatialReference),this.filterExt=a=C.geodesicBuffer(a,200,9002,!1).getExtent(),this.map.setExtent(a))},onOpen:function(){console.log("onOpen")},onClose:function(){this.chkPersistDef.checked||(this.resetLayerDef({group:this.grpSelect.value}),this.removeAllRows(),this.reconstructRows(""))},onMinimize:function(){console.log("onMinimize")},onMaximize:function(){console.log("onMaximize")},
onSignIn:function(a){console.log("onSignIn")},onSignOut:function(){console.log("onSignOut")}})});