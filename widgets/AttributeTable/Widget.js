// All material copyright ESRI, All Rights Reserved, unless otherwise specified.
// See http://@sbaseurl@/jsapi/jsapi/esri/copyright.txt and http://www.arcgis.com/apps/webappbuilder/copyright.txt for details.
//>>built
require({cache:{"dijit/layout/TabContainer":function(){define(["dojo/_base/lang","dojo/_base/declare","./_TabContainerBase","./TabController","./ScrollingTabController"],function(k,f,p,s,n){return f("dijit.layout.TabContainer",p,{useMenu:!0,useSlider:!0,controllerWidget:"",_makeController:function(f){var h=this.baseClass+"-tabs"+(this.doLayout?"":" dijitTabNoLayout");return new ("string"==typeof this.controllerWidget?k.getObject(this.controllerWidget):this.controllerWidget)({id:this.id+"_tablist",
ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,tabPosition:this.tabPosition,doLayout:this.doLayout,containerId:this.id,"class":h,nested:this.nested,useMenu:this.useMenu,useSlider:this.useSlider,tabStripClass:this.tabStrip?this.baseClass+(this.tabStrip?"":"No")+"Strip":null},f)},postMixInProperties:function(){this.inherited(arguments);this.controllerWidget||(this.controllerWidget=("top"==this.tabPosition||"bottom"==this.tabPosition)&&!this.nested?n:s)}})})},"dijit/layout/_TabContainerBase":function(){define("dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style ./StackContainer ./utils ../_TemplatedMixin dojo/text!./templates/TabContainer.html".split(" "),
function(k,f,p,s,n,l,h,r){return k("dijit.layout._TabContainerBase",[n,h],{tabPosition:"top",baseClass:"dijitTabContainer",tabStrip:!1,nested:!1,templateString:r,postMixInProperties:function(){this.baseClass+=this.tabPosition.charAt(0).toUpperCase()+this.tabPosition.substr(1).replace(/-.*/,"");this.srcNodeRef&&s.set(this.srcNodeRef,"visibility","hidden");this.inherited(arguments)},buildRendering:function(){this.inherited(arguments);this.tablist=this._makeController(this.tablistNode);this.doLayout||
f.add(this.domNode,"dijitTabContainerNoLayout");this.nested?(f.add(this.domNode,"dijitTabContainerNested"),f.add(this.tablist.containerNode,"dijitTabContainerTabListNested"),f.add(this.tablistSpacer,"dijitTabContainerSpacerNested"),f.add(this.containerNode,"dijitTabPaneWrapperNested")):f.add(this.domNode,"tabStrip-"+(this.tabStrip?"enabled":"disabled"))},_setupChild:function(m){f.add(m.domNode,"dijitTabPane");this.inherited(arguments)},startup:function(){this._started||(this.tablist.startup(),this.inherited(arguments))},
layout:function(){if(this._contentBox&&"undefined"!=typeof this._contentBox.l){var f=this.selectedChildWidget;if(this.doLayout){var e=this.tabPosition.replace(/-h/,"");this.tablist.region=e;e=[this.tablist,{domNode:this.tablistSpacer,region:e},{domNode:this.containerNode,region:"center"}];l.layoutChildren(this.domNode,this._contentBox,e);this._containerContentBox=l.marginBox2contentBox(this.containerNode,e[2]);f&&f.resize&&f.resize(this._containerContentBox)}else{if(this.tablist.resize){e=this.tablist.domNode.style;
e.width="0";var h=p.getContentBox(this.domNode).w;e.width="";this.tablist.resize({w:h})}f&&f.resize&&f.resize()}}},destroy:function(f){this.tablist&&this.tablist.destroy(f);this.inherited(arguments)}})})},"dijit/layout/StackContainer":function(){define("dojo/_base/array dojo/cookie dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/has dojo/_base/lang dojo/on dojo/ready dojo/topic dojo/when ../registry ../_WidgetBase ./_LayoutWidget".split(" "),function(k,f,p,s,n,l,h,r,m,e,t,a,d,c){l("dijit-legacy-requires")&&
m(0,function(){require(["dijit/layout/StackController"])});p=p("dijit.layout.StackContainer",c,{doLayout:!0,persist:!1,baseClass:"dijitStackContainer",buildRendering:function(){this.inherited(arguments);s.add(this.domNode,"dijitLayoutContainer")},postCreate:function(){this.inherited(arguments);this.own(r(this.domNode,"keydown",h.hitch(this,"_onKeyDown")))},startup:function(){if(!this._started){var b=this.getChildren();k.forEach(b,this._setupChild,this);this.persist?this.selectedChildWidget=a.byId(f(this.id+
"_selectedChild")):k.some(b,function(b){b.selected&&(this.selectedChildWidget=b);return b.selected},this);var c=this.selectedChildWidget;!c&&b[0]&&(c=this.selectedChildWidget=b[0],c.selected=!0);e.publish(this.id+"-startup",{children:b,selected:c,textDir:this.textDir});this.inherited(arguments)}},resize:function(){if(!this._hasBeenShown){this._hasBeenShown=!0;var b=this.selectedChildWidget;b&&this._showChild(b)}this.inherited(arguments)},_setupChild:function(b){var a=b.domNode,g=n.place("\x3cdiv role\x3d'tabpanel' class\x3d'"+
this.baseClass+"ChildWrapper dijitHidden'\x3e",b.domNode,"replace"),c=b["aria-label"]||b.title||b.label;c&&g.setAttribute("aria-label",c);n.place(a,g);b._wrapper=g;this.inherited(arguments);"none"==a.style.display&&(a.style.display="block");b.domNode.removeAttribute("title")},addChild:function(b,a){this.inherited(arguments);this._started&&(e.publish(this.id+"-addChild",b,a),this.layout(),this.selectedChildWidget||this.selectChild(b))},removeChild:function(b){var a=k.indexOf(this.getChildren(),b);
this.inherited(arguments);n.destroy(b._wrapper);delete b._wrapper;this._started&&e.publish(this.id+"-removeChild",b);if(!this._descendantsBeingDestroyed){if(this.selectedChildWidget===b&&(this.selectedChildWidget=void 0,this._started)){var g=this.getChildren();g.length&&this.selectChild(g[Math.max(a-1,0)])}this._started&&this.layout()}},selectChild:function(b,c){var g;b=a.byId(b);this.selectedChildWidget!=b&&(g=this._transition(b,this.selectedChildWidget,c),this._set("selectedChildWidget",b),e.publish(this.id+
"-selectChild",b,this._focused),this.persist&&f(this.id+"_selectedChild",this.selectedChildWidget.id));return t(g||!0)},_transition:function(b,a){a&&this._hideChild(a);var g=this._showChild(b);b.resize&&(this.doLayout?b.resize(this._containerContentBox||this._contentBox):b.resize());return g},_adjacent:function(b){var a=this.getChildren(),g=k.indexOf(a,this.selectedChildWidget),g=g+(b?1:a.length-1);return a[g%a.length]},forward:function(){return this.selectChild(this._adjacent(!0),!0)},back:function(){return this.selectChild(this._adjacent(!1),
!0)},_onKeyDown:function(b){e.publish(this.id+"-containerKeyDown",{e:b,page:this})},layout:function(){var b=this.selectedChildWidget;b&&b.resize&&(this.doLayout?b.resize(this._containerContentBox||this._contentBox):b.resize())},_showChild:function(b){var a=this.getChildren();b.isFirstChild=b==a[0];b.isLastChild=b==a[a.length-1];b._set("selected",!0);b._wrapper&&s.replace(b._wrapper,"dijitVisible","dijitHidden");return b._onShow&&b._onShow()||!0},_hideChild:function(b){b._set("selected",!1);b._wrapper&&
s.replace(b._wrapper,"dijitHidden","dijitVisible");b.onHide&&b.onHide()},closeChild:function(b){if(!b.onClose||b.onClose(this,b))this.removeChild(b),b.destroyRecursive()},destroyDescendants:function(b){this._descendantsBeingDestroyed=!0;this.selectedChildWidget=void 0;k.forEach(this.getChildren(),function(a){b||this.removeChild(a);a.destroyRecursive(b)},this);this._descendantsBeingDestroyed=!1}});p.ChildWidgetProperties={selected:!1,disabled:!1,closable:!1,iconClass:"dijitNoIcon",showTitle:!0};h.extend(d,
p.ChildWidgetProperties);return p})},"dijit/layout/TabController":function(){define("dojo/_base/declare dojo/dom dojo/dom-attr dojo/dom-class dojo/has dojo/i18n dojo/_base/lang ./StackController ../registry ../Menu ../MenuItem dojo/text!./templates/_TabButton.html dojo/i18n!../nls/common".split(" "),function(k,f,p,s,n,l,h,r,m,e,t,a){a=k("dijit.layout._TabButton"+(n("dojo-bidi")?"_NoBidi":""),r.StackButton,{baseClass:"dijitTab",cssStateNodes:{closeNode:"dijitTabCloseButton"},templateString:a,_setNameAttr:"focusNode",
scrollOnFocus:!1,buildRendering:function(){this.inherited(arguments);f.setSelectable(this.containerNode,!1)},startup:function(){this.inherited(arguments);var a=this.domNode;this.defer(function(){a.className=a.className},1)},_setCloseButtonAttr:function(a){this._set("closeButton",a);s.toggle(this.domNode,"dijitClosable",a);this.closeNode.style.display=a?"":"none";a&&(a=l.getLocalization("dijit","common"),this.closeNode&&p.set(this.closeNode,"title",a.itemClose))},_setDisabledAttr:function(a){this.inherited(arguments);
if(this.closeNode)if(a)p.remove(this.closeNode,"title");else{var c=l.getLocalization("dijit","common");p.set(this.closeNode,"title",c.itemClose)}},_setLabelAttr:function(a){this.inherited(arguments);!this.showLabel&&!this.params.title&&(this.iconNode.alt=h.trim(this.containerNode.innerText||this.containerNode.textContent||""))}});n("dojo-bidi")&&(a=k("dijit.layout._TabButton",a,{_setLabelAttr:function(a){this.inherited(arguments);this.applyTextDir(this.iconNode,this.iconNode.alt)}}));k=k("dijit.layout.TabController",
r,{baseClass:"dijitTabController",templateString:"\x3cdiv role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown:onkeydown'\x3e\x3c/div\x3e",tabPosition:"top",buttonWidget:a,buttonWidgetCloseClass:"dijitTabCloseButton",postCreate:function(){this.inherited(arguments);var a=new e({id:this.id+"_Menu",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,targetNodeIds:[this.domNode],selector:function(b){return s.contains(b,"dijitClosable")&&!s.contains(b,"dijitTabDisabled")}});
this.own(a);var c=l.getLocalization("dijit","common"),b=this;a.addChild(new t({label:c.itemClose,ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir,onClick:function(a){a=m.byNode(this.getParent().currentTarget);b.onCloseButtonClick(a.page)}}))}});k.TabButton=a;return k})},"dijit/layout/StackController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-construct dojo/keys dojo/_base/lang dojo/on dojo/topic ../focus ../registry ../_Widget ../_TemplatedMixin ../_Container ../form/ToggleButton dojo/touch".split(" "),
function(k,f,p,s,n,l,h,r,m,e,t,a,d,c){s=f("dijit.layout._StackButton",c,{tabIndex:"-1",closeButton:!1,_aria_attr:"aria-selected",buildRendering:function(b){this.inherited(arguments);(this.focusNode||this.domNode).setAttribute("role","tab")}});f=f("dijit.layout.StackController",[t,a,d],{baseClass:"dijitStackController",templateString:"\x3cspan role\x3d'tablist' data-dojo-attach-event\x3d'onkeydown'\x3e\x3c/span\x3e",containerId:"",buttonWidget:s,buttonWidgetCloseClass:"dijitStackCloseButton",pane2button:function(b){return e.byId(this.id+
"_"+b)},postCreate:function(){this.inherited(arguments);this.own(r.subscribe(this.containerId+"-startup",l.hitch(this,"onStartup")),r.subscribe(this.containerId+"-addChild",l.hitch(this,"onAddChild")),r.subscribe(this.containerId+"-removeChild",l.hitch(this,"onRemoveChild")),r.subscribe(this.containerId+"-selectChild",l.hitch(this,"onSelectChild")),r.subscribe(this.containerId+"-containerKeyDown",l.hitch(this,"onContainerKeyDown")));this.containerNode.dojoClick=!0;this.own(h(this.containerNode,"click",
l.hitch(this,function(b){var a=e.getEnclosingWidget(b.target);if(a!=this.containerNode&&!a.disabled&&a.page)for(b=b.target;b!==this.containerNode;b=b.parentNode)if(p.contains(b,this.buttonWidgetCloseClass)){this.onCloseButtonClick(a.page);break}else if(b==a.domNode){this.onButtonClick(a.page);break}})))},onStartup:function(b){this.textDir=b.textDir;k.forEach(b.children,this.onAddChild,this);if(b.selected)this.onSelectChild(b.selected);var a=e.byId(this.containerId).containerNode,g=l.hitch(this,"pane2button");
b={title:"label",showtitle:"showLabel",iconclass:"iconClass",closable:"closeButton",tooltip:"title",disabled:"disabled",textdir:"textdir"};var c=function(b,c){return h(a,"attrmodified-"+b,function(b){var a=g(b.detail&&b.detail.widget&&b.detail.widget.id);a&&a.set(c,b.detail.newValue)})},d;for(d in b)this.own(c(d,b[d]))},destroy:function(b){this.destroyDescendants(b);this.inherited(arguments)},onAddChild:function(b,a){var g=new (l.isString(this.buttonWidget)?l.getObject(this.buttonWidget):this.buttonWidget)({id:this.id+
"_"+b.id,name:this.id+"_"+b.id,label:b.title,disabled:b.disabled,ownerDocument:this.ownerDocument,dir:b.dir,lang:b.lang,textDir:b.textDir||this.textDir,showLabel:b.showTitle,iconClass:b.iconClass,closeButton:b.closable,title:b.tooltip,page:b});this.addChild(g,a);b.controlButton=g;if(!this._currentChild)this.onSelectChild(b);g=b._wrapper.getAttribute("aria-labelledby")?b._wrapper.getAttribute("aria-labelledby")+" "+g.id:g.id;b._wrapper.removeAttribute("aria-label");b._wrapper.setAttribute("aria-labelledby",
g)},onRemoveChild:function(b){this._currentChild===b&&(this._currentChild=null);var a=this.pane2button(b.id);a&&(this.removeChild(a),a.destroy());delete b.controlButton},onSelectChild:function(b){if(b){if(this._currentChild){var a=this.pane2button(this._currentChild.id);a.set("checked",!1);a.focusNode.setAttribute("tabIndex","-1")}a=this.pane2button(b.id);a.set("checked",!0);this._currentChild=b;a.focusNode.setAttribute("tabIndex","0");e.byId(this.containerId)}},onButtonClick:function(a){var c=this.pane2button(a.id);
m.focus(c.focusNode);this._currentChild&&this._currentChild.id===a.id&&c.set("checked",!0);e.byId(this.containerId).selectChild(a)},onCloseButtonClick:function(a){e.byId(this.containerId).closeChild(a);this._currentChild&&(a=this.pane2button(this._currentChild.id))&&m.focus(a.focusNode||a.domNode)},adjacent:function(a){if(!this.isLeftToRight()&&(!this.tabPosition||/top|bottom/.test(this.tabPosition)))a=!a;var c=this.getChildren(),g=k.indexOf(c,this.pane2button(this._currentChild.id)),d=c[g],u;do g=
(g+(a?1:c.length-1))%c.length,u=c[g];while(u.disabled&&u!=d);return u},onkeydown:function(a,c){if(!this.disabled&&!a.altKey){var g=null;if(a.ctrlKey||!a._djpage){switch(a.keyCode){case n.LEFT_ARROW:case n.UP_ARROW:a._djpage||(g=!1);break;case n.PAGE_UP:a.ctrlKey&&(g=!1);break;case n.RIGHT_ARROW:case n.DOWN_ARROW:a._djpage||(g=!0);break;case n.PAGE_DOWN:a.ctrlKey&&(g=!0);break;case n.HOME:for(var d=this.getChildren(),u=0;u<d.length;u++){var e=d[u];if(!e.disabled){this.onButtonClick(e.page);break}}a.stopPropagation();
a.preventDefault();break;case n.END:d=this.getChildren();for(u=d.length-1;0<=u;u--)if(e=d[u],!e.disabled){this.onButtonClick(e.page);break}a.stopPropagation();a.preventDefault();break;case n.DELETE:case 87:if(this._currentChild.closable&&(a.keyCode==n.DELETE||a.ctrlKey))this.onCloseButtonClick(this._currentChild),a.stopPropagation(),a.preventDefault();break;case n.TAB:a.ctrlKey&&(this.onButtonClick(this.adjacent(!a.shiftKey).page),a.stopPropagation(),a.preventDefault())}null!==g&&(this.onButtonClick(this.adjacent(g).page),
a.stopPropagation(),a.preventDefault())}}},onContainerKeyDown:function(a){a.e._djpage=a.page;this.onkeydown(a.e)}});f.StackButton=s;return f})},"dijit/layout/ScrollingTabController":function(){define("dojo/_base/array dojo/_base/declare dojo/dom-class dojo/dom-geometry dojo/dom-style dojo/_base/fx dojo/_base/lang dojo/on dojo/query dojo/sniff ../registry dojo/text!./templates/ScrollingTabController.html dojo/text!./templates/_ScrollingTabControllerButton.html ./TabController ./utils ../_WidgetsInTemplateMixin ../Menu ../MenuItem ../form/Button ../_HasDropDown dojo/NodeList-dom ../a11yclick".split(" "),
function(k,f,p,s,n,l,h,r,m,e,t,a,d,c,b,w,g,v,u,G){a=f("dijit.layout.ScrollingTabController",[c,w],{baseClass:"dijitTabController dijitScrollingTabController",templateString:a,useMenu:!0,useSlider:!0,tabStripClass:"",_minScroll:5,_setClassAttr:{node:"containerNode",type:"class"},buildRendering:function(){this.inherited(arguments);var a=this.domNode;this.scrollNode=this.tablistWrapper;this._initButtons();this.tabStripClass||(this.tabStripClass="dijitTabContainer"+this.tabPosition.charAt(0).toUpperCase()+
this.tabPosition.substr(1).replace(/-.*/,"")+"None",p.add(a,"tabStrip-disabled"));p.add(this.tablistWrapper,this.tabStripClass)},onStartup:function(){this.inherited(arguments);n.set(this.domNode,"visibility","");this._postStartup=!0;this.own(r(this.containerNode,"attrmodified-label, attrmodified-iconclass",h.hitch(this,function(a){this._dim&&this.resize(this._dim)})))},onAddChild:function(a,b){this.inherited(arguments);n.set(this.containerNode,"width",n.get(this.containerNode,"width")+200+"px")},
onRemoveChild:function(a,b){var g=this.pane2button(a.id);this._selectedTab===g.domNode&&(this._selectedTab=null);this.inherited(arguments)},_initButtons:function(){this._btnWidth=0;this._buttons=m("\x3e .tabStripButton",this.domNode).filter(function(a){if(this.useMenu&&a==this._menuBtn.domNode||this.useSlider&&(a==this._rightBtn.domNode||a==this._leftBtn.domNode))return this._btnWidth+=s.getMarginSize(a).w,!0;n.set(a,"display","none");return!1},this)},_getTabsWidth:function(){var a=this.getChildren();
if(a.length){var b=a[this.isLeftToRight()?0:a.length-1].domNode,a=a[this.isLeftToRight()?a.length-1:0].domNode;return a.offsetLeft+a.offsetWidth-b.offsetLeft}return 0},_enableBtn:function(a){var b=this._getTabsWidth();a=a||n.get(this.scrollNode,"width");return 0<b&&a<b},resize:function(a){this._dim=a;this.scrollNode.style.height="auto";var g=this._contentBox=b.marginBox2contentBox(this.domNode,{h:0,w:a.w});g.h=this.scrollNode.offsetHeight;s.setContentSize(this.domNode,g);g=this._enableBtn(this._contentBox.w);
this._buttons.style("display",g?"":"none");this._leftBtn.region="left";this._rightBtn.region="right";this._menuBtn.region=this.isLeftToRight()?"right":"left";b.layoutChildren(this.domNode,this._contentBox,[this._menuBtn,this._leftBtn,this._rightBtn,{domNode:this.scrollNode,region:"center"}]);this._selectedTab&&(this._anim&&"playing"==this._anim.status()&&this._anim.stop(),this.scrollNode.scrollLeft=this._convertToScrollLeft(this._getScrollForSelectedTab()));this._setButtonClass(this._getScroll());
this._postResize=!0;return{h:this._contentBox.h,w:a.w}},_getScroll:function(){return this.isLeftToRight()||8>e("ie")||e("trident")&&e("quirks")||e("webkit")?this.scrollNode.scrollLeft:n.get(this.containerNode,"width")-n.get(this.scrollNode,"width")+(e("trident")||e("edge")?-1:1)*this.scrollNode.scrollLeft},_convertToScrollLeft:function(a){if(this.isLeftToRight()||8>e("ie")||e("trident")&&e("quirks")||e("webkit"))return a;var b=n.get(this.containerNode,"width")-n.get(this.scrollNode,"width");return(e("trident")||
e("edge")?-1:1)*(a-b)},onSelectChild:function(a,b){var g=this.pane2button(a.id);if(g){var c=g.domNode;if(c!=this._selectedTab&&(this._selectedTab=c,this._postResize)){var d=this._getScroll();d>c.offsetLeft||d+n.get(this.scrollNode,"width")<c.offsetLeft+n.get(c,"width")?(c=this.createSmoothScroll(),b&&(c.onEnd=function(){g.focus()}),c.play()):b&&g.focus()}this.inherited(arguments)}},_getScrollBounds:function(){var a=this.getChildren(),b=n.get(this.scrollNode,"width"),g=n.get(this.containerNode,"width")-
b,c=this._getTabsWidth();if(a.length&&c>b)return{min:this.isLeftToRight()?0:a[a.length-1].domNode.offsetLeft,max:this.isLeftToRight()?a[a.length-1].domNode.offsetLeft+a[a.length-1].domNode.offsetWidth-b:g};a=this.isLeftToRight()?0:g;return{min:a,max:a}},_getScrollForSelectedTab:function(){var a=this._selectedTab,b=n.get(this.scrollNode,"width"),g=this._getScrollBounds(),a=a.offsetLeft+n.get(a,"width")/2-b/2;return a=Math.min(Math.max(a,g.min),g.max)},createSmoothScroll:function(a){if(0<arguments.length){var b=
this._getScrollBounds();a=Math.min(Math.max(a,b.min),b.max)}else a=this._getScrollForSelectedTab();this._anim&&"playing"==this._anim.status()&&this._anim.stop();var g=this,c=this.scrollNode,d=new l.Animation({beforeBegin:function(){this.curve&&delete this.curve;var b=c.scrollLeft,u=g._convertToScrollLeft(a);d.curve=new l._Line(b,u)},onAnimate:function(a){c.scrollLeft=a}});this._anim=d;this._setButtonClass(a);return d},_getBtnNode:function(a){for(a=a.target;a&&!p.contains(a,"tabStripButton");)a=a.parentNode;
return a},doSlideRight:function(a){this.doSlide(1,this._getBtnNode(a))},doSlideLeft:function(a){this.doSlide(-1,this._getBtnNode(a))},doSlide:function(a,b){if(!b||!p.contains(b,"dijitTabDisabled")){var g=0.75*n.get(this.scrollNode,"width")*a,g=this._getScroll()+g;this._setButtonClass(g);this.createSmoothScroll(g).play()}},_setButtonClass:function(a){var b=this._getScrollBounds();this._leftBtn.set("disabled",a<=b.min);this._rightBtn.set("disabled",a>=b.max)}});d=f("dijit.layout._ScrollingTabControllerButtonMixin",
null,{baseClass:"dijitTab tabStripButton",templateString:d,tabIndex:"",isFocusable:function(){return!1}});f("dijit.layout._ScrollingTabControllerButton",[u,d]);f("dijit.layout._ScrollingTabControllerMenuButton",[u,G,d],{containerId:"",tabIndex:"-1",isLoaded:function(){return!1},loadDropDown:function(a){this.dropDown=new g({id:this.containerId+"_menu",ownerDocument:this.ownerDocument,dir:this.dir,lang:this.lang,textDir:this.textDir});var b=t.byId(this.containerId);k.forEach(b.getChildren(),function(a){var g=
new v({id:a.id+"_stcMi",label:a.title,iconClass:a.iconClass,disabled:a.disabled,ownerDocument:this.ownerDocument,dir:a.dir,lang:a.lang,textDir:a.textDir||b.textDir,onClick:function(){b.selectChild(a)}});this.dropDown.addChild(g)},this);a()},closeDropDown:function(a){this.inherited(arguments);this.dropDown&&(this._popupStateNode.removeAttribute("aria-owns"),this.dropDown.destroyRecursive(),delete this.dropDown)}});return a})},"widgets/AttributeTable/_ResourceManager":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/Deferred dojo/promise/all esri/lang jimu/portalUrlUtils ./table/_FeatureTable ./utils".split(" "),
function(k,f,p,s,n,l,h,r,m){return k(null,{_activeLayerInfoId:null,_activeRelationshipKey:null,nls:null,config:null,map:null,_delayedLayerInfos:[],_layerInfosFromMap:[],featureTableSet:{},relationshipsSet:{},relationshipTableSet:{},currentRelationshipKey:null,constructor:function(e){this.map=e&&e.map;this.nls=e&&e.nls;this._delayedLayerInfos=[];this._layerInfosFromMap=[];this.featureTableSet={};this.relationshipsSet={};this.relationshipTableSet={};this.currentRelationshipKey=null},setConfig:function(e){this.config=
f.clone(e||{})},setMap:function(e){this.map=e},updateLayerInfoResources:function(e){var h=new s;m.readConfigLayerInfosFromMap(this.map,!1,!0).then(f.hitch(this,function(a){this._layerInfosFromMap=a;this._processDelayedLayerInfos();e&&(0===this.config.layerInfos.length?(a=m.getConfigInfosFromLayerInfos(a),this.config.layerInfos=p.filter(a,function(a){return a.show})):this.config.layerInfos=p.filter(f.delegate(this.config.layerInfos),f.hitch(this,function(a){var c=this._getLayerInfoById(a.id);return a.show&&
c&&(a.name=c.name||c.title)})));h.resolve()}),function(a){h.reject(a)});return h},isEmpty:function(){return this.config&&this.config.layerInfos&&0>=this.config.layerInfos.length},getConfigInfos:function(){return f.clone(this.config.layerInfos)},addLayerInfo:function(e){0===this._layerInfosFromMap.length?this._delayedLayerInfos.push(e):0<this._layerInfosFromMap.length&&!this._getLayerInfoById(e.id)&&this._layerInfosFromMap.push(e)},addConfigInfo:function(e){this._getConfigInfoById(e.id)||(e=m.getConfigInfoFromLayerInfo(e),
this.config.layerInfos.push({id:e.id,name:e.name,layer:{url:e.layer.url,fields:e.layer.fields}}))},removeLayerInfo:function(e){e=this._getLayerInfoById(e);e=this._layerInfosFromMap.indexOf(e);this._layerInfosFromMap.splice(e,1)},removeConfigInfo:function(e){if(f.getObject("config.layerInfos",!1,this))for(var h=this.config.layerInfos.length,a=0;a<h;a++)if(this.config.layerInfos[a].id===e){this.featureTableSet[e]&&(this.featureTableSet[e].destroy(),delete this.featureTableSet[e]);this.config.layerInfos.splice(a,
1);break}},getQueryTable:function(e,h,a){var d=new s;this._activeLayerInfoId=e;this.featureTableSet[e]?d.resolve({isSupportQuery:!0,table:this.featureTableSet[e]}):this._getQueryTableInfo(e).then(f.hitch(this,function(c){if(c){var b=c.layerInfo,w=c.layerObject;c=c.tableInfo;if(this.featureTableSet[e])d.resolve({isSupportQuery:c.isSupportQuery,table:this.featureTableSet[e]});else if(f.getObject("isSupportQuery",!1,c)){var g=this._getConfigInfoById(e);g||(this.addConfigInfo(b),g=this._getConfigInfoById(e));
var v=f.getObject("layer.fields",!1,g);g.layer.fields=this._clipValidFields(v,w&&w.fields);b=new r({map:this.map,matchingMap:h,hideExportButton:a,layerInfo:b,configedInfo:g,nls:this.nls});this.featureTableSet[e]=b;d.resolve({isSupportQuery:c.isSupportQuery,table:b})}else d.resolve({isSupportQuery:!1})}else d.resolve(null)}),function(a){d.reject(a)});return d},getRelationTable:function(e,h,a,d){var c=new s,b=this.relationshipsSet[h];this._activeRelationshipKey=h;if(b){var w=this._getLayerInfoById(e);
e=f.getObject("shipInfo.id",!1,b);this.getQueryTable(e,a,d).then(f.hitch(this,function(a){if(a&&a.table){var d=a.table;d.set("relatedOriginalInfo",w);d.set("relationship",b)}c.resolve(a)}),f.hitch(function(){c.resolve(null)}))}else c.resolve(null);return c},removeRelationTable:function(e){this.relationshipTableSet[e]&&(this.relationshipTableSet[e].destroy(),this.relationshipTableSet[e]=null)},getCurrentTable:function(e){return this.featureTableSet[e]||this.relationshipTableSet[e]},collectRelationShips:function(e,
f){this._collectRelationShips(e,e.layerObject,f)},getConfigInfoById:function(e){return this._getConfigInfoById(e)},getLayerInfoById:function(e){return this._getLayerInfoById(e)},getRelationshipsByInfoId:function(e){var f=[],a;for(a in this.relationshipsSet){var d=this.relationshipsSet[a];d._layerInfoId===e&&f.push(d)}return f},empty:function(){this._delayedLayerInfos=[];this._layerInfosFromMap=[];this.featureTableSet={};for(var e in this.relationshipsSet)this.relationshipsSet[e].shipInfo=null;this.relationshipsSet=
{};this.relationshipTableSet={};this.nls=this.map=this.config=this.currentRelationshipKey=null},_processDelayedLayerInfos:function(){0<this._delayedLayerInfos.length&&(p.forEach(this._delayedLayerInfos,f.hitch(this,function(e){!this._getLayerInfoById(e&&e.id)&&(this.map&&this.map.getLayer(e.id))&&this._layerInfosFromMap.push(e)})),this._delayedLayerInfos=[])},_getLayerInfoById:function(e){for(var f=0,a=this._layerInfosFromMap.length;f<a;f++)if(this._layerInfosFromMap[f]&&this._layerInfosFromMap[f].id===
e)return this._layerInfosFromMap[f]},_getConfigInfoById:function(e){if(!f.getObject("layerInfos.length",!1,this.config))return null;for(var h=0,a=this.config.layerInfos.length;h<a;h++){var d=this.config.layerInfos[h];if(d&&d.id===e)return d}return null},_getQueryTableInfo:function(e){var h=new s,a=this._getLayerInfoById(e);if(a){var d=[],c=a.getUrl();d.push(a.getLayerObject());d.push(a.getSupportTableInfo());c&&d.push(a.getRelatedTableInfoArray());n(d).then(f.hitch(this,function(b){if(this._activeLayerInfoId!==
e||!b)h.resolve(null);else{var d=b[0],g=b[1];b=c?b[2]:[];l.isDefined(b)&&(l.isDefined(d)&&0<b.length)&&this._collectRelationShips(a,d,b);h.resolve({layerInfo:a,layerObject:d,tableInfo:g})}}),function(a){h.reject(a)})}else console.error("no activeLayerInfo!"),h.reject(Error());return h},_collectRelationShips:function(e,m,a){var d=m.relationships;if(d&&0<d.length&&m&&m.url){var c=m.url.split("/");p.forEach(d,f.hitch(this,function(b){c[c.length-1]=b.relatedTableId;var d=c.join("/"),g=p.filter(a,f.hitch(this,
function(a){a=a.getUrl();return l.isDefined(a)&&l.isDefined(d)&&h.removeProtocol(a.toString().toLowerCase())===h.removeProtocol(d.toString().toLowerCase())}));g&&0<g.length&&(b.shipInfo=g[0]);g=e.id+"_"+b.name+"_"+b.id;b._relKey=g;b._layerInfoId=e.id;this.relationshipsSet[g]||(this.relationshipsSet[g]=b,this.relationshipsSet[g].objectIdField=m.objectIdField)}))}},_getLayerInfoLabel:function(e){return e.name||e.title},_getLayerInfoId:function(e){return e&&e.id||""},_clipValidFields:function(e,f){if(!e||
!e.length)return f||[];if(!f||!f.length)return e;for(var a=[],d=0,c=e.length;d<c;d++)for(var b=e[d],h=0,g=f.length;h<g;h++)if(f[h].name===b.name){a.push(b);break}return a}})})},"widgets/AttributeTable/table/_FeatureTable":function(){define("dojo/_base/declare dojo/_base/html dijit/_WidgetBase jimu/dijit/Popup jimu/dijit/Message jimu/dijit/Filter dgrid/OnDemandGrid ../dgrid/Selection dgrid/extensions/ColumnHider dgrid/extensions/ColumnResizer dgrid/extensions/ColumnReorder dijit/Menu dijit/MenuItem dijit/Toolbar dijit/form/Button dijit/DropDownMenu dijit/form/ToggleButton dijit/form/DropDownButton dojo/Deferred dojo/when dojo/Evented dojo/touch dojo/store/Memory esri/config esri/lang esri/request esri/tasks/RelationParameters esri/tasks/RelationshipQuery esri/layers/FeatureLayer esri/tasks/QueryTask esri/tasks/query esri/tasks/ProjectParameters esri/graphic esri/geometry/Point esri/geometry/Multipoint esri/geometry/Polyline esri/geometry/Polygon esri/symbols/SimpleLineSymbol esri/symbols/SimpleFillSymbol esri/Color esri/geometry/normalizeUtils dojo/_base/lang dojo/on dojo/aspect dojo/_base/array jimu/dijit/LoadingIndicator jimu/dijit/FieldStatistics jimu/SelectionManager jimu/CSVUtils jimu/utils ../utils dojo/query".split(" "),
function(k,f,p,s,n,l,h,r,m,e,t,a,d,c,b,w,g,v,u,G,I,D,E,y,B,N,K,O,H,F,A,C,X,Y,P,Z,$,aa,ba,ca,Q,q,z,R,x,S,T,U,V,W,J,L){return k([p,I],{baseClass:"jimu-widget-attributetable-feature-table",_defaultFeatureCount:2E3,_defaultBatchCount:25,_batchCount:0,_filterObj:null,_currentDef:null,_requestStatus:"initial",map:null,matchingMap:!1,layerInfo:null,configedInfo:null,footerHeight:25,layer:null,loading:null,grid:null,footer:null,selectedRowsLabel:null,selectionRows:null,nls:null,_dblClickResult:null,actived:!1,
showSelected:!1,tableCreated:!1,_relatedQuery:!1,_relatedQueryIds:null,_selectionHandles:null,_selectionResults:null,constructor:function(a){a=a||{};this.set("map",a.map||null);this.set("matchingMap",!!a.matchingMap);this.set("layerInfo",a.layerInfo||null);this.set("layer",a.layer||null);this.set("configedInfo",a.configedInfo||null);this.set("relatedOriginalInfo",a.relatedOriginalInfo||null);this.set("relationship",a.relationship||null);this.set("syncSelection",!!a.syncSelection||!0)},postCreate:function(){this.inherited(arguments);
this._relatedQueryIds=[];this.createToolbar();this.loading=new S;this.loading.placeAt(this.domNode);this.selectionManager=U.getInstance();this._selectionResults=[];this.selectionRows=[];f.setAttr(this.domNode,"data-layerinfoid",q.getObject("layerInfo.id",!1,this));this.get("map")&&(this.own(z(this.map.root,D.release,q.hitch(this,function(){this._clickMap=!0}))),this.own(z(this.map,"extent-change",q.hitch(this,"_onExtentChange"))))},startup:function(){this.inherited(arguments);this.toolbarHeight=parseInt(f.getStyle(this.toolbar.domNode,
"height"),10)||0},setLayerDefinition:function(a){this._layerDefinition=a},getLayerDefinition:function(){return this._getLayerDifinition()},getFilterableFields:function(){if(this._layerDefinition&&this.configedInfo){var a=q.clone(this._layerDefinition);return this._getFilterableFields(a.fields,this.configedInfo.layer.fields)}return[]},getFilterObj:function(){return this._filterObj},setFilterObj:function(a){this._filterObj=a},showRefreshing:function(a){a?this.loading.show():this.loading.hide()},active:function(){this.actived=
!0},deactive:function(){this.actived=!1},cancelThread:function(){"fulfilled"!==this._requestStatus&&this._currentDef&&(this._currentDef.cancel({canceledBySelf:!0}),this._requestStatus="canceled")},isCanceled:function(){return"canceled"===this._requestStatus},createToolbar:function(){var a=new c({},f.create("div")),u=new w;this.showSelectedRecordsMenuItem=new d({label:this.nls.showSelectedRecords,iconClass:"esriAttributeTableSelectPageImage",onClick:q.hitch(this,this.toggleSelectedRecords)});u.addChild(this.showSelectedRecordsMenuItem);
this.showRelatedRecordsMenuItem=new d({label:this.nls.showRelatedRecords,iconClass:"esriAttributeTableSelectAllImage",onClick:q.hitch(this,this.onShowRelatedRecordsClick)});u.addChild(this.showRelatedRecordsMenuItem);this.filterMenuItem=new d({label:this.nls.filter,iconClass:"esriAttributeTableFilterImage",onClick:q.hitch(this,this.onFilterMenuItemClick)});u.addChild(this.filterMenuItem);this.toggleColumnsMenuItem=new d({label:this.nls.columns,iconClass:"esriAttributeTableColumnsImage",onClick:q.hitch(this,
this.onToggleColumnsClick)});u.addChild(this.toggleColumnsMenuItem);this.hideExportButton||(this.exportCSVMenuItem=new d({label:this.nls.exportFiles,showLabel:!0,iconClass:"esriAttributeTableExportImage",onClick:q.hitch(this,this.onExportCSVClick)}),u.addChild(this.exportCSVMenuItem));this.selectionMenu=new v({label:this.nls.options,iconClass:"esriAttributeTableOptionsImage",dropDown:u});a.addChild(this.selectionMenu);this.matchingCheckBox=new g({checked:this.matchingMap?!0:!1,showLabel:!0,label:this.nls.filterByExtent,
onChange:q.hitch(this,function(a){this.set("matchingMap",a);this._onMatchingCheckBoxChange(a)})});a.addChild(this.matchingCheckBox);this.zoomButton=new b({label:this.nls.zoomto,iconClass:"esriAttributeTableZoomImage",onClick:q.hitch(this,this.zoomTo)});a.addChild(this.zoomButton);this.clearSelectionButton=new b({label:this.nls.clearSelection,iconClass:"esriAttributeTableClearImage",onClick:q.hitch(this,this.clearSelection,!0,!0)});a.addChild(this.clearSelectionButton);this.refreshButton=new b({label:this.nls.refresh,
showLabel:!0,iconClass:"esriAttributeTableRefreshImage",onClick:q.hitch(this,this.refresh)});a.addChild(this.refreshButton);f.place(a.domNode,this.domNode);this.toolbar=a;this.own(z(this,"data-loaded,row-click,clear-selection",q.hitch(this,"changeToolbarStatus")))},startQuery:function(a){this.cancelThread();this._requestStatus="processing";this.loading.show();!a||!a.length?(this._relatedQuery=!1,this._relatedQueryIds=[],this.queryByStoreObjectIds=null):this.queryByStoreObjectIds=a;this._currentDef=
this._getLayerObject();this._currentDef.then(q.hitch(this,function(b){this.domNode&&(this.layer=b,(b=!this.layerInfo.isTable&&this.matchingMap&&this.map.extent||null)&&b.spatialReference&&b.spatialReference.isWebMercator()?(this._currentDef=Q.normalizeCentralMeridian([b],null,q.hitch(this,function(a){return a[0]}))).then(q.hitch(this,function(b){this._doQuery(b,a)}),q.hitch(this,function(a){a&&"Request canceled"!==a.message&&console.error(a);this.changeToolbarStatus();this.loading.hide()})):this._doQuery(b,
a))}),q.hitch(this,function(a){console.error(a);this.changeToolbarStatus();this.loading.hide()}))},queryRecordsByRelationship:function(a){var b=a&&a.layer,g=a&&a.selectedIds;a&&a.relationship&&this.set("relationship",a.relationship);a&&a.relatedOriginalInfo&&this.set("relatedOriginalInfo",a.relatedOriginalInfo);var c=this.relationship;b&&c&&g&&0<g.length&&!W.isEqual(this._relatedQueryIds,g)&&q.getObject("relatedOriginalInfo.layerObject.url",!1,this)?(this.loading.show(),this._requestStatus="processing",
this._relatedQuery=!0,this.matchingCheckBox.set("checked",!1),this.cancelThread(),this._currentDef=this._getLayerObject(),this._currentDef.then(q.hitch(this,function(a){if(this.domNode){this.layer=a;var d=[],u=this.layer;x.forEach(u.fields,function(a){(!B.isDefined(a.show)||!0===a.show||"esriFieldTypeOID"===a.type||B.isDefined(u.objectIdField)&&a.name===u.objectIdField)&&d.push(a.name)});a=new O;a.objectIds=g;a.outFields=d.length?d:["*"];a.relationshipId=c.id;a.returnGeometry="esriGeometryPoint"===
this.layer.geometryType;(this._currentDef=b.queryRelatedFeatures(a,function(a){return a})).then(q.hitch(this,function(a){if(this.domNode){var b={displayFieldName:c.objectIdField,fields:u.fields,features:[],fieldAliases:null},d={},e=function(a){var g=a.attributes[this.layer.objectIdField];d[g]||(d[g]=!0,b.features.push(a))},v;for(v in a){var M=a[v];x.forEach(M&&M.features,e,this)}f.destroy(this.tipNode);0<b.features.length?(this.grid||(this._removeTable(),f.place(this.loading.domNode,this.domNode)),
a=this._getOutFieldsFromLayerInfos(this.layer.objectIdField),this.queryExecute(a,b.features.length,!1,b)):(this.tipNode=f.toDom("\x3cdiv\x3e"+this.nls.noRelatedRecords+"\x3c/div\x3e"),this._removeTable(),f.place(this.tipNode,this.domNode),f.place(this.loading.domNode,this.domNode));this._relatedQueryIds=g;this.emit("data-loaded");this.loading.hide()}}),q.hitch(this,function(a){a&&"Request canceled"!==a.message&&console.error(a);f.destroy(this.tipNode);this.tipNode=f.toDom("\x3cdiv\x3e"+this.nls.noRelatedRecords+
"\x3c/div\x3e");this._removeTable();f.place(this.tipNode,this.domNode);f.place(this.loading.domNode,this.domNode);this.loading.hide();this.changeToolbarStatus()}))}}),q.hitch(this,function(a){console.error(a);this.loading.hide();this.changeToolbarStatus()}))):this.loading.hide()},getSelectedRows:function(){return!this.tableCreated?[]:this.selectionRows},zoomTo:function(){this._zoomToSelected()},toggleSelectedRecords:function(){this._relatedQuery&&!this.showSelected&&0===this.getSelectedRows().length?
(this._relatedQuery=!1,this._relatedQueryIds=[],this.layerInfo&&!this.layerInfo.isTable&&this.matchingCheckBox.set("checked",!0),this.startQuery(),this.showSelectedRecordsMenuItem.set("label",this.nls.showSelectedRecords),this.showSelected=!1,this.emit("show-all-records",{layerInfoId:this.layerInfo.id})):this.tableCreated&&(this.showSelected?(this.showAllSelectedRecords(),this.showSelectedRecordsMenuItem.set("label",this.nls.showSelectedRecords),this.showSelected=!1,this.emit("show-all-records",{layerInfoId:this.layerInfo.id})):
(this.showSelectedRecords(),this.showSelectedRecordsMenuItem.set("label",this.nls.showAllRecords),this.showSelected=!0,this.emit("show-selected-records",{layerInfoId:this.layerInfo.id})))},onShowRelatedRecordsClick:function(){this.emit("show-related-records",{layerInfoId:this.layerInfo.id,objectIds:this.getSelectedRows()})},onFilterMenuItemClick:function(){this.showRefreshing(!0);this.getLayerDefinition().then(q.hitch(this,function(a){if(this.domNode){a=q.clone(a);var b=this.getFilterableFields();
a.fields=b;var g=new l({noFilterTip:this.nls.noFilterTip,style:"width:100%;margin-top:22px;"});this._filterPopup=new s({titleLabel:this.nls.filter,width:720,height:485,content:g,buttons:[{label:this.nls.ok,onClick:q.hitch(this,function(){var a=g.toJson();a&&a.expr?(this.setFilterObj(a),this.clearSelection(!1),this.startQuery(),this._filterPopup.close(),this._filterPopup=null,this.emit("apply-filter",{layerInfoId:this.layerInfo.id,expr:a.expr})):new n({message:this.nls.setFilterTip})})},{label:this.nls.cancel}]});
(b=this.getFilterObj())?g.buildByFilterObj(this.layer.url,b,a):g.buildByExpr(this.layer.url,null,a)}}),q.hitch(this,function(a){this.domNode&&console.error(a)})).always(q.hitch(this,function(){this.showRefreshing(!1)}));this.emit("show-filter",{layerInfoId:this.layerInfo.id})},onToggleColumnsClick:function(){this.toggleColumns();this.emit("toggle-columns",{layerInfoId:this.layerInfo.id})},onExportCSVClick:function(){var a=new n({message:this.nls.exportMessage,titleLabel:this.nls.exportFiles,autoHeight:!0,
buttons:[{label:this.nls.ok,onClick:q.hitch(this,function(){this.exportToCSV();a.close()})},{label:this.nls.cancel}]});this.emit("export-csv",{layerInfoId:this.layerInfo.id})},onSelectionComplete:function(a){var b=a.features;b&&(0===b.length?this.clearSelection(!1):this._selectBySelf(b)||(this.clearSelection(!1),this._updateSelectRowsByFeatures(a.features)))},changeToolbarStatus:function(){if(this.tableCreated){var a=this.getSelectedRows();this.showSelected?this.showSelectedRecordsMenuItem.set("label",
this.nls.showAllRecords):this.showSelectedRecordsMenuItem.set("label",this.nls.showSelectedRecords);this.tableCreated&&a&&0<a.length&&this.layer&&this.layer.objectIdField?(this.showSelectedRecordsMenuItem.set("disabled",!1),this.clearSelectionButton.set("disabled",!1)):(this.showSelectedRecordsMenuItem.set("disabled",!0),this.clearSelectionButton.set("disabled",!0));this._relatedQuery&&(this.showSelectedRecordsMenuItem.set("disabled",!1),this.tableCreated&&(a&&0===a.length)&&this.showSelectedRecordsMenuItem.set("label",
this.nls.showAllRecords));this.showRelatedRecordsMenuItem.set("disabled",!0);if(this.layerInfo&&this.isSupportQueryToServer()&&a&&0<a.length&&this.layer&&this.layer.objectIdField){this._relatedDef&&!this._relatedDef.isFulfilled()&&this._relatedDef.cancel();var b=this.layerInfo.getRelatedTableInfoArray();this._relatedDef=b;b.then(q.hitch(this,function(a){if(this.domNode){var b=this.getSelectedRows();this.tableCreated&&(a&&0<a.length&&b&&0<b.length)&&this.showRelatedRecordsMenuItem.set("disabled",!1)}}))}this.tableCreated&&
this.isSupportQueryToServer()&&!this._relatedQuery?this.filterMenuItem.set("disabled",!1):this.filterMenuItem.set("disabled",!0);this.matchingCheckBox.set("disabled",!1);this.tableCreated?this.toggleColumnsMenuItem.set("disabled",!1):this.toggleColumnsMenuItem.set("disabled",!0);this.hideExportButton||(a&&0<a.length?this.exportCSVMenuItem.set("label",this.nls.exportSelected):this.exportCSVMenuItem.set("label",this.nls.exportAll),this.tableCreated?this.exportCSVMenuItem.set("disabled",!1):this.exportCSVMenuItem.set("disabled",
!0));this.layerInfo.isShowInMap()?this.tableCreated&&a&&0<a.length?this.zoomButton.set("disabled",!1):this.zoomButton.set("disabled",!0):this.zoomButton.set("disabled",!0);this.layerInfo.isTable&&(this.matchingCheckBox.set("disabled",!0),this.zoomButton.set("disabled",!0))}else this._relatedQuery?(this.showSelectedRecordsMenuItem.set("disabled",!1),this.showSelectedRecordsMenuItem.set("label",this.nls.showAllRecords)):this.showSelectedRecordsMenuItem.set("disabled",!0),this.showRelatedRecordsMenuItem.set("disabled",
!0),this.matchingCheckBox.set("disabled",!0),this.filterMenuItem.set("disabled",!0),this.toggleColumnsMenuItem.set("disabled",!0),this.hideExportButton||this.exportCSVMenuItem.set("disabled",!0),this.zoomButton.set("disabled",!0)},showSelectedRecords:function(){if(this.tableCreated){var a=this.layer.objectIdField,b=this.getSelectedRows();0<b.length&&this.grid&&(this.grid.store instanceof E?this.grid.set("query",q.hitch(this,function(g){return"number"===typeof g&&-1<b.indexOf(g)||-1<b.indexOf(g[a])?
!0:!1})):this.grid.set("query",function(){return b}))}},showAllSelectedRecords:function(){if(this.tableCreated&&this.showSelected){this.grid.set("query",{});var a=this.getSelectedRows();this._updateSelectRowsByIds(a)}},clearSelection:function(a,b){this.tableCreated&&(this.grid.clearSelection(),this.selectionRows=[],a&&this.grid.set("query",{}),b&&(this.selectionManager.clearSelection(this.layer),this._selectionResults=[]),this._closePopup(),this.setSelectedNumber(),this.showSelected=!1,this.emit("clear-selection"))},
refresh:function(){this.grid&&this.grid.clearSelection();this._relatedQuery||this.startQuery();this.emit("refresh",{layerInfoId:this.layerInfo.id})},exportToCSV:function(a){if(this.layerInfo&&this.layer&&this.tableCreated){var b=null,b=this.layer.objectIdField,g=this.getSelectedRowsData(),b=this._getOutFieldsFromLayerInfos(b),b=this._processExecuteFields(this.layer.fields,b),c={};g&&0<g.length?c.datas=g:this.grid.store instanceof E&&(g=this.grid.store.data,c.datas=g);"datas"in c&&"esriGeometryPoint"===
this.layer.geometryType&&(g=q.clone(c.datas),x.forEach(g,function(a){var b=a.geometry;b&&"point"===b.type&&("x"in a?a._x=b.x:a.x=b.x,"y"in a?a._y=b.y:a.y=b.y);delete a.geometry}),c.datas=g,b=q.clone(b),g="",g=-1!==b.indexOf("x")?"_x":"x",b.push({name:g,alias:g,format:{digitSeparator:!1,places:6},show:!0,type:"esriFieldTypeDouble"}),g=-1!==b.indexOf("y")?"_y":"y",b.push({name:g,alias:g,format:{digitSeparator:!1,places:6},show:!0,type:"esriFieldTypeDouble"}));c.fromClient=!1;c.withGeometry="esriGeometryPoint"===
this.layer.geometryType;c.outFields=b;c.formatNumber=!1;c.formatDate=!0;c.formatCodedValue=!0;c.popupInfo=this.layerInfo.getPopupInfo();return V.exportCSVFromFeatureLayer(a||this.configedInfo.name,this.layer,c)}},toggleColumns:function(){this.tableCreated&&this.grid._toggleColumnHiderMenu()},changeHeight:function(a){this.grid&&0<=a-this.toolbarHeight-this.footerHeight&&f.setStyle(this.grid.domNode,"height",a-this.toolbarHeight-this.footerHeight+"px")},isSupportQueryToServer:function(){var a=this.layer&&
"esri.layers.CSVLayer"===this.layer.declaredClass,b=this.layer&&"esri.layers.StreamLayer"===this.layer.declaredClass;return this.layer&&this.layer.url&&this.configedInfo.layer.url&&!a&&!b},isSupportQueryOnClient:function(){var a=this.layer&&"esri.layers.CSVLayer"===this.layer.declaredClass,b=this.layer&&"esri.layers.StreamLayer"===this.layer.declaredClass;return!(this.layer&&this.layer.url&&this.configedInfo.layer.url)||a||b},destroy:function(){this._destroyed||(this.layer=this.configedInfo=this.layerInfo=
null,this._selectionHandles&&x.forEach(this._selectionHandles,function(a){a&&a.remove&&a.remove()}),this._closePopup(),this._filterPopup&&this._filterPopup.domNode&&(this._filterPopup.close(),this._filterPopup=null),this._dblClickResult=null,this.grid&&this.grid.destroy(),this.relationship=this.nls=this.map=null,this._currentDef&&!this._currentDef.isFulfilled()&&this._currentDef.cancel({canceledBySelf:!0}),this._relatedDef&&!this._relatedDef.isFulfilled()&&this._relatedDef.cancel({canceledBySelf:!0}),
this.inherited(arguments))},_selectBySelf:function(a){a=a||[];return a.length!==this._selectionResults.length?!1:x.every(this._selectionResults,function(b){return-1<a.indexOf(b)})},_updateSelectRowsByFeatures:function(a){a=x.map(a,q.hitch(this,function(a){return a.attributes[this.layer.objectIdField]}));this._updateSelectRowsByIds(a)},_updateSelectRowsByIds:function(a){this.grid&&this.tableCreated&&(this.selectionRows=a,x.forEach(a,q.hitch(this,function(a){this.grid.select(a)})),this.setSelectedNumber(),
this.changeToolbarStatus())},_removeTable:function(){this.grid&&this.grid.domNode&&(this.grid.destroy(),this.grid=null);this.footer&&(f.destroy(this.footer),this.selectedRowsLabel=this.footer=null);this.tableCreated=!1},_onMatchingCheckBoxChange:function(a){this.tableCreated&&!this._relatedQuery&&(this.cancelThread(),this.queryByStoreObjectIds=null,this.startQuery());if("fulfilled"===this._requestStatus&&this.tableCreated&&this._relatedQuery)if(a)this.queryByStoreObjectIds=x.map(this.grid.store.data,
q.hitch(this,function(a){return a[this.layer.objectIdField]})),this.startQuery(this.queryByStoreObjectIds);else{var b=this._relatedQueryIds;this._relatedQueryIds=[];this.queryRecordsByRelationship({layer:this.relatedOriginalInfo.layerObject,selectedIds:b})}a||(this._currentExtent=null)},_closePopup:function(){var a=this.map.infoWindow.getSelectedFeature(),b=a&&this._dblClickResult&&a===this._dblClickResult,a=a&&a._layer===this.layer;if(this.domNode&&(b||a))this.map.infoWindow.hide(),this._dblClickResult=
null},_getLayerObject:function(){function a(b){this._selectionHandles&&x.forEach(this._selectionHandles,function(a){a&&a.remove&&a.remove()});this._selectionHandles=[];this._selectionHandles.push(z(b,"selection-complete",q.hitch(this,"onSelectionComplete")))}return(this._currentDef=this.layerInfo.getLayerObject()).then(q.hitch(this,function(b){var g=new u;"esri.layers.ArcGISImageServiceLayer"===b.declaredClass||"esri.layers.ArcGISImageServiceVectorLayer"===b.declaredClass?(b=new H(b.url),this.own(z(b,
"load",q.hitch(this,function(b){q.hitch(this,a)(b.layer);g.resolve(b.layer)})))):(q.hitch(this,a)(b),g.resolve(b));return g}))},_getLayerDifinition:function(){return this._layerDefinition?G(q.clone(this._layerDefinition)):N({url:this.layer.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(q.hitch(this,function(a){this.setLayerDefinition(a);return this.getLayerDefinition()}))},_getFilterableFields:function(a,b){return x.filter(a,function(a){return x.some(b,function(b){return a.name===
b.name&&(b.show||!B.isDefined(b.show))&&q.mixin(a,b)})})},_doQuery:function(a,b){if(this.layer){var g=this.layer.objectIdField;this.isSupportQueryToServer()?this._queryToServer(a,g,b):this.isSupportQueryOnClient()&&this._queryOnClient(a,g,b)}},_queryOnClient:function(a,b,g){var c={};c.features="esri.layers.StreamLayer"===this.layer.declaredClass?this.layer.getLatestObservations():this.layer.graphics;g&&0<g.length&&(c.features=x.filter(c.features,function(a){return-1<g.indexOf(a.attributes[this.layer.objectIdField])},
this));var d=this.layer.fields,u=this.configedInfo.layer.fields;c.fields=u?x.filter(u,q.hitch(this,function(a){B.isDefined(a.show)||(a.show=!0);if(a.name===b&&("esriFieldTypeOID"===a.type||"esriFieldTypeInteger"===a.type))a._pk=!0;for(var g=0,c=d.length;g<c;g++)d[g].name===a.name&&!a.type&&(a.type=d[g].type);return a.show||a._pk})):x.filter(d,q.hitch(this,function(a){B.isDefined(a.show)||(a.show=!0);if(a.name===b&&("esriFieldTypeOID"===a.type||"esriFieldTypeInteger"===a.type))a._pk=!0;return a.show||
a._pk}));for(var u=[],e=c.features.length,v=0;v<e;v++)c&&(c.features&&c.features[v]&&c.features[v].geometry)&&u.push(c.features[v].geometry);a&&y.defaults.geometryService&&0<u.length?(e=new K,e.geometries1=u,e.geometries2=[a],e.relation=K.SPATIAL_REL_INTERSECTION,(this._currentDef=y.defaults.geometryService.relation(e,q.hitch(this,function(a){return a}))).then(q.hitch(this,function(b,g){for(var c=g.length,d=[],u=0;u<c;u++)d.push(b.features[g[u].geometry1Index]);b.features=d;this.queryExecute(b.fields,
b.features.length,!1,b,a)},c),q.hitch(this,function(a){a&&"Request canceled"!==a.message&&console.error(a);this.changeToolbarStatus();this.loading.hide()}))):this.queryExecute(c.fields,c.features.length,!1,c,a)},_queryToServer:function(a,b,g){this._getFeatureCount(a,g).then(q.hitch(this,function(c){if(this.domNode)if(g)this._queryFeatureLayer(a,b,c,!1,g);else{var d=this.layer,u=B.isDefined(d.maxRecordCount)?d.maxRecordCount:1E3;this._batchCount=Math.min(u,this._defaultBatchCount);if(c<=u||!this.layer.objectIdField)this._queryFeatureLayer(a,
b,c,!1);else{var e=this._getOutFieldsFromLayerInfos(b),v={fields:this.layer.fields};this.layer._recordCounts=c;d.advancedQueryCapabilities&&d.advancedQueryCapabilities.supportsPagination?this.queryExecute(e,c,!0,v,a):this._getFeatureIds(b,a).then(q.hitch(this,function(b){this.domNode&&(this.layer._objectIds=b,this.queryExecute(e,c,!0,v,a))}),q.hitch(this,function(a){console.error(a);this.changeToolbarStatus()}))}}}),q.hitch(this,function(a){console.error(a);this.changeToolbarStatus()}))},_getFeatureCount:function(a,
b){var g=new u,c=new A;c.returnGeometry=!1;c.where=this._getLayerFilterExpression();b&&(c.where+=" AND "+this.layer.objectIdField+" IN ("+b.join()+")");a&&(c.geometry=a);(this._currentDef=this.layer.queryCount(c)).then(q.hitch(this,function(a){g.resolve(a)}),q.hitch(this,function(a){a&&"Request canceled"!==a.message&&(console.error(a),console.log("Could not get feature count."));this.loading.hide();g.reject(a)}));return g},_queryFeatureLayer:function(a,b,g,c,d){var u=new F(this.configedInfo.layer.url),
e=new A;e.where=this._getLayerFilterExpression();d&&b&&(e.where+=" AND "+b+" IN ("+d.join()+")");var v=this._getOutFieldsFromLayerInfos(b);0<v.length?(d=x.map(v,function(a){return a.name}),e.outFields=d):e.outFields=["*"];a&&(e.geometry=a,e.spatialRelationship=A.SPATIAL_REL_INTERSECTS);e.outSpatialReference=q.clone(this.map.spatialReference);e.returnGeometry="esriGeometryPoint"===this.layer.geometryType;b&&(e.orderByFields=[b+" ASC"]);(this._currentDef=u.execute(e,q.hitch(this,function(a){return a}))).then(q.hitch(this,
function(b){this.queryExecute(v,g,c,b,a)}),q.hitch(this,function(a){a&&"Request canceled"!==a.message&&console.error(a);this.changeToolbarStatus();this.loading.hide()}))},_getFeatureIds:function(a,b){var g=new u,c=new A;c.returnGeometry=!1;c.returnIdsOnly=!0;c.where=this._getLayerFilterExpression();if(this.layer._orderByFields||a)c.orderByFields=this.layer._orderByFields||[a+" ASC"];b&&(c.geometry=b);(this._currentDef=this.layer.queryIds(c)).then(q.hitch(this,function(a){g.resolve(a)}),q.hitch(this,
function(a){a&&"Request canceled"!==a.message&&(console.error(a),console.log("Could not get feature Ids"));g.resolve([])}));return g},queryExecute:function(a,b,g,c,d){var u=[],u=null,e={};if(this.domNode){c.fields=this._processExecuteFields(this.layer.fields,a);g?u=J.generateCacheStore(this.layer,b,this._batchCount,this._getLayerFilterExpression(),d):(u=x.map(c.features,q.hitch(this,function(a){var b=q.clone(a.attributes);return q.mixin(b,{geometry:a.geometry})})),u=J.generateMemoryStore(u,this.layer.objectIdField));
a=this.layer.typeIdField;var e=this.layer.types,v=q.getObject("advancedQueryCapabilities.supportsOrderBy",!1,this.layer),y=q.getObject("advancedQueryCapabilities.supportsPagination",!1,this.layer),h=q.getObject("advancedQueryCapabilities.supportsStatistics",!1,this.layer),e=J.generateColumnsFromFields(this.layerInfo.getPopupInfo(),c.fields,a,e,v&&y||!g,h);g=20+100*c.fields.length<f.getMarginBox(this.domNode).w;this.createTable(e,u,b,g);this._currentExtent=d;b=this.layer.getSelectedFeatures();this.selectionRows&&
0<this.selectionRows.length?this._updateSelectRowsByIds(this.selectionRows):b&&0<b.length?this._updateSelectRowsByFeatures(b):this.grid.clearSelection();this.changeToolbarStatus();this.emit("data-loaded")}},createTable:function(a,b,g,c){if(this.grid)this.grid.set("store",b),this.grid.set("columns",a),this.grid.refresh();else{var d={};d.columns=a;d.store=b;d.keepScrollPosition=!0;d.pagingDelay=1E3;d.allowTextSelection=!0;d.deselectOnRefresh=!1;this.layer.objectIdField||(d.minRowsPerPage=this.layer.maxRecordCount||
1E3,d.maxRowsPerPage=this.layer.maxRecordCount||1E3,d.selectionMode="none");this.grid=new (k([h,r,m,e,t]))(d,f.create("div"));f.place(this.grid.domNode,this.domNode);this.grid.startup();this.tipNode&&f.destroy(this.tipNode);this.own(z(this.ownerDocument,"keydown",q.hitch(this,function(a){this.grid&&(this.grid.allowTextSelection&&a.shiftKey)&&this.grid._setAllowTextSelection(!1)})));this.own(z(this.ownerDocument,"keyup",q.hitch(this,function(){this.grid&&!this.grid.allowTextSelection&&this.grid._setAllowTextSelection(!0)})));
this.layer.objectIdField&&(this.own(z(this.grid,".dgrid-header .dgrid-cell:click",q.hitch(this,this._onHeaderClick))),this.own(z(this.grid,"dgrid-columnstatechange",q.hitch(this,this._onColumnStateChange))),this.own(z(this.grid,".selection-handle-column:click",q.hitch(this,this._onSelectionHandleClick))),this.own(z(this.grid,".dgrid-row:dblclick",q.hitch(this,this._onDblclickRow))),this.own(z(this.grid,"dgrid-sort",q.hitch(this,function(a){this.emit("sort",a)}))),a=this.map.getLayer(this.layer.id),
this.syncSelection&&a&&this.own(z(a,"click",q.hitch(this,this._onFeaturelayerClick))))}this.layer.objectIdField&&this.grid.set("sort",this.layer.objectIdField,!1);this.getParent()&&(a=L(".dgrid-scroller",this.grid.domNode)[0],d=L(".dgrid-header",this.grid.domNode)[0],b=f.getComputedStyle(a),d=f.getMarginBox(d),b=parseInt(b.marginTop,10),isFinite(b)&&(d&&b<d.h)&&f.setStyle(a,"marginTop",d.h+"px"));c?f.addClass(this.domNode,"auto-width"):f.removeClass(this.domNode,"auto-width");this.footer?f.empty(this.footer):
this.footer=f.create("div",{"class":"jimu-widget-attributetable-feature-table-footer"},this.domNode);g=f.create("div",{"class":"dgrid-status self-footer",innerHTML:g+"\x26nbsp;"+(this.layerInfo.isTable?this.nls.records:this.nls.features)+"\x26nbsp;"},this.footer);this.selectedRowsLabel=f.create("div",{"class":"dgrid-status self-footer",innerHTML:"0\x26nbsp;"+this.nls.selected+"\x26nbsp;",style:{display:this.layer.objectIdField?"":"none"}},g,"after");g=f.getStyle(this.domNode,"height");this.changeHeight(g);
this._requestStatus="fulfilled";this.tableCreated=!0;f.place(this.loading.domNode,this.grid.domNode);this.loading.hide()},getSelectedRowsData:function(){if(!this.grid)return null;var a=this.layer.objectIdField,b=this.grid.store,g=b._entityData||b.data,b=this.getSelectedRows();return x.map(b,q.hitch(this,function(b){for(var c=0,d=g.length;c<d;c++)if(g[c]&&g[c][a]===b)return g[c];return{}}))||[]},setSelectedNumber:function(){if(this.selectedRowsLabel&&this.grid){var a=this.getSelectedRows(),b=0;if(this.grid.store instanceof
E){var g=x.map(this.grid.store.data,function(a){return a[this.layer.objectIdField]},this);x.forEach(a,function(a){-1<g.indexOf(a)&&b++})}else b=a.length;this.selectedRowsLabel.innerHTML="\x26nbsp;\x26nbsp;"+b+" "+this.nls.selected+"\x26nbsp;\x26nbsp;"}},_setSelection:function(a){this._selectionResults=a=a||[];this.selectionManager.setSelection(this.layer,a)},_zoomToExtentByFeatures:function(a){return this.getExtent(a).then(q.hitch(this,function(a){if(a&&this.domNode){var b=null;"point"===a.type?(b=
15,b=-1<this.map.getMaxZoom()?this.map.getMaxZoom():0.1,b=this.map.centerAndZoom(a,b)):b=this.map.setExtent(a.expand(1.1));return b.then(function(){return a})}}))},_showMapInfoWindowByFeatures:function(a,b){if(b&&0!==b.length&&this.domNode){var g=this.map.infoWindow,c=this.layerInfo.isPopupEnabled()&&this.layerInfo.getInfoTemplate();if(g&&g.setFeatures&&1===b.length&&c){x.forEach(b,q.hitch(this,function(a){a._layer=this.layerInfo.layerObject;a.setInfoTemplate(c)}));g.setFeatures(b);var d=null,d="point"===
a.type?b[0].geometry:a.getCenter();g.show(d,{closetFirst:!0});this._dblClickResult=b[0];this.syncWithMapInfowindow(this._dblClickResult)}}},selectFeatures:function(a,b){b&&0<b.length?("rowclick"===a||"selectall"===a?this._setSelection(b):("zoom"===a||"row-dblclick"===a)&&this._zoomToExtentByFeatures(b).then(q.hitch(this,function(g){"row-dblclick"===a&&this.domNode&&this._showMapInfoWindowByFeatures(g,b)}),q.hitch(this,function(a){a&&"Request canceled"!==a.message&&console.error(a)})),this.setSelectedNumber()):
this._popupMessage(this.nls.dataNotAvailable)},syncWithMapInfowindow:function(a){var b=this.map.infoWindow,g=q.isArray(a)?a:[a];z.once(b,"hide",q.hitch(this,function(){c&&c.remove&&(c.remove(),c=null)}));var c=R.after(b,"show",q.hitch(this,function(){var a=b.getSelectedFeature(),a=a&&g[0]===a,d=b.features.indexOf(g[0]);!a&&-1<d?b.select(d):this.domNode&&!a&&(c&&c.remove)&&(c.remove(),c=null)}))},getGraphicsFromLocalFeatureLayer:function(a){for(var b=[],g,c,d=a.length,u=this.layer.graphics.length,
e=this.layer.objectIdField,v=0;v<d;v++)for(var f=0;f<u;f++)if(g=this.layer.graphics[f].attributes[e]+"",c=a[v]+"",g===c){b.push(this.layer.graphics[f]);break}return b},getExtent:function(a){var b=new u,g,c,d=a.length;if(1===d&&a[0].geometry&&"point"===a[0].geometry.type)g=a[0].geometry;else{if(1===d&&!a[0].geometry)return b.reject(Error("AttributeTable.getExtent:: extent was not projected.")),b;for(var e=0;e<d;e++)a[e].geometry?"point"===a[e].geometry.type?(c||(c=new P(a[e].geometry.spatialReference)),
c.addPoint(a[e].geometry),e===d-1&&(g=c.getExtent())):g=g?g.union(a[e].geometry.getExtent()):a[e].geometry.getExtent():console.error("unable to get geometry of the reocord: ",a[e])}if(!g||!g.spatialReference)return b.reject(Error("AttributeTable.getExtent:: extent was not projected.")),b;a=this.map.spatialReference;g.spatialReference.equals(a)?b.resolve(g):(c=new C,c.geometries=[g],c.outSR=a,y.defaults.geometryService.project(c,q.hitch(this,function(a){this.domNode&&(a&&a.length?b.resolve(a[0]):b.reject(Error("AttributeTable.getExtent:: extent was not projected.")))}),
q.hitch(this,function(a){a||(a=Error("AttributeTable.getExtent:: extent was not projected."));b.reject(a)})));return b},_onFeaturelayerClick:function(a,b){if(this.actived){var g=q.getObject("graphic",!1,a),c=q.getObject("graphic.attributes",!1,a);c&&(g&&g._layer===this.layer)&&((g=this.map.infoWindow.getSelectedFeature())&&(g._layer===this.layer&&!b)&&this.map.infoWindow.hide(),c=c[this.layer.objectIdField],this.showSelected&&this.toggleSelectedRecords(),this._getIndexOfIdInGrid(c).then(q.hitch(this,
function(b){-1!==b&&(this.grid.scrollTo({x:0,y:this.grid.rowHeight*b}),this.map.infoWindow.features&&(b=this.map.infoWindow.features.indexOf(a.graphic),this.map.infoWindow.select(b)),z.once(this.map.infoWindow,"selection-change",q.hitch(this,function(){var b=this.map.infoWindow.getSelectedFeature(),g=q.getObject("_layer",!1,b);b===a.graphic||g!==this.layer||this._onFeaturelayerClick({graphic:b},!0)})),this.syncWithMapInfowindow(a.graphic))})))}},_getIndexOfIdInGrid:function(a){var b=new u,g=-1,c=
q.getObject("store.objectIds",!1,this.grid),g=null,g=this.grid.get("sort")[0];if(this._relatedQuery)return b.resolve(-1),b;if(this.grid.store instanceof E)a=this.grid.store.get(a),c=this.grid.store.data,a?g&&g.attribute&&B.isDefined(g.descending)?(c=q.clone(c),g=function(a,b){return function(g,c){return g[a]===c[a]?0:g[a]<c[a]?b?1:-1:b?-1:1}}(g.attribute,g.descending),c.sort(g),c=x.map(c,function(a){return a[this.layer.objectIdField]},this),g=c.indexOf(a[this.layer.objectIdField])):g=c.indexOf(a):
g=-1,b.resolve(g);else if(c&&0<c.length)g=c.indexOf(a),b.resolve(g);else{c=new A;c.returnGeometry=!1;c.where=this._getLayerFilterExpression()+" AND "+this.layer.objectIdField+" \x3c "+a;if(g&&(g.attribute!==this.layer.objectIdField||g.descending))return b.resolve(-1),b;this.matchingMap&&(!this._relatedQuery&&this._currentExtent)&&(c.geometry=this._currentExtent);(this._currentDef=this.layer.queryCount(c)).then(q.hitch(this,function(a){b.resolve(a)}),q.hitch(this,function(a){b.reject(a)}))}return b},
_zoomToSelected:function(){if(this.configedInfo&&this.tableCreated){var a=this.getSelectedRows();this._goToFeatures(a,"zoom")}},_goToFeatures:function(a,b){if(0!==a.length){var g=this.getGraphicsFromLocalFeatureLayer(a);this.isSupportQueryToServer()&&a.length!==g.length?this._queryFeaturesByIds(a,b):this.selectFeatures(b,g)}},_onDblclickRow:function(a){this.layerInfo&&this.layerInfo.isShowInMap()&&(a=[this.grid.row(a).id],this._goToFeatures(a,"row-dblclick"))},_queryFeaturesByIds:function(a,b){var g=
new A;g.objectIds=a;g.returnGeometry=!0;g.outSpatialReference=q.clone(this.map.spatialReference);g.outFields=["*"];var c=this.layer,d="esri.layers.CSVLayer"===c.declaredClass;c.url&&!d?(new F(c.url)).execute(g,q.hitch(this,function(a){this.selectFeatures(b,a.features)}),q.hitch(this,this._errorSelectFeatures)):c.selectFeatures(g,H.SELECTION_NEW,q.hitch(this,this.selectFeatures,b),q.hitch(this,this._errorSelectFeatures))},_onHeaderClick:function(a){var b=this.grid.cell(a);this._showColumnMenu(b.column,
b,a.target,{x:a.pageX,y:a.pageY})},_showColumnMenu:function(b,g,c,u){var e=q.getObject("_cache",!1,b);if(e){var v=new a({});f.addClass(v.domNode,"jimu-widget-attributetable-feature-menu");var y=this;if(e.sortable){var h=["iconSortAscending","iconSortDescending"];x.forEach([this.nls.sortAsc,this.nls.sortDes],function(a,g){var c=new d({label:a,iconClass:h[g],baseClass:"menuItemClass",onClick:function(){0===g?y.grid.set("sort",b.field,!1):1===g&&y.grid.set("sort",b.field,!0)}});v.addChild(c)})}e.statistics&&
(e=new d({label:this.nls.statistics,iconClass:"iconTableStatistics",baseClass:"menuItemClass",onClick:q.hitch(this,function(){var a={layer:this.layer,filterExpression:this._getLayerFilterExpression(),fieldNames:[b.field]};this.matchingMap&&(a.geometry=this._currentExtent);if(this.showSelected){var g=this._getSelectedIds();a.filterExpression+=" AND "+this.layer.objectIdField+" IN ("+g.join()+")"}else this.queryByStoreObjectIds&&0<this.queryByStoreObjectIds.length&&(a.filterExpression+=" AND "+this.layer.objectIdField+
" IN ("+this.queryByStoreObjectIds.join()+")");this.fieldStatistics=new T;this.fieldStatistics.showContentAsPopup(a)})}),v.addChild(e));e=v.getChildren();v.startup();v._openMyself({target:c,delegatedTarget:g,iframe:null,coords:u});this.own(z(v,"Close",q.hitch(this,function(){var a=this.get("columnMenu");a&&(a.destroyRecursive(),this.set("columnMenu",null))})));this.set("columnMenu",v);1>e.length&&z.emit(v,"Close")}},_onColumnStateChange:function(a){if(a&&a.grid&&a.grid.columns){var b=0,g;for(g in a.grid.columns)a.grid.columns[g].hidden||
b++;20+100*b-1<f.getMarginBox(this.domNode).w?f.addClass(this.domNode,"auto-width"):f.removeClass(this.domNode,"auto-width")}},_onSelectionHandleClick:function(){var a=this._getSelectedIds();this.selectionRows=a;this._closePopup();this.layerInfo.isTable||(0<a.length?this._goToFeatures(a,"rowclick"):this._setSelection([]));this.setSelectedNumber();this.emit("row-click",{table:this,selectedIds:a})},_onExtentChange:function(a){var b=q.getObject("delta.x",!1,a),g=q.getObject("delta.y",!1,a);a=this._clickMap&&
!a.levelChange?isFinite(b)&&isFinite(g)&&(0<Math.abs(b)||0<Math.abs(g)):!0;this._clickMap=!1;a&&this.matchingMap&&(this.actived&&this.layerInfo&&!this.layerInfo.isTable)&&this.startQuery(this.queryByStoreObjectIds)},_getLayerFilterExpression:function(){var a=this.layerInfo.getFilter();return a?a:"1\x3d1"},_getOutFieldsFromLayerInfos:function(a){var b=this.configedInfo.layer.fields,g=[];b&&x.forEach(b,q.hitch(this,function(b){B.isDefined(b.show)||(b.show=!0);if(b.name===a&&("esriFieldTypeOID"===b.type||
"esriFieldTypeInteger"===b.type||!b.type))b._pk=!0;(b.show||b._pk)&&g.push(b)}));return g},_processExecuteFields:function(a,b){if(a&&0<a.length){var g=[];if(!b.length)return a;for(var c=0,d=b.length;c<d;c++)for(var u=0;u<a.length;u++)if(b[c].name===a[u].name&&(b[c].type===a[u].type||!b[c].type))a[u]=q.mixin(a[u],b[c]),g.push(a[u]);return g}return b},_getSelectedIds:function(){var a=[],b=this.grid.selection,g;for(g in b)b[g]&&(isFinite(g)?a.push(parseInt(g,10)):a.push(g));return a},_errorSelectFeatures:function(a){console.error(a)},
_popupMessage:function(a){var b=new n({message:a,buttons:[{label:this.nls.ok,onClick:q.hitch(this,function(){b.close()})}]});this.loading.hide()}})})},"jimu/dijit/Filter":function(){define("dojo/Evented dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/Filter.html jimu/filterUtils jimu/utils dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/aspect dojo/query dojo/Deferred esri/request ./_SingleFilter ./_FilterSet ./LoadingIndicator".split(" "),
function(k,f,p,s,n,l,h,r,m,e,t,a,d,c,b,w,g,v){return f([p,s,n,h,k],{templateString:l,baseClass:"jimu-filter",declaredClass:"jimu.dijit.Filter",nls:null,_validOptions:!1,_layerDefinition:null,_def:null,noFilterTip:"",enableAskForValues:!1,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;var a=this.nls.matchMsg.split("${any_or_all}");this.nls.strMatchMsgPart1=a[0]||"";this.nls.strMatchMsgPart2=a[1]||"";this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this.noFilterTip&&
"string"===typeof this.noFilterTip&&(this.noFilterTipSection.innerHTML=this.noFilterTip)},reset:function(){this.isBuilding()||(this.removeAllFilters(),this.url=null,this.isHosted=!1,this.partsObj=this.expr=this._layerDefinition=null)},isBuilding:function(){return this._def&&!this._def.isFulfilled()},buildByExpr:function(a,g,c){var d=new b;this.isBuilding()?d.reject("Filter is already building."):(this._def=null,this.reset(),this.url=a,this.isHosted=r.isHostedService(this.url),this.expr=g||"1\x3d1",
this._layerDefinition=c,d=this._def=this._init("expr"));return d},buildByFilterObj:function(a,g,c){var d=new b;this.isBuilding()?d.reject("Filter is already building."):(this._def=null,this.reset(),this.url=a,this.isHosted=r.isHostedService(this.url),this.partsObj=g,this._layerDefinition=c,d=this._def=this._init("partsObj"));return d},removeAllFilters:function(){this._destroyAllFilters()},_validateLayerDefinition:function(a){return this._isObject(a)},_init:function(g){var c=new b;if(!this._isString(this.url))return c.reject(),
c;var d=e.hitch(this,function(){setTimeout(e.hitch(this,function(){c.resolve()}),1500)}),v=e.hitch(this,function(){t.setStyle(this.contentSection,"display","block");t.setStyle(this.errorSection,"display","none");this.removeAllFilters();var b=this._layerDefinition.fields;b&&0<b.length?(b=a.filter(b,e.hitch(this,function(a){return 0<=this._supportFieldTypes.indexOf(a.type)})))&&0<b.length?(this._validOptions=!0,t.removeClass(this.btnAddSet,"jimu-state-disabled"),t.removeClass(this.btnAddExp,"jimu-state-disabled"),
t.removeClass(this.iconAddExp,"jimu-state-disabled"),t.removeClass(this.iconAddSet,"jimu-state-disabled"),this.createFieldsStore(),"expr"===g?this._isString(this.expr)?("1\x3d1"===this.expr.replace(/\s/gi,"")&&this.removeAllFilters(),this._parseExpr(this.expr)?d():c.reject()):c.reject():"partsObj"===g?this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),d()):c.reject():this._validatePartsObj(this.partsObj)?(this._parsePartsObj(this.partsObj),d()):this._isString(this.expr)?this._parseExpr(this.expr)?
d():c.reject():(this.removeAllFilters(),d())):(this._showErrorOptions(this.nls.error.noFilterFields),c.reject()):c.reject()});this._validateLayerDefinition(this._layerDefinition)?v():(this.loading.show(),w({url:this.url,content:{f:"json"},handleAs:"json",callbackParamName:"callback"}).then(e.hitch(this,function(a){this.domNode?(this.loading.hide(),this._layerDefinition=a,v()):c.reject()}),e.hitch(this,function(a){console.error(a);c.reject();this.domNode&&this.loading.hide()})));return c},toJson:function(){var b=
{logicalOperator:this.allAnySelect.value,parts:[]},g=this._getAllSingleFiltersAndFilterSets();if(0===g.length)return b.expr="1\x3d1",b;a.forEach(g,e.hitch(this,function(a){a=a.toJson();b.parts.push(a)}));return a.every(b.parts,e.hitch(this,function(a){return!!a}))&&0<b.parts.length?(b.expr=this.getExprByFilterObj(b),b):null},createFieldsStore:function(){if(!this._layerDefinition.fields||0===this._layerDefinition.fields.length)this._showErrorOptions(this.nls.error.noFilterFields);else{var a=e.clone(this._layerDefinition).fields;
0===this.setFieldsStoreByFieldInfos(a)&&this._showErrorOptions(this.nls.error.noFilterFields)}},_parsePartsObj:function(a){this._validatePartsObj(a)&&(this.removeAllFilters(),this._buildEditUIByPartsObj(a))},_parseExpr:function(a){this._destroyAllFilters();var b=null;if(!this._validateLayerDefinition(this._layerDefinition))return b;if(!a||"string"!==typeof a)return this._showErrorOptions(this.nls.error.invalidSQL),b;if("1\x3d1"===this.expr.replace(/\s/gi,""))return b={expr:"1\x3d1",parts:[],logicalOperator:"AND"};
try{b=this.getFilterObjByExpr(a)}catch(g){b=null,console.error(g)}b?this._buildEditUIByPartsObj(b):this._showErrorOptions(this.nls.error.cantParseSQL);return b},_buildEditUIByPartsObj:function(b){b&&(this._destroyAllFilters(),this.allAnySelect.value=b.logicalOperator,a.forEach(b.parts,e.hitch(this,function(a){a.parts?this._addFilterSet(a):a.fieldObj&&(a.operator&&a.valueObj)&&this._addSingleFilter(a)})))},_addSingleFilter:function(a){a={url:this.url,layerInfo:this._layerDefinition,stringFieldType:this._stringFieldType,
dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,part:a,OPERATORS:e.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,isHosted:this.isHosted};a=new g(a);a.placeAt(this.allExpsBox);a.startup();this.own(d.after(a,"_destroySelf",e.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_addFilterSet:function(a){a={url:this.url,layerInfo:this._layerDefinition,stringFieldType:this._stringFieldType,dateFieldType:this._dateFieldType,numberFieldTypes:this._numberFieldTypes,
partsObj:a,OPERATORS:e.mixin({},this.OPERATORS),enableAskForValues:this.enableAskForValues,isHosted:this.isHosted};a=new v(a);a.placeAt(this.allExpsBox);a.startup();this.own(d.after(a,"_destroySelf",e.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_destroyAllFilters:function(){for(var a=this._getAllSingleFiltersAndFilterSets();0<a.length;)a[0].destroy(),a.splice(0,1);this._checkFilterNumbers()},_getAllSingleFiltersAndFilterSetsDoms:function(){return c(".allExpsBox\x3e.jimu-single-filter,.allExpsBox\x3e.jimu-filter-set",
this.contentSection)},_getAllSingleFiltersAndFilterSets:function(){var b=this._getAllSingleFiltersAndFilterSetsDoms();return a.map(b,e.hitch(this,function(a){return m.byNode(a)}))},_checkFilterNumbers:function(){var b=this._getAllSingleFiltersAndFilterSetsDoms();1<b.length?t.setStyle(this.matchMsg,"display","block"):t.setStyle(this.matchMsg,"display","none");0<b.length?t.setStyle(this.noFilterTipSection,"display","none"):t.setStyle(this.noFilterTipSection,"display","block");a.forEach(b,e.hitch(this,
function(a,b){t.removeClass(a,"even-filter");t.removeClass(a,"odd-filter");t.addClass(a,0===(b+1)%2?"even-filter":"odd-filter")}));this.emit("filter-number-change")},_showErrorOptions:function(a){console.error(a);t.setStyle(this.errorSection,"display","none");this.errorTip.innerHTML=a;this.loading.hide()},_onBtnAddSetClick:function(){this._layerDefinition&&this._validOptions&&this._addFilterSet()},_onBtnAddExpClick:function(){this._layerDefinition&&this._validOptions&&this._addSingleFilter()}})})},
"jimu/dijit/_SingleFilter":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_SingleFilter.html dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/store/Memory jimu/utils jimu/dijit/CheckBox dijit/form/Select dijit/form/FilteringSelect dijit/form/ValidationTextBox dijit/form/DateTextBox dijit/form/NumberTextBox".split(" "),function(k,f,p,s,n,l,h,r,m,e,t){return k([f,p,s],{templateString:n,baseClass:"jimu-single-filter",
declaredClass:"jimu.dijit._SingleFilter",nls:null,url:null,layerInfo:null,stringFieldType:"",dateFieldType:"",numberFieldTypes:[],supportFieldTypes:[],part:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,postMixInProperties:function(){this.supportFieldTypes=[];this.supportFieldTypes.push(this.stringFieldType);this.supportFieldTypes.push(this.dateFieldType);this.supportFieldTypes=this.supportFieldTypes.concat(this.numberFieldTypes);this.nls=window.jimuNls.filterBuilder;this.nls.caseSensitive||
(this.nls.caseSensitive="Case Sensitive")},postCreate:function(){this.inherited(arguments);this._initSelf()},toJson:function(){var a=null,d=this._isUseAskForValues(),c=this._getSelectedFilteringItem(this.fieldsSelect);if(!c)return null;a={fieldObj:"",operator:"",valueObj:"",interactiveObj:"",caseSensitive:!1};if(d){if(!this.promptTB.validate())return this._showValidationErrorTip(this.promptTB),null;a.interactiveObj={prompt:this.promptTB.get("value"),hint:this.hintTB.get("value"),cascade:!1};this.uniqueRadio&&
(this.uniqueRadio.checked&&this.cbxCascade.getValue())&&(a.interactiveObj.cascade=!0)}a.fieldObj={name:c.name,label:c.name,shortType:c.shortType,type:c.type};if("none"===this.operatorsSelect.get("value"))return null;a.operator=this.operatorsSelect.get("value");a.valueObj={isValid:!0,type:""};var b=c.shortType;if(this.valueRadio.checked)if(a.valueObj.type="value","string"===b)if(a.operator===this.OPERATORS.stringOperatorIsBlank||a.operator===this.OPERATORS.stringOperatorIsNotBlank)a.valueObj.value=
null;else if(this._isFieldCoded(c)&&a.operator===this.OPERATORS.stringOperatorIs){if(!this.stringCodedValuesFS.validate())return this._showValidationErrorTip(this.stringCodedValuesFS),null;d=this._getSelectedFilteringItem(this.stringCodedValuesFS);a.valueObj.value=d?d.code:""}else{if(!this.stringTextBox.validate())return this._showValidationErrorTip(this.stringTextBox),null;a.valueObj.value=this.stringTextBox.get("value")}else if("number"===b)if(a.operator===this.OPERATORS.numberOperatorIsBlank||
a.operator===this.OPERATORS.numberOperatorIsNotBlank)a.valueObj.value=null;else if(a.operator===this.OPERATORS.numberOperatorIsBetween||a.operator===this.OPERATORS.numberOperatorIsNotBetween){if(!this.numberTextBox1.validate())return this._showValidationErrorTip(this.numberTextBox1),null;if(!this.numberTextBox2.validate())return this._showValidationErrorTip(this.numberTextBox2),null;a.valueObj.value1=this._getValueForNumberTextBox(this.numberTextBox1);a.valueObj.value2=this._getValueForNumberTextBox(this.numberTextBox2);
a.valueObj.isValid=t.isValidNumber(a.valueObj.value1)&&t.isValidNumber(a.valueObj.value2)}else{if(this._isFieldCoded(c)&&a.operator===this.OPERATORS.numberOperatorIs){if(!this.numberCodedValuesFS.validate())return this._showValidationErrorTip(this.numberCodedValuesFS),null;d=this._getSelectedFilteringItem(this.numberCodedValuesFS);a.valueObj.value=d?parseFloat(d.code):null}else{if(!this.numberTextBox.validate())return this._showValidationErrorTip(this.numberTextBox),null;a.valueObj.value=this._getValueForNumberTextBox(this.numberTextBox)}a.valueObj.isValid=
t.isValidNumber(a.valueObj.value)}else{if("date"===b)if(a.operator===this.OPERATORS.dateOperatorIsBlank||a.operator===this.OPERATORS.dateOperatorIsNotBlank)a.valueObj.value=null;else if(a.operator===this.OPERATORS.dateOperatorIsBetween||a.operator===this.OPERATORS.dateOperatorIsNotBetween){if(!this.dateTextBox1.validate())return this._showValidationErrorTip(this.dateTextBox1),null;if(!this.dateTextBox2.validate())return this._showValidationErrorTip(this.dateTextBox2),null;a.valueObj.value1=this.dateTextBox1.get("value").toDateString();
a.valueObj.value2=this.dateTextBox2.get("value").toDateString()}else{if(!this.dateTextBox.validate())return this._showValidationErrorTip(this.dateTextBox),null;a.valueObj.value=this.dateTextBox.get("value").toDateString()}}else if(this.fieldRadio.checked){d=this._getSelectedFilteringItem(this.fieldsSelect2);if(!d)return this._showValidationErrorTip(this.fieldsSelect2),null;a.valueObj.value=d.name;a.valueObj.label=d.name;a.valueObj.type="field"}else if(this.uniqueRadio&&this.uniqueRadio.checked)if(a.valueObj.type=
"unique",c=this._getSelectedFilteringItem(this.uniqueValuesSelect))"string"===b?a.valueObj.value=c.value:"number"===b&&(a.valueObj.value=parseFloat(c.value));else if(d)"string"===b?a.valueObj.value="":"number"===b&&(a.valueObj.value=null,a.valueObj.isValid=!1);else return this._showValidationErrorTip(this.uniqueValuesSelect),null;if("string"===b)switch(a.operator){case this.OPERATORS.stringOperatorStartsWith:case this.OPERATORS.stringOperatorEndsWith:case this.OPERATORS.stringOperatorContains:case this.OPERATORS.stringOperatorDoesNotContain:a.caseSensitive=
this.cbxCaseSensitive.getValue()}return a},showDelteIcon:function(){h.setStyle(this.btnDelete,"display","inline-block")},hideDeleteIcon:function(){h.setStyle(this.btnDelete,"display","none")},_showCaseSensitive:function(){h.setStyle(this.cbxCaseSensitive.domNode,"display","inline-block")},_hideCaseSensitive:function(){h.setStyle(this.cbxCaseSensitive.domNode,"display","none")},_getProcessedString:function(a){return t.isNotEmptyString(a,!0)?a:""},_getProcessedNumber:function(a){return t.isValidNumber(a)?
a:null},_setValueForStringTextBox:function(a,d){d=this._getProcessedString(d);a.set("value",d)},_setValueForNumberTextBox:function(a,d){t.isValidNumber(d)&&a.set("value",d)},_getValueForNumberTextBox:function(a){a=a.get("value");return this._getProcessedNumber(a)},_initSelf:function(){this.isHosted&&(this.cbxCaseSensitive.setValue(!1),this.cbxCaseSensitive.setStatus(!1),this.cbxCaseSensitive.domNode.title=this.nls.notSupportCaseSensitiveTip);this.own(m(this.cbxAskValues,"status-change",l.hitch(this,
this._onCbxAskValuesStatusChanged)));this.cbxAskValues.onChange=l.hitch(this,this._onCbxAskValuesClicked);this.own(m(this.fieldsSelect,"MouseEnter",l.hitch(this,this._updateFieldsSelectTitle)));this.own(m(this.operatorsSelect,"MouseEnter",l.hitch(this,this._updateOperatorsSelectTitle)));this.own(m(this.dateTextBox1,"MouseEnter",l.hitch(this,this._updateDateTextBox1Title)));this.own(m(this.dateTextBox2,"MouseEnter",l.hitch(this,this._updateDateTextBox2Title)));var a=new e({idProperty:"id",data:[]});
this.uniqueValuesSelect.set("store",a);this.enableAskForValues?(h.setStyle(this.cbxAskValues.domNode,"display","inline-block"),h.setStyle(this.promptSection,"display","block")):(h.setStyle(this.cbxAskValues.domNode,"display","none"),h.setStyle(this.promptSection,"display","none"));this.layerInfo=l.mixin({},this.layerInfo);this._initRadios();this.layerInfo.currentVersion&&parseFloat(this.layerInfo.currentVersion);this._isServiceSupportDistinctValues(this.url,this.layerInfo)||(h.destroy(this.uniqueTd),
this.uniqueRadio=null);if((a=this.layerInfo.fields)&&0<a.length)a=r.filter(a,l.hitch(this,function(a){return 0<=this.supportFieldTypes.indexOf(a.type)})),this._enableRadios(),this._initFieldsSelect(a);this.cbxCascade.setLabel(window.jimuNls.filterBuilder.cascadeFilterTip);h.addClass(this.cbxCascade.domNode,"cascade-checkbox")},_isServiceSupportDistinctValues:function(a,d){return this._isStreamServer(a)?!1:10.1<=parseFloat(d.currentVersion)},_isStreamServer:function(a){a=(a||"").replace(/\/*$/g,"");
return/\/StreamServer$/gi.test(a)},_isImageServer:function(a){a=(a||"").replace(/\/*$/g,"");return/\/ImageServer$/gi.test(a)},_updateFieldsSelectTitle:function(){this.fieldsSelect.domNode.title="";var a=this._getSelectedFilteringItem(this.fieldsSelect);a&&(this.fieldsSelect.domNode.title=a.displayName||a.alias||a.name)},_updateOperatorsSelectTitle:function(){this.operatorsSelect.domNode.title="";var a=this.operatorsSelect.get("value");a&&(a=this.operatorsSelect.getOptions(a),this.operatorsSelect.domNode.title=
a.label)},_updateDateTextBox1Title:function(){var a=this.dateTextBox1.get("displayedValue")||"";this.dateTextBox1.domNode.title=a},_updateDateTextBox2Title:function(){var a=this.dateTextBox2.get("displayedValue")||"";this.dateTextBox2.domNode.title=a},_showValidationErrorTip:function(a){try{!a.validate()&&a.domNode&&a.focusNode&&(a.focusNode.focus(),a.focusNode.blur())}catch(d){console.error(d)}},_focusValidationTextBox:function(a){try{a&&a.focusNode&&a.focusNode.focus()}catch(d){console.error(d)}},
_isFieldCoded:function(a){return(a=a.domain)&&"codedValue"===a.type&&a.codedValues&&0<a.codedValues.length},_getSelectedFilteringItem:function(a){if(a.validate()){var d=a.get("item");if(d)return d}this._showValidationErrorTip(a);return null},_getShortTypeByFieldType:function(a){return a===this.stringFieldType?"string":a===this.dateFieldType?"date":0<=this.numberFieldTypes.indexOf(a)?"number":null},_getOperatorsByShortType:function(a){var d=[];"string"===a?d=[this.OPERATORS.stringOperatorIs,this.OPERATORS.stringOperatorIsNot,
this.OPERATORS.stringOperatorStartsWith,this.OPERATORS.stringOperatorEndsWith,this.OPERATORS.stringOperatorContains,this.OPERATORS.stringOperatorDoesNotContain,this.OPERATORS.stringOperatorIsBlank,this.OPERATORS.stringOperatorIsNotBlank]:"number"===a?d=[this.OPERATORS.numberOperatorIs,this.OPERATORS.numberOperatorIsNot,this.OPERATORS.numberOperatorIsAtLeast,this.OPERATORS.numberOperatorIsLessThan,this.OPERATORS.numberOperatorIsAtMost,this.OPERATORS.numberOperatorIsGreaterThan,this.OPERATORS.numberOperatorIsBetween,
this.OPERATORS.numberOperatorIsNotBetween,this.OPERATORS.numberOperatorIsBlank,this.OPERATORS.numberOperatorIsNotBlank]:"date"===a&&(d=[this.OPERATORS.dateOperatorIsOn,this.OPERATORS.dateOperatorIsNotOn,this.OPERATORS.dateOperatorIsBefore,this.OPERATORS.dateOperatorIsAfter,this.OPERATORS.dateOperatorIsBetween,this.OPERATORS.dateOperatorIsNotBetween,this.OPERATORS.dateOperatorIsBlank,this.OPERATORS.dateOperatorIsNotBlank]);return d},_initFieldsSelect:function(a){a=r.map(a,l.hitch(this,function(a,b){var d=
l.mixin({},a);d.id=b;d.shortType=this._getShortTypeByFieldType(a.type);d.alias||(d.alias=d.name);var g="";"string"===d.shortType?g=this.nls.string:"number"===d.shortType?g=this.nls.number:"date"===d.shortType&&(g=this.nls.date);d.displayName=d.alias+" ("+g+")";return d}));if(0<a.length){var d=new e({data:a});this.fieldsSelect.set("store",d);this.fieldsSelect.set("value",a[0].id)}this.fieldsSelect.focusNode.focus();this.fieldsSelect.focusNode.blur();this._onFieldsSelectChange();this.part&&this._showPart(this.part)},
_showPart:function(a){if((this.part=a)&&this.part.fieldObj&&this.part.operator&&this.part.valueObj){a=this.part.fieldObj.name;var d=this.part.operator;this.part.caseSensitive=!!this.part.caseSensitive;a=this.fieldsSelect.store.query({name:a});if(0!==a.length&&(a=a[0]))this.fieldsSelect.set("value",a.id),setTimeout(l.hitch(this,function(){this.domNode&&(this._onFieldsSelectChange(),this.operatorsSelect.set("value",d),setTimeout(l.hitch(this,function(){this.domNode&&this._resetByFieldAndOperation(this.part)}),
50),setTimeout(l.hitch(this,function(){if(this.domNode){var a=this.part.interactiveObj;a&&(this.cbxAskValues.check(),this._updatePrompt(),this.promptTB.set("value",a.prompt||""),this.hintTB.set("value",a.hint||""),"unique"===this.part.valueObj.type&&a.cascade?this.cbxCascade.check():this.cbxCascade.uncheck())}}),100))}),0)}},_onFieldsSelectChange:function(){this._updateFieldsSelectTitle();this.operatorsSelect.removeOption(this.operatorsSelect.getOptions());this.operatorsSelect.addOption({value:"none",
label:this.nls.none});this.valueRadio.checked=!0;var a=this._getSelectedFilteringItem(this.fieldsSelect);a&&(this.operatorsSelect.shortType=a.shortType,a=this._getOperatorsByShortType(a.shortType),this.operatorsSelect.removeOption(this.operatorsSelect.getOptions()),r.forEach(a,l.hitch(this,function(a){this.operatorsSelect.addOption({value:a,label:this.nls[a]})})));this._onOperatorsSelectChange()},_onOperatorsSelectChange:function(){this._updateOperatorsSelectTitle();this.valueRadio.checked=!0;this._resetByFieldAndOperation()},
_onRangeNumberBlur:function(){if(this.numberTextBox1.validate()&&this.numberTextBox2.validate()){var a=this._getValueForNumberTextBox(this.numberTextBox1),d=this._getValueForNumberTextBox(this.numberTextBox2);t.isValidNumber(a)&&t.isValidNumber(d)&&a>d&&(this._setValueForNumberTextBox(this.numberTextBox1,d),this._setValueForNumberTextBox(this.numberTextBox2,a))}},_onRangeDateBlur:function(){if(this.dateTextBox1.validate()&&this.dateTextBox2.validate()){var a=this.dateTextBox1.get("value"),d=a.getTime(),
c=this.dateTextBox2.get("value"),b=c.getTime();d>b&&(this.dateTextBox1.set("value",c),this.dateTextBox2.set("value",a))}},_initRadios:function(){var a="radio_"+t.getRandomString();this.valueRadio.name=a;this.fieldRadio.name=a;t.combineRadioCheckBoxWithLabel(this.valueRadio,this.valueLabel);t.combineRadioCheckBoxWithLabel(this.fieldRadio,this.fieldLabel);this.own(m(this.valueRadio,"click",l.hitch(this,function(){this._resetByFieldAndOperation()})));this.own(m(this.fieldRadio,"click",l.hitch(this,function(){this._resetByFieldAndOperation()})));
this.uniqueRadio&&(this.uniqueRadio.name=a,t.combineRadioCheckBoxWithLabel(this.uniqueRadio,this.uniqueLabel),this.own(m(this.uniqueRadio,"click",l.hitch(this,function(){this._resetByFieldAndOperation()}))));this._resetByFieldAndOperation()},_updateValueTypeClass:function(){h.removeClass(this.domNode,"value-type");h.removeClass(this.domNode,"field-type");h.removeClass(this.domNode,"unique-type");this.valueRadio.checked?(h.addClass(this.domNode,"value-type"),this.cbxCascade.uncheck()):this.fieldRadio.checked?
(h.addClass(this.domNode,"field-type"),this.cbxCascade.uncheck()):(h.addClass(this.domNode,"unique-type"),this.cbxCascade.check())},_enableRadios:function(){this.valueRadio.disabled=!1;this.fieldRadio.disabled=!1;this.uniqueRadio&&(this.uniqueRadio.disabled=!1)},_disableRadios:function(){this.valueRadio.disabled=!0;this.fieldRadio.disabled=!0;this.uniqueRadio&&(this.uniqueRadio.disabled=!0)},_resetByFieldAndOperation:function(a){var d=a&&a.valueObj;h.setStyle(this.attributeValueContainer,"display",
"block");this._enableRadios();this._hideCaseSensitive();d&&("value"===d.type?this.valueRadio.checked=!0:"field"===d.type?this.fieldRadio.checked=!0:"unique"===d.type&&this.uniqueRadio&&(this.uniqueRadio.checked=!0));var c=this._getSelectedFilteringItem(this.fieldsSelect),b=c&&c.shortType,e=this.operatorsSelect.get("value");if(c)if("string"===b)switch(e){case this.OPERATORS.stringOperatorStartsWith:case this.OPERATORS.stringOperatorEndsWith:case this.OPERATORS.stringOperatorContains:case this.OPERATORS.stringOperatorDoesNotContain:this.valueRadio.checked=
!0,this._disableRadios(),this._showCaseSensitive(),a&&this.cbxCaseSensitive.setValue(a.caseSensitive)}else if("number"===b)switch(e){case this.OPERATORS.numberOperatorIsBetween:case this.OPERATORS.numberOperatorIsNotBetween:this.valueRadio.checked=!0,this._disableRadios()}else if("date"===b){switch(e){case this.OPERATORS.dateOperatorIsBetween:case this.OPERATORS.dateOperatorIsNotBetween:this.valueRadio.checked=!0,this._disableRadios()}this.uniqueRadio&&(this.uniqueRadio.disabled=!0,this.uniqueRadio.checked&&
(this.valueRadio.checked=!0))}this._updateUIOfAttrValueContainer(c,e,d);this._updateValueTypeClass()},_updateUIOfAttrValueContainer:function(a,d,c){this._updatePrompt();var b=a&&a.shortType;if("string"===b||"number"===b||"date"===b)if(h.setStyle(this.attributeValueContainer,"display","block"),this.valueRadio.checked)if(h.setStyle(this.fieldsSelect2.domNode,"display","none"),h.setStyle(this.uniqueValuesSelect.domNode,"display","none"),this._showAllValueBoxContainer(),this._resetValueTextBox(),"string"===
b)h.setStyle(this.stringTextBoxContainer,"display","block"),h.setStyle(this.numberTextBoxContainer,"display","none"),h.setStyle(this.dateTextBoxContainer,"display","none"),this._isFieldCoded(a)&&d===this.OPERATORS.stringOperatorIs?(h.setStyle(this.stringCodedValuesFS.domNode,"display","inline-block"),h.setStyle(this.stringTextBox.domNode,"display","none"),a=r.map(a.domain.codedValues,l.hitch(this,function(a,b){var g=l.mixin({},a);g.id=b;return g})),b=new e({data:a}),this.stringCodedValuesFS.set("store",
b),c?(b=r.filter(a,l.hitch(this,function(a){return a.code===c.value})),0<b.length?this.stringCodedValuesFS.set("value",b[0].id):this.stringCodedValuesFS.set("value",a[0].id)):this.stringCodedValuesFS.set("value",a[0].id)):(h.setStyle(this.stringTextBox.domNode,"display","inline-block"),h.setStyle(this.stringCodedValuesFS.domNode,"display","none"),c&&this._setValueForStringTextBox(this.stringTextBox,c.value)),(d===this.OPERATORS.stringOperatorIsBlank||d===this.OPERATORS.stringOperatorIsNotBlank)&&
h.setStyle(this.attributeValueContainer,"display","none");else if("number"===b){h.setStyle(this.stringTextBoxContainer,"display","none");h.setStyle(this.numberTextBoxContainer,"display","block");h.setStyle(this.dateTextBoxContainer,"display","none");if(d===this.OPERATORS.numberOperatorIsBetween||d===this.OPERATORS.numberOperatorIsNotBetween){if(h.setStyle(this.numberTextBox.domNode,"display","none"),h.setStyle(this.numberRangeTable,"display","table"),h.setStyle(this.numberCodedValuesFS.domNode,"display",
"none"),c){var f;a=t.isValidNumber(c.value1);b=t.isValidNumber(c.value2);a&&b?(b=parseFloat(c.value1),f=parseFloat(c.value2),a=Math.min(b,f),b=Math.max(b,f),this.numberTextBox1.set("value",a),this.numberTextBox2.set("value",b)):a&&!b?(b=parseFloat(c.value1),this.numberTextBox1.set("value",b)):!a&&b&&(f=parseFloat(c.value2),this.numberTextBox2.set("value",f))}}else if(h.setStyle(this.numberRangeTable,"display","none"),this._isFieldCoded(a)&&d===this.OPERATORS.numberOperatorIs)if(h.setStyle(this.numberTextBox.domNode,
"display","none"),h.setStyle(this.numberCodedValuesFS.domNode,"display","inline-block"),a=r.map(a.domain.codedValues,l.hitch(this,function(a,b){var g=l.mixin({},a);g.id=b;return g})),b=new e({data:a}),this.numberCodedValuesFS.set("store",b),c&&!isNaN(c.value)){var g=parseFloat(c.value),b=r.filter(a,l.hitch(this,function(a){return parseFloat(a.code)===g}));0<b.length?this.numberCodedValuesFS.set("value",b[0].id):this.numberCodedValuesFS.set("value",a[0].id)}else this.numberCodedValuesFS.set("value",
a[0].id);else h.setStyle(this.numberTextBox.domNode,"display","inline-block"),h.setStyle(this.numberCodedValuesFS.domNode,"display","none"),c&&this._setValueForNumberTextBox(this.numberTextBox,c.value);(d===this.OPERATORS.numberOperatorIsBlank||d===this.OPERATORS.numberOperatorIsNotBlank)&&h.setStyle(this.attributeValueContainer,"display","none")}else"date"===b&&(h.setStyle(this.stringTextBoxContainer,"display","none"),h.setStyle(this.numberTextBoxContainer,"display","none"),h.setStyle(this.dateTextBoxContainer,
"display","block"),d===this.OPERATORS.dateOperatorIsBetween||d===this.OPERATORS.dateOperatorIsNotBetween?(h.setStyle(this.dateTextBox.domNode,"display","none"),h.setStyle(this.dateRangeTable,"display","table"),c&&(c.value1&&c.value2)&&(this.dateTextBox1.set("value",new Date(c.value1)),this.dateTextBox2.set("value",new Date(c.value2)))):(h.setStyle(this.dateTextBox.domNode,"display","inline-block"),h.setStyle(this.dateRangeTable,"display","none"),c&&c.value&&this.dateTextBox.set("value",new Date(c.value))),
(d===this.OPERATORS.dateOperatorIsBlank||d===this.OPERATORS.dateOperatorIsNotBlank)&&h.setStyle(this.attributeValueContainer,"display","none"));else this.fieldRadio.checked?(this._hideAllValueBoxContainer(),h.setStyle(this.uniqueValuesSelect.domNode,"display","none"),h.setStyle(this.fieldsSelect2.domNode,"display","inline-block"),this._resetFieldsSelect2(),c&&c.value&&(d=this.fieldsSelect2.store.query({name:c.value}),0<d.length&&(d=d[0])&&this.fieldsSelect2.set("value",d.id))):this.uniqueRadio&&this.uniqueRadio.checked&&
(this._hideAllValueBoxContainer(),h.setStyle(this.fieldsSelect2.domNode,"display","none"),h.setStyle(this.uniqueValuesSelect.domNode,"display","inline-block"),this._resetUniqueValuesSelect(c));else h.setStyle(this.attributeValueContainer,"display","none")},_showAllValueBoxContainer:function(){h.setStyle(this.allValueBoxContainer,"display","block")},_hideAllValueBoxContainer:function(){h.setStyle(this.allValueBoxContainer,"display","none")},_resetValueTextBox:function(){this.stringTextBox.set("value",
"");this.numberTextBox.set("value","");this.dateTextBox.set("value",new Date)},_resetFieldsSelect2:function(){this.fieldsSelect2.set("displayedValue","");var a=new e({data:[]});this.fieldsSelect2.set("store",a);if(this.fieldsSelect.validate()){var d=this._getSelectedFilteringItem(this.fieldsSelect);if(d){var a=this.fieldsSelect.store.query({shortType:d.shortType}),c=r.filter(a,l.hitch(this,function(a){return a.id!==d.id})),a=new e({data:c});this.fieldsSelect2.set("store",a);0<c.length&&this.fieldsSelect2.set("value",
c[0].id)}}},_tryLocaleNumber:function(a){var d=t.localizeNumber(a);if(null===d||void 0===d)d=a;return d},_resetUniqueValuesSelect:function(a){this.uniqueValuesSelect.reset();this.uniqueValuesSelect.store.setData([]);if(this.layerInfo&&10.1<=parseFloat(this.layerInfo.currentVersion)){var d=this._getSelectedFilteringItem(this.fieldsSelect);d&&t.getUniqueValues(this.url,d.name,null).then(l.hitch(this,function(c){if(this.domNode){var b=this._getSelectedFilteringItem(this.fieldsSelect);if(c&&b&&d.id===
b.id){this.uniqueValuesSelect.store.setData([]);var e=-1,g=this._hasCodedValues(b);c=r.map(c,l.hitch(this,function(c,d){var f=c;"number"===b.shortType&&(c=parseFloat(c),f=this._tryLocaleNumber(c));g&&(f=this._getDisplayNameOfCodedValues(c,b));f={id:d,value:c,label:f};a&&a.value===c&&(e=f.id);return f}));this.uniqueValuesSelect.store.setData(c);0<c.length&&0<=e&&(c=this.uniqueValuesSelect.store.get(e))&&this.uniqueValuesSelect.set("item",c)}}}),l.hitch(this,function(a){console.error(a)}))}},_hasCodedValues:function(a){var d=
!1;a.domain&&(a=a.domain.codedValues)&&0<a.length&&(d=!0);return d},_getDisplayNameOfCodedValues:function(a,d){var c=a;r.some(d.domain.codedValues,function(b){return b.code===a?(c=b.name,!0):!1});return c},_onCbxAskValuesClicked:function(){this._updateRequiredProperty();this._updatePrompt()},_onCbxAskValuesStatusChanged:function(){this._updateRequiredProperty()},_isUseAskForValues:function(){return this.cbxAskValues.status&&this.cbxAskValues.checked},_isValueRequired:function(){return!this._isUseAskForValues()},
_updateRequiredProperty:function(){var a=this._isValueRequired();this.stringTextBox.set("required",a);this.stringCodedValuesFS.set("required",a);this.numberTextBox.set("required",a);this.numberTextBox1.set("required",a);this.numberTextBox2.set("required",a);this.numberCodedValuesFS.set("required",a);this.uniqueValuesSelect.set("required",a)},_updatePrompt:function(){this.promptTB.set("value","");this.hintTB.set("value","");this.cbxAskValues.setStatus(!0);h.setStyle(this.promptTable,"display","table");
var a=this.operatorsSelect.get("value"),d=this.nls[a];this.fieldRadio.checked&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.stringOperatorIsBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.stringOperatorIsNotBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.numberOperatorIsBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.numberOperatorIsNotBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.dateOperatorIsBlank&&this.cbxAskValues.setStatus(!1);a===this.OPERATORS.dateOperatorIsNotBlank&&
this.cbxAskValues.setStatus(!1);if(this.cbxAskValues.status&&this.cbxAskValues.checked){h.setStyle(this.promptTable,"display","table");var c=this._getSelectedFilteringItem(this.fieldsSelect);c&&"none"!==a&&this.promptTB.set("value",(c.alias||c.name)+" "+d)}else h.setStyle(this.promptTable,"display","none")},_destroySelf:function(){this.destroy()}})})},"dijit/form/FilteringSelect":function(){define(["dojo/_base/declare","dojo/_base/lang","dojo/when","./MappedTextBox","./ComboBoxMixin"],function(k,
f,p,s,n){return k("dijit.form.FilteringSelect",[s,n],{required:!0,_lastDisplayedValue:"",_isValidSubset:function(){return this._opened},isValid:function(){return!!this.item||!this.required&&""==this.get("displayedValue")},_refreshState:function(){this.searchTimer||this.inherited(arguments)},_callbackSetLabel:function(f,h,k,m){h&&h[this.searchAttr]!==this._lastQuery||!h&&f.length&&this.store.getIdentity(f[0])!=this._lastQuery||(f.length?this.set("item",f[0],m):this.set("value","",m||void 0===m&&!this.focused,
this.textbox.value,null))},_openResultList:function(f,h,k){h[this.searchAttr]===this._lastQuery&&(this.inherited(arguments),void 0===this.item&&this.validate(!0))},_getValueAttr:function(){return this.valueNode.value},_getValueField:function(){return"value"},_setValueAttr:function(l,h,k,m){this._onChangeActive||(h=null);if(void 0===m){if(null===l||""===l)if(l="",!f.isString(k)){this._setDisplayedValueAttr(k||"",h);return}var e=this;this._lastQuery=l;p(this.store.get(l),function(f){e._callbackSetLabel(f?
[f]:[],void 0,void 0,h)})}else this.valueNode.value=l,this.inherited(arguments,[l,h,k,m])},_setItemAttr:function(f,h,k){this.inherited(arguments);this._lastDisplayedValue=this.textbox.value},_getDisplayQueryString:function(f){return f.replace(/([\\\*\?])/g,"\\$1")},_setDisplayedValueAttr:function(l,h){null==l&&(l="");if(!this._created){if(!("displayedValue"in this.params))return;h=!1}if(this.store){this.closeDropDown();var k=f.clone(this.query),m=this._getDisplayQueryString(l),e;this.store._oldAPI?
e=m:(e=this._patternToRegExp(m),e.toString=function(){return m});this._lastQuery=k[this.searchAttr]=e;this._lastDisplayedValue=this.textbox.value=l;this._set("displayedValue",l);var n=this,a={queryOptions:{ignoreCase:this.ignoreCase,deep:!0}};f.mixin(a,this.fetchProperties);this._fetchHandle=this.store.query(k,a);p(this._fetchHandle,function(d){n._fetchHandle=null;n._callbackSetLabel(d||[],k,a,h)},function(a){n._fetchHandle=null;n._cancelingQuery||console.error("dijit.form.FilteringSelect: "+a.toString())})}},
undo:function(){this.set("displayedValue",this._lastDisplayedValue)}})})},"dijit/form/DateTextBox":function(){define(["dojo/_base/declare","../Calendar","./_DateTimeTextBox"],function(k,f,p){return k("dijit.form.DateTextBox",p,{baseClass:"dijitTextBox dijitComboBox dijitDateTextBox",popupClass:f,_selector:"date",maxHeight:Infinity,value:new Date("")})})},"dijit/Calendar":function(){define("dojo/_base/array dojo/date dojo/date/locale dojo/_base/declare dojo/dom-attr dojo/dom-class dojo/dom-construct dojo/_base/kernel dojo/keys dojo/_base/lang dojo/on dojo/sniff ./CalendarLite ./_Widget ./_CssStateMixin ./_TemplatedMixin ./form/DropDownButton".split(" "),
function(k,f,p,s,n,l,h,r,m,e,t,a,d,c,b,w,g){var v=s("dijit.Calendar",[d,c,b],{baseClass:"dijitCalendar",cssStateNodes:{decrementMonth:"dijitCalendarArrow",incrementMonth:"dijitCalendarArrow",previousYearLabelNode:"dijitCalendarPreviousYear",nextYearLabelNode:"dijitCalendarNextYear"},setValue:function(a){r.deprecated("dijit.Calendar:setValue() is deprecated.  Use set('value', ...) instead.","","2.0");this.set("value",a)},_createMonthWidget:function(){return new v._MonthDropDownButton({id:this.id+"_mddb",
tabIndex:-1,onMonthSelect:e.hitch(this,"_onMonthSelect"),lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},postCreate:function(){this.inherited(arguments);this.own(t(this.domNode,"keydown",e.hitch(this,"_onKeyDown")),t(this.dateRowsNode,"mouseover",e.hitch(this,"_onDayMouseOver")),t(this.dateRowsNode,"mouseout",e.hitch(this,"_onDayMouseOut")),t(this.dateRowsNode,"mousedown",e.hitch(this,"_onDayMouseDown")),t(this.dateRowsNode,"mouseup",e.hitch(this,"_onDayMouseUp")))},_onMonthSelect:function(a){var b=
new this.dateClassObj(this.currentFocus);b.setDate(1);b.setMonth(a);a=this.dateModule.getDaysInMonth(b);var g=this.currentFocus.getDate();b.setDate(Math.min(g,a));this._setCurrentFocusAttr(b)},_onDayMouseOver:function(a){if((a=l.contains(a.target,"dijitCalendarDateLabel")?a.target.parentNode:a.target)&&(a.dijitDateValue&&!l.contains(a,"dijitCalendarDisabledDate")||a==this.previousYearLabelNode||a==this.nextYearLabelNode))l.add(a,"dijitCalendarHoveredDate"),this._currentNode=a},_onDayMouseOut:function(a){this._currentNode&&
!(a.relatedTarget&&a.relatedTarget.parentNode==this._currentNode)&&(a="dijitCalendarHoveredDate",l.contains(this._currentNode,"dijitCalendarActiveDate")&&(a+=" dijitCalendarActiveDate"),l.remove(this._currentNode,a),this._currentNode=null)},_onDayMouseDown:function(a){if((a=a.target.parentNode)&&a.dijitDateValue&&!l.contains(a,"dijitCalendarDisabledDate"))l.add(a,"dijitCalendarActiveDate"),this._currentNode=a},_onDayMouseUp:function(a){(a=a.target.parentNode)&&a.dijitDateValue&&l.remove(a,"dijitCalendarActiveDate")},
handleKey:function(a){var b=-1,g,c=this.currentFocus;switch(a.keyCode){case m.RIGHT_ARROW:b=1;case m.LEFT_ARROW:g="day";this.isLeftToRight()||(b*=-1);break;case m.DOWN_ARROW:b=1;case m.UP_ARROW:g="week";break;case m.PAGE_DOWN:b=1;case m.PAGE_UP:g=a.ctrlKey||a.altKey?"year":"month";break;case m.END:c=this.dateModule.add(c,"month",1),g="day";case m.HOME:c=new this.dateClassObj(c);c.setDate(1);break;default:return!0}g&&(c=this.dateModule.add(c,g,b));this._setCurrentFocusAttr(c);return!1},_onKeyDown:function(a){this.handleKey(a)||
(a.stopPropagation(),a.preventDefault())},onValueSelected:function(){},onChange:function(a){this.onValueSelected(a)},getClassForDate:function(){}});v._MonthDropDownButton=s("dijit.Calendar._MonthDropDownButton",g,{onMonthSelect:function(){},postCreate:function(){this.inherited(arguments);this.dropDown=new v._MonthDropDown({id:this.id+"_mdd",onChange:this.onMonthSelect})},_setMonthAttr:function(b){var g=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,b);this.dropDown.set("months",
g);this.containerNode.innerHTML=(6==a("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+this.dropDown.domNode.innerHTML+"\x3c/div\x3e")+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+g[b.getMonth()]+"\x3c/div\x3e"}});v._MonthDropDown=s("dijit.Calendar._MonthDropDown",[c,w,b],{months:[],baseClass:"dijitCalendarMonthMenu dijitMenu",templateString:"\x3cdiv data-dojo-attach-event\x3d'ondijitclick:_onClick'\x3e\x3c/div\x3e",_setMonthsAttr:function(a){this.domNode.innerHTML=
"";k.forEach(a,function(a,b){h.create("div",{className:"dijitCalendarMonthLabel",month:b,innerHTML:a},this.domNode)._cssState="dijitCalendarMonthLabel"},this)},_onClick:function(a){this.onChange(n.get(a.target,"month"))},onChange:function(){}});return v})},"dijit/CalendarLite":function(){define("dojo/_base/array dojo/_base/declare dojo/cldr/supplemental dojo/date dojo/date/locale dojo/date/stamp dojo/dom dojo/dom-class dojo/_base/lang dojo/on dojo/sniff dojo/string ./_WidgetBase ./_TemplatedMixin dojo/text!./templates/Calendar.html ./a11yclick ./hccss".split(" "),
function(k,f,p,s,n,l,h,r,m,e,t,a,d,c,b){var w=f("dijit.CalendarLite",[d,c],{templateString:b,dowTemplateString:'\x3cth class\x3d"dijitReset dijitCalendarDayLabelTemplate" role\x3d"columnheader" scope\x3d"col"\x3e\x3cspan class\x3d"dijitCalendarDayLabel"\x3e${d}\x3c/span\x3e\x3c/th\x3e',dateTemplateString:'\x3ctd class\x3d"dijitReset" role\x3d"gridcell" data-dojo-attach-point\x3d"dateCells"\x3e\x3cspan class\x3d"dijitCalendarDateLabel" data-dojo-attach-point\x3d"dateLabels"\x3e\x3c/span\x3e\x3c/td\x3e',
weekTemplateString:'\x3ctr class\x3d"dijitReset dijitCalendarWeekTemplate" role\x3d"row"\x3e${d}${d}${d}${d}${d}${d}${d}\x3c/tr\x3e',value:new Date(""),datePackage:"",dayWidth:"narrow",tabIndex:"0",dayOffset:-1,currentFocus:new Date,_setSummaryAttr:"gridNode",baseClass:"dijitCalendar dijitCalendarLite",_isValidDate:function(a){return a&&!isNaN(a)&&"object"==typeof a&&a.toString()!=this.constructor.prototype.value.toString()},_getValueAttr:function(){var a=this._get("value");if(a&&!isNaN(a)){var b=
new this.dateClassObj(a);b.setHours(0,0,0,0);b.getDate()<a.getDate()&&(b=this.dateModule.add(b,"hour",1));return b}return null},_setValueAttr:function(a,b){"string"==typeof a&&(a=l.fromISOString(a));a=this._patchDate(a);if(this._isValidDate(a)&&!this.isDisabledDate(a,this.lang)){if(this._set("value",a),this.set("currentFocus",a),this._markSelectedDates([a]),this._created&&(b||"undefined"==typeof b))this.onChange(this.get("value"))}else this._set("value",null),this._markSelectedDates([])},_patchDate:function(a){a&&
(a=new this.dateClassObj(a),a.setHours(1,0,0,0));return a},_setText:function(a,b){for(;a.firstChild;)a.removeChild(a.firstChild);a.appendChild(a.ownerDocument.createTextNode(b))},_populateGrid:function(){var a=new this.dateClassObj(this.currentFocus);a.setDate(1);var a=this._patchDate(a),b=a.getDay(),c=this.dateModule.getDaysInMonth(a),d=this.dateModule.getDaysInMonth(this.dateModule.add(a,"month",-1)),e=new this.dateClassObj,f=0<=this.dayOffset?this.dayOffset:p.getFirstDayOfWeek(this.lang);f>b&&
(f-=7);if(!this.summary){var h=this.dateLocaleModule.getNames("months","wide","standAlone",this.lang,a);this.gridNode.setAttribute("summary",h[a.getMonth()])}this._date2cell={};k.forEach(this.dateCells,function(y,h){var m=h+f,l=new this.dateClassObj(a),w="dijitCalendar",k=0;m<b?(m=d-b+m+1,k=-1,w+="Previous"):m>=b+c?(m=m-b-c+1,k=1,w+="Next"):(m=m-b+1,w+="Current");k&&(l=this.dateModule.add(l,"month",k));l.setDate(m);this.dateModule.compare(l,e,"date")||(w="dijitCalendarCurrentDate "+w);this.isDisabledDate(l,
this.lang)?(w="dijitCalendarDisabledDate "+w,y.setAttribute("aria-disabled","true")):(w="dijitCalendarEnabledDate "+w,y.removeAttribute("aria-disabled"),y.setAttribute("aria-selected","false"));(k=this.getClassForDate(l,this.lang))&&(w=k+" "+w);y.className=w+"Month dijitCalendarDateTemplate";w=l.valueOf();this._date2cell[w]=y;y.dijitDateValue=w;this._setText(this.dateLabels[h],l.getDateLocalized?l.getDateLocalized(this.lang):l.getDate())},this)},_populateControls:function(){var a=new this.dateClassObj(this.currentFocus);
a.setDate(1);this.monthWidget.set("month",a);var b=a.getFullYear()-1,c=new this.dateClassObj;k.forEach(["previous","current","next"],function(a){c.setFullYear(b++);this._setText(this[a+"YearLabelNode"],this.dateLocaleModule.format(c,{selector:"year",locale:this.lang}))},this)},goToToday:function(){this.set("value",new this.dateClassObj)},constructor:function(a){this.dateModule=a.datePackage?m.getObject(a.datePackage,!1):s;this.dateClassObj=this.dateModule.Date||Date;this.dateLocaleModule=a.datePackage?
m.getObject(a.datePackage+".locale",!1):n},_createMonthWidget:function(){return w._MonthWidget({id:this.id+"_mddb",lang:this.lang,dateLocaleModule:this.dateLocaleModule},this.monthNode)},buildRendering:function(){var b=this.dowTemplateString,c=this.dateLocaleModule.getNames("days",this.dayWidth,"standAlone",this.lang),d=0<=this.dayOffset?this.dayOffset:p.getFirstDayOfWeek(this.lang);this.dayCellsHtml=a.substitute([b,b,b,b,b,b,b].join(""),{d:""},function(){return c[d++%7]});b=a.substitute(this.weekTemplateString,
{d:this.dateTemplateString});this.dateRowsHtml=[b,b,b,b,b,b].join("");this.dateCells=[];this.dateLabels=[];this.inherited(arguments);h.setSelectable(this.domNode,!1);b=new this.dateClassObj(this.currentFocus);this.monthWidget=this._createMonthWidget();this.set("currentFocus",b,!1)},postCreate:function(){this.inherited(arguments);this._connectControls()},_connectControls:function(){var a=m.hitch(this,function(a,b,g){this[a].dojoClick=!0;return e(this[a],"click",m.hitch(this,function(){this._setCurrentFocusAttr(this.dateModule.add(this.currentFocus,
b,g))}))});this.own(a("incrementMonth","month",1),a("decrementMonth","month",-1),a("nextYearLabelNode","year",1),a("previousYearLabelNode","year",-1))},_setCurrentFocusAttr:function(a,b){var c=this.currentFocus,d=this._getNodeByDate(c);a=this._patchDate(a);this._set("currentFocus",a);if(!this._date2cell||0!=this.dateModule.difference(c,a,"month"))this._populateGrid(),this._populateControls(),this._markSelectedDates([this.value]);c=this._getNodeByDate(a);c.setAttribute("tabIndex",this.tabIndex);(this.focused||
b)&&c.focus();d&&d!=c&&(t("webkit")?d.setAttribute("tabIndex","-1"):d.removeAttribute("tabIndex"))},focus:function(){this._setCurrentFocusAttr(this.currentFocus,!0)},_onDayClick:function(a){a.stopPropagation();a.preventDefault();for(a=a.target;a&&!a.dijitDateValue;a=a.parentNode);a&&!r.contains(a,"dijitCalendarDisabledDate")&&this.set("value",a.dijitDateValue)},_getNodeByDate:function(a){return(a=this._patchDate(a))&&this._date2cell?this._date2cell[a.valueOf()]:null},_markSelectedDates:function(a){function b(a,
g){r.toggle(g,"dijitCalendarSelectedDate",a);g.setAttribute("aria-selected",a?"true":"false")}k.forEach(this._selectedCells||[],m.partial(b,!1));this._selectedCells=k.filter(k.map(a,this._getNodeByDate,this),function(a){return a});k.forEach(this._selectedCells,m.partial(b,!0))},onChange:function(){},isDisabledDate:function(){},getClassForDate:function(){}});w._MonthWidget=f("dijit.CalendarLite._MonthWidget",d,{_setMonthAttr:function(a){var b=this.dateLocaleModule.getNames("months","wide","standAlone",
this.lang,a),c=6==t("ie")?"":"\x3cdiv class\x3d'dijitSpacer'\x3e"+k.map(b,function(a){return"\x3cdiv\x3e"+a+"\x3c/div\x3e"}).join("")+"\x3c/div\x3e";this.domNode.innerHTML=c+"\x3cdiv class\x3d'dijitCalendarMonthLabel dijitCalendarCurrentMonthLabel'\x3e"+b[a.getMonth()]+"\x3c/div\x3e"}});return w})},"dijit/form/_DateTimeTextBox":function(){define("dojo/date dojo/date/locale dojo/date/stamp dojo/_base/declare dojo/_base/lang ./RangeBoundTextBox ../_HasDropDown dojo/text!./templates/DropDownBox.html".split(" "),
function(k,f,p,s,n,l,h,r){new Date("X");return s("dijit.form._DateTimeTextBox",[l,h],{templateString:r,hasDownArrow:!0,cssStateNodes:{_buttonNode:"dijitDownArrowButton"},_unboundedConstraints:{},pattern:f.regexp,datePackage:"",postMixInProperties:function(){this.inherited(arguments);this._set("type","text")},compare:function(f,e){var h=this._isInvalidDate(f),a=this._isInvalidDate(e);if(h||a)return h&&a?0:!h?1:-1;var h=this.format(f,this._unboundedConstraints),a=this.format(e,this._unboundedConstraints),
d=this.parse(h,this._unboundedConstraints),c=this.parse(a,this._unboundedConstraints);return h==a?0:k.compare(d,c,this._selector)},autoWidth:!0,format:function(f,e){return!f?"":this.dateLocaleModule.format(f,e)},parse:function(f,e){return this.dateLocaleModule.parse(f,e)||(this._isEmpty(f)?null:void 0)},serialize:function(f,e){f.toGregorian&&(f=f.toGregorian());return p.toISOString(f,e)},dropDownDefaultValue:new Date,value:new Date(""),_blankValue:null,popupClass:"",_selector:"",constructor:function(h){h=
h||{};this.dateModule=h.datePackage?n.getObject(h.datePackage,!1):k;this.dateClassObj=this.dateModule.Date||Date;this.dateClassObj instanceof Date||(this.value=new this.dateClassObj(this.value));this.dateLocaleModule=h.datePackage?n.getObject(h.datePackage+".locale",!1):f;this._set("pattern",this.dateLocaleModule.regexp);this._invalidDate=this.constructor.prototype.value.toString()},buildRendering:function(){this.inherited(arguments);this.hasDownArrow||(this._buttonNode.style.display="none");this.hasDownArrow||
(this._buttonNode=this.domNode,this.baseClass+=" dijitComboBoxOpenOnClick")},_setConstraintsAttr:function(f){f.selector=this._selector;f.fullYear=!0;var e=p.fromISOString;"string"==typeof f.min&&(f.min=e(f.min),this.dateClassObj instanceof Date||(f.min=new this.dateClassObj(f.min)));"string"==typeof f.max&&(f.max=e(f.max),this.dateClassObj instanceof Date||(f.max=new this.dateClassObj(f.max)));this.inherited(arguments);this._unboundedConstraints=n.mixin({},this.constraints,{min:null,max:null})},_isInvalidDate:function(f){return!f||
isNaN(f)||"object"!=typeof f||f.toString()==this._invalidDate},_setValueAttr:function(f,e,h){void 0!==f&&("string"==typeof f&&(f=p.fromISOString(f)),this._isInvalidDate(f)&&(f=null),f instanceof Date&&!(this.dateClassObj instanceof Date)&&(f=new this.dateClassObj(f)));this.inherited(arguments,[f,e,h]);this.value instanceof Date&&(this.filterString="");!1!==e&&this.dropDown&&this.dropDown.set("value",f,!1)},_set:function(f,e){if("value"==f){e instanceof Date&&!(this.dateClassObj instanceof Date)&&
(e=new this.dateClassObj(e));var h=this._get("value");if(h instanceof this.dateClassObj&&0==this.compare(e,h))return}this.inherited(arguments)},_setDropDownDefaultValueAttr:function(f){this._isInvalidDate(f)&&(f=new this.dateClassObj);this._set("dropDownDefaultValue",f)},openDropDown:function(f){this.dropDown&&this.dropDown.destroy();var e=n.isString(this.popupClass)?n.getObject(this.popupClass,!1):this.popupClass,h=this,a=this.get("value");this.dropDown=new e({onChange:function(a){h.set("value",
a,!0)},id:this.id+"_popup",dir:h.dir,lang:h.lang,value:a,textDir:h.textDir,currentFocus:!this._isInvalidDate(a)?a:this.dropDownDefaultValue,constraints:h.constraints,filterString:h.filterString,datePackage:h.datePackage,isDisabledDate:function(a){return!h.rangeCheck(a,h.constraints)}});this.inherited(arguments)},_getDisplayedValueAttr:function(){return this.textbox.value},_setDisplayedValueAttr:function(f,e){this._setValueAttr(this.parse(f,this.constraints),e,f)}})})},"jimu/dijit/_FilterSet":function(){define("dojo/_base/declare dijit/_WidgetBase dijit/_TemplatedMixin dijit/_WidgetsInTemplateMixin dojo/text!./templates/_FilterSet.html dijit/registry dojo/_base/lang dojo/_base/html dojo/_base/array dojo/on dojo/aspect dojo/query ./_SingleFilter".split(" "),
function(k,f,p,s,n,l,h,r,m,e,t,a,d){return k([f,p,s],{templateString:n,baseClass:"jimu-filter-set",nls:null,url:null,layerInfo:null,stringFieldType:"",dateFieldType:"",numberFieldTypes:[],partsObj:null,OPERATORS:null,enableAskForValues:!1,isHosted:!1,postMixInProperties:function(){this.nls=window.jimuNls.filterBuilder;var a=this.nls.matchMsgSet.split("${any_or_all}");this.nls.strMatchMsgPart1=a[0]||"";this.nls.strMatchMsgPart2=a[1]||"";this.inherited(arguments)},postCreate:function(){this.inherited(arguments);
this._initSelf()},toJson:function(){var c=a(".jimu-single-filter",this.allExpsBox),c=m.map(c,h.hitch(this,function(a){return l.byNode(a).toJson()}));return m.every(c,h.hitch(this,function(a){return!!a}))&&0<c.length?{logicalOperator:this.allAnySelect.value,parts:c}:null},showDelteIcon:function(){r.setStyle(this.btnDelete,"display","block")},hideDeleteIcon:function(){r.setStyle(this.btnDelete,"display","none")},_initSelf:function(){this.own(e(this.btnAdd,"click",h.hitch(this,this._addSingleFilter)));
if(this.partsObj){this.allAnySelect.value=this.partsObj.logicalOperator;var a=this.partsObj.parts||[];0===a.length?(this._addSingleFilter(),this._addSingleFilter()):1===a.length?(this._addSingleFilter(a[0]),this._addSingleFilter()):m.forEach(a,h.hitch(this,function(a){this._addSingleFilter(a)}))}else this._addSingleFilter(),this._addSingleFilter()},_addSingleFilter:function(a){a=new d({url:this.url,layerInfo:this.layerInfo,stringFieldType:this.stringFieldType,dateFieldType:this.dateFieldType,numberFieldTypes:this.numberFieldTypes,
part:a,OPERATORS:this.OPERATORS,enableAskForValues:this.enableAskForValues,isHosted:this.isHosted,style:{margin:"15px auto 0 auto",border:0,background:"inherit"}});a.placeAt(this.allExpsBox);a.startup();this.own(t.after(a,"_destroySelf",h.hitch(this,this._checkFilterNumbers)));this._checkFilterNumbers()},_checkFilterNumbers:function(){var c=a(".jimu-single-filter",this.allExpsBox),b=2<c.length;m.forEach(c,h.hitch(this,function(a){a=l.byNode(a);b?a.showDelteIcon():a.hideDeleteIcon()}))},_destroySelf:function(){this.destroy()}})})},
"widgets/AttributeTable/dgrid/Selection":function(){define("dojo/_base/kernel dojo/_base/declare dojo/_base/Deferred dojo/on dojo/has dojo/aspect dgrid/List dojo/has!touch?dgrid/util/touch put-selector/put dojo/query dojo/_base/sniff".split(" "),function(k,f,p,s,n,l,h,r,m){function e(a,b){for(var c=a.unselectable=b?"on":"",d=a.getElementsByTagName("*"),e=d.length;--e;)"INPUT"===d[e].tagName||"TEXTAREA"===d[e].tagName||(d[e].unselectable=c)}function t(a,b){var c=a.bodyNode,f=b?"text":21>n("ff")?"-moz-none":
"none";d&&"msUserSelect"!==d?c.style[d]=f:n("dom-selectstart")?!b&&!a._selectstartHandle?a._selectstartHandle=s(c,"selectstart",function(a){var b=a.target&&a.target.tagName;"INPUT"!==b&&"TEXTAREA"!==b&&a.preventDefault()}):b&&a._selectstartHandle&&(a._selectstartHandle.remove(),delete a._selectstartHandle):(e(c,!b),!b&&!a._unselectableHandle?a._unselectableHandle=l.after(a,"renderRow",function(a){e(a,!0);return a}):b&&a._unselectableHandle&&(a._unselectableHandle.remove(),delete a._unselectableHandle))}
n.add("dom-comparedocumentposition",function(a,b,c){return!!c.compareDocumentPosition});n.add("pointer",function(a){return"PointerEvent"in a?"pointer":"MSPointerEvent"in a?"MSPointer":!1});n.add("css-user-select",function(a,b,c){a=c.style;b=["Khtml","O","ms","Moz","Webkit"];c=b.length;var d="userSelect";do if("undefined"!==typeof a[d])return d;while(c--&&(d=b[c]+"UserSelect"));return!1});n.add("dom-selectstart","undefined"!==typeof document.onselectstart);var a=n("mac")?"metaKey":"ctrlKey",d=n("css-user-select"),
c=(h=n("pointer"))&&"MS"===h.slice(0,2),b=h?h+(c?"Down":"down"):"mousedown",w=h?h+(c?"Up":"up"):"mouseup";"WebkitUserSelect"===d&&"undefined"!==typeof document.documentElement.style.msUserSelect&&(d=!1);return f("dgrid.Selection",null,{selectionDelegate:".dgrid-cell.dgrid-cell-padding.dgrid-column-selectionHandle.field-selectionHandle.selection-handle-column",selectionEvents:b+","+w+",dgrid-cellfocusin",selectionTouchEvents:n("touch")?r.tap:null,deselectOnRefresh:!0,allowSelectAll:!1,selection:{},
selectionMode:"extended",allowTextSelection:void 0,_selectionTargetType:"rows",create:function(){this.selection={};return this.inherited(arguments)},postCreate:function(){this.inherited(arguments);this._initSelectionEvents();var a=this.selectionMode;this.selectionMode="";this._setSelectionMode(a)},destroy:function(){this.inherited(arguments);this._selectstartHandle&&this._selectstartHandle.remove();this._unselectableHandle&&this._unselectableHandle.remove();this._removeDeselectSignals&&this._removeDeselectSignals()},
_setSelectionMode:function(a){a!=this.selectionMode&&(this.clearSelection(),this.selectionMode=a,this._selectionHandlerName="_"+a+"SelectionHandler",this._setAllowTextSelection(this.allowTextSelection))},setSelectionMode:function(a){k.deprecated("setSelectionMode(...)",'use set("selectionMode", ...) instead',"dgrid 0.4");this.set("selectionMode",a)},_setAllowTextSelection:function(a){"undefined"!==typeof a?t(this,a):t(this,"none"===this.selectionMode);this.allowTextSelection=a},_handleSelect:function(a,
c){if(this[this._selectionHandlerName]&&this.allowSelect(this.row(c))&&!("dgrid-cellfocusin"===a.type&&"mousedown"===a.parentType||a.type===w&&c!=this._waitForMouseUp)){this._waitForMouseUp=null;this._selectionTriggerEvent=a;if(!a.keyCode||!a.ctrlKey||32==a.keyCode)if(!a.shiftKey&&a.type===b&&this.isSelected(c))this._waitForMouseUp=c;else this[this._selectionHandlerName](a,c);this._selectionTriggerEvent=null}},_singleSelectionHandler:function(b,c){var d=b.keyCode?b.ctrlKey:b[a];this._lastSelected===
c?this.select(c,null,!d||!this.isSelected(c)):(this.clearSelection(),this.select(c),this._lastSelected=c)},_multipleSelectionHandler:function(b,c){var d=this._lastSelected,e=b.keyCode?b.ctrlKey:b[a],f;b.shiftKey||(f=e?null:!0,d=null);this.select(c,d,f);d||(this._lastSelected=c)},_extendedSelectionHandler:function(b,c){(2===b.button?!this.isSelected(c):!(b.keyCode?b.ctrlKey:b[a]))&&this.clearSelection(null,!0);this._multipleSelectionHandler(b,c)},_toggleSelectionHandler:function(a,b){this.select(b,
null,null)},_initSelectionEvents:function(){var b=this,c=this.contentNode,d=this.selectionDelegate;this._selectionEventQueues={deselect:[],select:[]};n("touch")&&!n("pointer")&&this.selectionTouchEvents?(s(c,r.selector(d,this.selectionTouchEvents),function(a){b._handleSelect(a,this);b._ignoreMouseSelect=this}),s(c,s.selector(d,this.selectionEvents),function(a){b._ignoreMouseSelect!==this?b._handleSelect(a,this):a.type===w&&(b._ignoreMouseSelect=null)})):s(c,s.selector(d,this.selectionEvents),function(a){b._handleSelect(a,
this)});this.addKeyHandler&&this.addKeyHandler(32,function(a){b._handleSelect(a,a.target)});if(this.allowSelectAll)this.on("keydown",function(c){c[a]&&(65==c.keyCode&&!/\bdgrid-input\b/.test(c.target.className))&&(c.preventDefault(),b[b.allSelected?"clearSelection":"selectAll"]())});this._setStore&&l.after(this,"_setStore",function(){b._updateDeselectionAspect()});this._updateDeselectionAspect()},_updateDeselectionAspect:function(){function a(c,g,d){c=g||c&&c[b.idProperty||"id"];if(null!=c&&(g=(c=
b.row(c))&&b.selection[c.id]))b[d](c,null,g)}var b=this,c=this.store,d,e;this._removeDeselectSignals&&this._removeDeselectSignals();c&&c.notify?(d=l.before(c,"notify",function(b,c){b||a(b,c,"deselect")}),e=l.after(c,"notify",function(b,c){a(b,c,"select")},!0),this._removeDeselectSignals=function(){d.remove();e.remove()}):(d=l.before(this,"removeRow",function(a,b){var c;b||(c=this.row(a))&&c.id in this.selection&&this.deselect(c)}),this._removeDeselectSignals=function(){d.remove()})},allowSelect:function(a){return!0},
_fireSelectionEvent:function(a){var b=this._selectionEventQueues[a],c=this._selectionTriggerEvent,d;d={bubbles:!0,grid:this};c&&(d.parentType=c.type);d[this._selectionTargetType]=b;this._selectionEventQueues[a]=[];s.emit(this.contentNode,"dgrid-"+a,d)},_fireSelectionEvents:function(){var a=this._selectionEventQueues,b;for(b in a)a[b].length&&this._fireSelectionEvent(b)},_select:function(a,b,c){var d,e,f;"undefined"===typeof c&&(c=!0);a.element||(a=this.row(a));if(!1===c||this.allowSelect(a))if(d=
this.selection,e=!!d[a.id],null===c&&(c=!e),f=a.element,!c&&!this.allSelected?delete this.selection[a.id]:d[a.id]=c,f&&(c?m(f,".dgrid-selected"+(this.addUiClasses?".ui-state-active":"")):m(f,"!dgrid-selected!ui-state-active")),c!==e&&f&&this._selectionEventQueues[(c?"":"de")+"select"].push(a),b)if(b.element||(b=this.row(b)),b){if(b=b.element){d=this._determineSelectionDirection(f,b);d||(b=document.getElementById(b.id),d=this._determineSelectionDirection(f,b));for(;a.element!=b&&(a=this[d](a));)this._select(a,
null,c)}}else this._lastSelected=f,console.warn("The selection range has been reset because the beginning of the selection is no longer in the DOM. If you are using OnDemandList, you may wish to increase farOffRemoval to avoid this, but note that keeping more nodes in the DOM may impact performance.")},_determineSelectionDirection:n("dom-comparedocumentposition")?function(a,b){var c=b.compareDocumentPosition(a);return c&1?!1:2===c?"down":"up"}:function(a,b){return 1>b.sourceIndex?!1:b.sourceIndex>
a.sourceIndex?"down":"up"},select:function(a,b,c){this._select(a,b,c);this._fireSelectionEvents()},deselect:function(a,b){this.select(a,b,!1)},clearSelection:function(a,b){this.allSelected=!1;for(var c in this.selection)a!==c&&this._select(c,null,!1);b||(this._lastSelected=null);this._fireSelectionEvents()},selectAll:function(){this.allSelected=!0;this.selection={};for(var a in this._rowIdToObject){var b=this.row(this._rowIdToObject[a]);this._select(b.id,null,!0)}this._fireSelectionEvents()},isSelected:function(a){if("undefined"===
typeof a||null===a)return!1;a.element||(a=this.row(a));return a.id in this.selection?!!this.selection[a.id]:this.allSelected&&(!a.data||this.allowSelect(a))},refresh:function(){this.deselectOnRefresh&&this.clearSelection();this._lastSelected=null;return this.inherited(arguments)},renderArray:function(){var a=this,b=this.inherited(arguments);p.when(b,function(b){var c=a.selection,d,e,f;for(d=0;d<b.length;d++)e=a.row(b[d]),(f=e.id in c?c[e.id]:a.allSelected)&&a._select(e,null,f);a._fireSelectionEvents()});
return b}})})},"dgrid/extensions/ColumnHider":function(){define("dojo/_base/declare dojo/has dojo/on ../util/misc put-selector/put dojo/i18n!./nls/columnHider xstyle/css!../css/extensions/ColumnHider.css".split(" "),function(k,f,p,s,n,l){var h,r,m=f("ie"),e=m&&f("quirks"),t=8>m||e?"htmlFor":"for";return k("dgrid.extensions.ColumnHider",null,{hiderMenuNode:null,hiderToggleNode:null,i18nColumnHider:l,_hiderMenuOpened:!1,_columnHiderRules:null,_columnHiderCheckboxes:null,_renderHiderMenuEntries:function(){var a=
this.subRows,d=!0,c,b,e,g;delete this._columnHiderFirstCheckbox;e=0;for(c=a.length;e<c;e++){g=0;for(b=a[e].length;g<b;g++)this._renderHiderMenuEntry(a[e][g]),d&&(d=!1,this._columnHiderFirstCheckbox=this._columnHiderCheckboxes[a[e][g].id])}},_renderHiderMenuEntry:function(a){var d=a.id,c=s.escapeCssIdentifier(d,"-"),b,e;a.hidden&&(a.hidden=!1,this._hideColumn(d),a.hidden=!0);a.unhidable||(b=n("div.dgrid-hider-menu-row"),e=this.domNode.id+"-hider-menu-check-"+c,d=this._columnHiderCheckboxes[d]=n(b,
"input.dgrid-hider-menu-check.hider-menu-check-"+c+"[type\x3dcheckbox]"),d.id=e,n(b,"label.dgrid-hider-menu-label.hider-menu-label-"+c+"["+t+"\x3d"+e+"]",a.label||a.field||""),n(this.hiderMenuNode,b),a.hidden||(d.checked=!0))},renderHeader:function(){function a(a){a.stopPropagation()}var d=this,c=this.hiderMenuNode,b=this.hiderToggleNode,f;this.inherited(arguments);if(c){for(f in this._columnHiderRules)this._columnHiderRules[f].remove();c.innerHTML=""}else b=this.hiderToggleNode=n(this.domNode,"button.ui-icon.dgrid-hider-toggle[type\x3dbutton][aria-label\x3d"+
this.i18nColumnHider.popupTriggerLabel+"]"),this._listeners.push(p(b,"click",function(a){d._toggleColumnHiderMenu(a)})),c=this.hiderMenuNode=n("div.dgrid-hider-menu[role\x3ddialog][aria-label\x3d"+this.i18nColumnHider.popupLabel+"]"),c.id=this.id+"-hider-menu",this._listeners.push(p(c,"keyup",function(a){if(27===(a.charCode||a.keyCode))d._toggleColumnHiderMenu(a),b.focus()})),c.style.display="none",n(this.domNode,c),this._listeners.push(p(c,".dgrid-hider-menu-check:"+(9>m||e?"click":"change"),function(a){d._updateColumnHiddenState(a.target.id.substr(d.id.length+
18),!a.target.checked)})),this._listeners.push(p(c,"mousedown",a),p(b,"mousedown",a)),r||(r=p.pausable(document,"mousedown",function(a){h&&h._toggleColumnHiderMenu(a)}),r.pause());this._columnHiderCheckboxes={};this._columnHiderRules={};this._renderHiderMenuEntries()},destroy:function(){this.inherited(arguments);for(var a in this._columnHiderRules)this._columnHiderRules[a].remove()},left:function(a,d){return this.right(a,-d)},right:function(a,d){a.element||(a=this.cell(a));for(var c=this.inherited(arguments),
b=a;c.column.hidden;){c=this.inherited(arguments,[c,0<d?1:-1]);if(b.element===c.element)return a;b=c}return c},isColumnHidden:function(a){return!!this._columnHiderRules[a]},_toggleColumnHiderMenu:function(){var a=this._hiderMenuOpened,d=this.hiderMenuNode,c=this.domNode,b;d.style.display=a?"none":"";a?d.style.height="":(d.offsetHeight>c.offsetHeight-12&&(d.style.height=c.offsetHeight-12+"px"),(b=this._columnHiderFirstCheckbox)&&b.focus());r[a?"pause":"resume"]();h=a?null:this;this._hiderMenuOpened=
!a},_hideColumn:function(a){var d=this,c="#"+s.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-",b;if(!this._columnHiderRules[a]&&(this._columnHiderRules[a]=s.addCssRule(c+s.escapeCssIdentifier(a,"-"),"display: none;"),(8===f("ie")||10===f("ie"))&&!f("quirks")))b=s.addCssRule(".dgrid-row-table","display: inline-table;"),window.setTimeout(function(){b.remove();d.resize()},0)},_showColumn:function(a){this._columnHiderRules[a]&&(this._columnHiderRules[a].remove(),delete this._columnHiderRules[a])},
_updateColumnHiddenState:function(a,d){this[d?"_hideColumn":"_showColumn"](a);this.columns[a].hidden=d;p.emit(this.domNode,"dgrid-columnstatechange",{grid:this,column:this.columns[a],hidden:d,bubbles:!0});this.resize()},toggleColumnHiddenState:function(a,d){"undefined"===typeof d&&(d=!this._columnHiderRules[a]);this._updateColumnHiddenState(a,d);this._columnHiderCheckboxes[a].checked=!d}})})},"dgrid/extensions/ColumnResizer":function(){define("dojo/_base/declare dojo/on dojo/query dojo/_base/lang dojo/dom dojo/dom-geometry dojo/has ../util/misc put-selector/put dojo/_base/html xstyle/css!../css/extensions/ColumnResizer.css".split(" "),
function(k,f,p,s,n,l,h,r,m){function e(a){for(var c=a.length,d=c,e=a[0].length,f=Array(c);c--;)f[c]=Array(e);for(var h={},c=0;c<d;c++)for(var l=f[c],k=a[c],n=0,y=0;n<e;n++){var m=k[y],r;if("undefined"==typeof l[n]){l[n]=m.id;if(m.rowSpan&&1<m.rowSpan){r=f;for(var p=m.rowSpan,t=c,s=n,F=m.id,A=1;A<p;A++)r[t+A][s]=F}if(0<c&&m.colSpan&&1<m.colSpan)for(r=1;r<m.colSpan;r++)if(l[++n]=m.id,m.rowSpan&&1<m.rowSpan)for(var p=f,t=m.rowSpan,s=c,F=n,A=m.id,C=1;C<t;C++)p[s+C][F]=A;h[m.id]=a[0][n].id;y++}}return h}
function t(a,c,d,e,h){if(!(0>=d)){var l=a.columns[c],k;if(l&&(k={grid:a,columnId:c,width:d,bubbles:!0,cancelable:!0},e&&(k.parentType=e),!a._resizedColumns||f.emit(a.headerNode,"dgrid-columnresize",k)))return"auto"===d?delete l.width:(l.width=d,d+="px"),(e=a._columnSizes[c])?e.set("width",d):e=r.addCssRule("#"+r.escapeCssIdentifier(a.domNode.id)+" .dgrid-column-"+r.escapeCssIdentifier(c,"-"),"width: "+d+";"),a._columnSizes[c]=e,!1!==h&&a.resize(),!0}}var a,d=0,c={create:function(){a=m("div.dgrid-column-resizer")},
destroy:function(){m(a,"!");a=null},show:function(b){b=l.position(b.domNode,!0);a.style.top=b.y+"px";a.style.height=b.h+"px";m(document.body,a)},move:function(b){a.style.left=b+"px"},hide:function(){a.parentNode.removeChild(a)}};return k("dgrid.extensions.ColumnResizer",null,{resizeNode:null,minWidth:40,adjustLastColumn:!0,_resizedColumns:!1,buildRendering:function(){this.inherited(arguments);d++||c.create()},destroy:function(){this.inherited(arguments);for(var a in this._columnSizes)this._columnSizes[a].remove();
--d||c.destroy()},resizeColumnWidth:function(a,c){return t(this,a,c)},configStructure:function(){var a=this._oldColumnSizes=s.mixin({},this._columnSizes),c;this._resizedColumns=!1;this._columnSizes={};this.inherited(arguments);for(c in a)c in this._columnSizes||a[c].remove();delete this._oldColumnSizes},_configColumn:function(a){this.inherited(arguments);var c=a.id,d;"width"in a&&((d=this._oldColumnSizes[c])?d.set("width",a.width+"px"):d=r.addCssRule("#"+r.escapeCssIdentifier(this.domNode.id)+" .dgrid-column-"+
r.escapeCssIdentifier(c,"-"),"width: "+a.width+"px;"),this._columnSizes[c]=d)},renderHeader:function(){this.inherited(arguments);var a=this,c;if(this.columnSets&&this.columnSets.length)for(var d=this.columnSets.length;d--;)c=s.mixin(c||{},e(this.columnSets[d]));else this.subRows&&1<this.subRows.length&&(c=e(this.subRows));for(var d=p(".dgrid-cell",a.headerNode),l=d.length;l--;){var k=d[l],n=k.columnId,t=a.columns[n],D=k.childNodes;if(t&&!1!==t.resizable){t=m("div.dgrid-resize-header-container");for(k.contents=
t;0<D.length;)m(t,D[0]);k=m(k,t,"div.dgrid-resize-handle.resizeNode-"+r.escapeCssIdentifier(n,"-"));k.columnId=c&&c[n]||n}}a.mouseMoveListen||(f(a.headerNode,".dgrid-resize-handle:mousedown"+(h("touch")?",.dgrid-resize-handle:touchstart":""),function(c){a._resizeMouseDown(c,this);a.mouseMoveListen.resume();a.mouseUpListen.resume()}),a._listeners.push(a.mouseMoveListen=f.pausable(document,"mousemove"+(h("touch")?",touchmove":""),r.throttleDelayed(function(c){a._updateResizerPosition(c)}))),a._listeners.push(a.mouseUpListen=
f.pausable(document,"mouseup"+(h("touch")?",touchend":""),function(c){a._resizeMouseUp(c);a.mouseMoveListen.pause();a.mouseUpListen.pause()})),a.mouseMoveListen.pause(),a.mouseUpListen.pause())},_resizeMouseDown:function(a,d){a.preventDefault();n.setSelectable(this.domNode,!1);this._startX=this._getResizeMouseLocation(a);this._targetCell=p(".dgrid-column-"+r.escapeCssIdentifier(d.columnId,"-"),this.headerNode)[0];this._updateResizerPosition(a);c.show(this)},_resizeMouseUp:function(a){var d=this._columnSizes,
g,e,f;this.adjustLastColumn&&(f=this.headerNode.clientWidth-1);this._resizedColumns||(g=p(".dgrid-cell",this.headerNode),this.columnSets&&this.columnSets.length?g=g.filter(function(a){return"0"==a.columnId.split("-")[0]&&!(a.columnId in d)}):this.subRows&&1<this.subRows.length&&(g=g.filter(function(a){return"0"==a.columnId.charAt(0)&&!(a.columnId in d)})),e=g.map(function(a){return a.offsetWidth}),g.forEach(function(a,b){t(this,a.columnId,e[b],null,!1)},this),this._resizedColumns=!0);n.setSelectable(this.domNode,
!0);g=this._targetCell;var h=this._getResizeMouseLocation(a)-this._startX,l=g.offsetWidth+h,k=this._getResizedColumnWidths(),m=k.totalWidth,k=k.lastColId,y=p(".dgrid-column-"+r.escapeCssIdentifier(k,"-"),this.headerNode)[0].offsetWidth;l<this.minWidth&&(l=this.minWidth);t(this,g.columnId,l,a.type)&&g.columnId!=k&&this.adjustLastColumn&&(m+h<f?t(this,k,"auto",a.type):y-h<=this.minWidth&&t(this,k,this.minWidth,a.type));c.hide();delete this._startX;delete this._targetCell},_updateResizerPosition:function(a){if(this._targetCell){a=
this._getResizeMouseLocation(a);var d=this._targetCell.offsetWidth,g=a;d+(a-this._startX)<this.minWidth&&(g=this._startX-(d-this.minWidth));c.move(g)}},_getResizeMouseLocation:function(a){var c=0;a.pageX?c=a.pageX:a.clientX&&(c=a.clientX+document.body.scrollLeft+document.documentElement.scrollLeft);return c},_getResizedColumnWidths:function(){var a=0,c=p((this.columnSets?".dgrid-column-set-cell ":"")+"tr:first-child .dgrid-cell",this.headerNode),d=c.length;if(!d)return{};for(var e=c[d-1].columnId;d--;)a+=
c[d].offsetWidth;return{totalWidth:a,lastColId:e}}})})},"dgrid/extensions/ColumnReorder":function(){define("dojo/_base/lang dojo/_base/declare dojo/_base/array dojo/on dojo/query dojo/dnd/Source put-selector/put xstyle/css!../css/extensions/ColumnReorder.css".split(" "),function(k,f,p,s,n,l,h){function r(a,d){var c=d[2],b=a[c?"columnSets":"subRows"][d[1]];return c?b[d[2]]:b}function m(a,d,c){d[2]?a.columnSets[d[1]][d[2]]=c:a.subRows[d[1]]=c}function e(a,d){return d.slice(("dgrid-"+a+"-").length)}
var t=/(\d+)(?:-(\d+))?$/;k=f(l,{copyState:function(){return!1},checkAcceptance:function(a,d){return a==this},_legalMouseDown:function(a){return-1<a.target.className.indexOf("dgrid-resize-handle")?!1:this.inherited(arguments)},onDropInternal:function(a){var d=this.grid,c=t.exec(e(d.id,a[0].getAttribute("dndType"))),b=c[2]?"columnSets":"subRows",f=r(d,c),g=d.columns;this.inherited(arguments);c&&setTimeout(function(){var e=p.map(a[0].parentNode.childNodes,function(a){return g[a.columnId]});m(d,c,e);
e={grid:d,subRow:e,column:g[a[0].columnId],bubbles:!0,cancelable:!0,parentType:"dnd"};e[b]=d[b];s.emit(d.domNode,"dgrid-columnreorder",e)?d.set(b,d[b]):(m(d,c,f),d.renderHeader(),this._sort&&this._sort.length&&this.updateSortArrow(this._sort))},0)}});f=f("dgrid.extensions.ColumnReorder",null,{columnDndConstructor:k,_initSubRowDnd:function(a,d){var c,b,e,g;b=0;for(e=a.length;b<e;b++)g=a[b],!1!==g.reorderable&&(g=g.headerNode,"TH"!=g.tagName&&(g=g.parentNode),h(g,".dojoDndItem[dndType\x3d"+d+"]"),c||
(c=g.parentNode));c&&this._columnDndSources.push(new this.columnDndConstructor(c,{horizontal:!0,grid:this}))},renderHeader:function(){var a="dgrid-"+this.id+"-",d,c;this.inherited(arguments);this._columnDndSources=[];if(this.columnSets){c=0;for(d=this.columnSets.length;c<d;c++)p.forEach(this.columnSets[c],function(b,d){this._initSubRowDnd(b,a+c+"-"+d)},this)}else p.forEach(this.subRows,function(b,c){this._initSubRowDnd(b,a+c)},this)},_destroyColumns:function(){this._columnDndSources&&p.forEach(this._columnDndSources,
function(a){a.destroy()});this.inherited(arguments)}});f.ColumnDndSource=k;return f})},"dijit/Toolbar":function(){define("require dojo/_base/declare dojo/has dojo/keys dojo/ready ./_Widget ./_KeyNavContainer ./_TemplatedMixin".split(" "),function(k,f,p,s,n,l,h,r){p("dijit-legacy-requires")&&n(0,function(){k(["dijit/ToolbarSeparator"])});return f("dijit.Toolbar",[l,r,h],{templateString:'\x3cdiv class\x3d"dijit" role\x3d"toolbar" tabIndex\x3d"${tabIndex}" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e',
baseClass:"dijitToolbar",_onLeftArrow:function(){this.focusPrev()},_onRightArrow:function(){this.focusNext()}})})},"esri/tasks/RelationParameters":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array dojo/_base/json dojo/has ../kernel ../geometry/jsonUtils".split(" "),function(k,f,p,s,n,l,h){k=k(null,{declaredClass:"esri.tasks.RelationParameters",geometries1:null,geometries2:null,relation:null,relationParam:null,toJson:function(){var f=p.map(this.geometries1,function(a){return a.toJson()}),
l=p.map(this.geometries2,function(a){return a.toJson()}),e={},k=this.geometries1;k&&0<k.length&&(e.geometries1=s.toJson({geometryType:h.getJsonType(k[0]),geometries:f}),f=this.geometries1[0].spatialReference,e.sr=f.wkid?f.wkid:s.toJson(f.toJson()));if((f=this.geometries2)&&0<f.length)e.geometries2=s.toJson({geometryType:h.getJsonType(f[0]),geometries:l});this.relation&&(e.relation=this.relation);this.relationParam&&(e.relationParam=this.relationParam);return e}});f.mixin(k,{SPATIAL_REL_CROSS:"esriGeometryRelationCross",
SPATIAL_REL_DISJOINT:"esriGeometryRelationDisjoint",SPATIAL_REL_IN:"esriGeometryRelationIn",SPATIAL_REL_INTERIORINTERSECTION:"esriGeometryRelationInteriorIntersection",SPATIAL_REL_INTERSECTION:"esriGeometryRelationIntersection",SPATIAL_REL_COINCIDENCE:"esriGeometryRelationLineCoincidence",SPATIAL_REL_LINETOUCH:"esriGeometryRelationLineTouch",SPATIAL_REL_OVERLAP:"esriGeometryRelationOverlap",SPATIAL_REL_POINTTOUCH:"esriGeometryRelationPointTouch",SPATIAL_REL_TOUCH:"esriGeometryRelationTouch",SPATIAL_REL_WITHIN:"esriGeometryRelationWithin",
SPATIAL_REL_RELATION:"esriGeometryRelationRelation"});return k})},"jimu/CSVUtils":function(){define("exports dojo/_base/lang dojo/_base/array dojo/_base/html dojo/has dojo/Deferred jimu/utils esri/lang esri/tasks/QueryTask esri/tasks/query".split(" "),function(k,f,p,s,n,l,h,r,m,e){function t(a){var d=f.clone(a.attributes);if((a=a.geometry)&&"point"===a.type)"x"in d?d._x=a.x:d.x=a.x,"y"in d?d._y=a.y:d.y=a.y;return d}k.exportCSV=function(a,d,c){return k._createCSVStr(d,c).then(function(b){return k._download(a+
".csv",b)})};k.exportCSVFromFeatureLayer=function(a,d,c){c=c||{};return k._getExportData(d,{datas:c.datas,fromClient:c.fromClient,withGeometry:c.withGeometry,outFields:c.outFields,filterExpression:c.filterExpression}).then(function(b){return k._formattedData(d,b,{formatNumber:c.formatNumber,formatDate:c.formatDate,formatCodedValue:c.formatCodedValue,popupInfo:c.popupInfo}).then(function(b){return k.exportCSV(a,b.datas,b.columns)})})};k.exportCSVByAttributes=function(a,d,c,b){b=f.mixin({},b);b.datas=
c;return k.exportCSVFromFeatureLayer(a,d,b)};k.exportCSVByGraphics=function(a,d,c,b){c=p.map(c,function(a){return a.attributes});return k.exportCSVByAttributes(a,d,c,b)};k._createCSVStr=function(a,d){var c=new l,b="",e=0,g=0,f="",h="";try{p.forEach(d,function(a){b=b+f+a;f=","});for(var b=b+"\r\n",e=a.length,g=d.length,k=0;k<e;k++){for(var f="",n=0;n<g;n++)h=a[k][d[n]],!h&&"number"!==typeof h&&(h=""),h&&/[",\r\n]/g.test(h)&&(h='"'+h.replace(/(")/g,'""')+'"'),b=b+f+h,f=",";b+="\r\n"}c.resolve(b)}catch(m){console.error(m),
c.resolve("")}return c};k._isIE11=function(){return 11===h.has("ie")};k._isEdge=function(){return h.has("edge")};k._getDownloadUrl=function(a){return window.Blob&&window.URL&&window.URL.createObjectURL?(a=new Blob(["\ufeff"+a],{type:"text/csv"}),URL.createObjectURL(a)):"data:attachment/csv;charset\x3dutf-8,\ufeff"+encodeURIComponent(a)};k._download=function(a,d){var c=new l;try{if(n("ie")&&10>n("ie")){var b=window.top.open("about:blank","_blank");b.document.write("sep\x3d,\r\n"+d);b.document.close();
b.document.execCommand("SaveAs",!0,a);b.close()}else if(10===n("ie")||k._isIE11()||k._isEdge()){var e=new Blob(["\ufeff"+d],{type:"text/csv"});navigator.msSaveBlob(e,a)}else{var g=s.create("a",{href:k._getDownloadUrl(d),target:"_blank",download:a},document.body);if(n("safari")){var f=document.createEvent("MouseEvents");f.initEvent("click",!0,!0);g.dispatchEvent(f)}else g.click();s.destroy(g)}c.resolve()}catch(h){c.reject(h)}return c};k._getExportData=function(a,d){var c=new l,b=null,e=d.datas,g=d.withGeometry,
b=d.outFields;if(!b||!b.length)b=a.fields;b=f.clone(b);if(g&&!(e&&0<e.length)){var h="",h=-1!==b.indexOf("x")?"_x":"x";b.push({name:h,alias:h,format:{digitSeparator:!1,places:6},show:!0,type:"esriFieldTypeDouble"});h=-1!==b.indexOf("y")?"_y":"y";b.push({name:h,alias:h,format:{digitSeparator:!1,places:6},show:!0,type:"esriFieldTypeDouble"})}e&&0<e.length?c.resolve({data:e||[],outFields:b}):d.fromClient?(e=p.map(a.graphics,function(a){return g?t(a):f.clone(a)}),c.resolve({data:e||[],outFields:b})):
k._getExportDataFromServer(a,b,d).then(function(a){c.resolve({data:a||[],outFields:b})});return c};k._getExportDataFromServer=function(a,d,c){var b=new l;if("esri.layers.FeatureLayer"!==a.declaredClass)return b.resolve([]),b;var f=new m(a.url),g=new e;g.where=c.filterExpression||a.getDefinitionExpression&&a.getDefinitionExpression()||"1\x3d1";0<d.length?(a=p.map(d,function(a){return a.name}),g.outFields=a):g.outFields=["*"];g.returnGeometry=c.withGeometry;f.execute(g,function(a){a=p.map(a.features,
function(a){return t(a)});b.resolve(a)},function(a){console.error(a);b.resolve([])});return b};k._formattedData=function(a,d,c){var b=new l,e=[],g=d.data;d=d.outFields;for(var f=0,h=g.length;f<h;f++){for(var n={},m=0;m<d.length;m++){var r=d[m];n[r.alias||r.name]=k._getExportValue(g[f][r.name],r,a.objectIdField,a.typeIdField,g[f][a.typeIdField],a.types,c)}e.push(n)}a=p.map(d,function(a){return a.alias||a.name});b.resolve({datas:e,columns:a});return b};k._getExportValue=function(a,d,c,b,e,g,f){function l(a){if(k&&
r.isDefined(k.fieldInfos))for(var b=0,c=k.fieldInfos.length;b<c;b++){var d=k.fieldInfos[b];if(d.fieldName===a)return d.format}return null}var k=f.popupInfo,n=!!d.domain&&f.formatCodedValue;f="esriFieldTypeDate"===d.type&&f.formatDate;var m=c&&d.name===c;b=b&&d.name===b;return f?h.fieldFormatter.getFormattedDate(a,l(d.name)):b?h.fieldFormatter.getTypeName(a,g):n?h.fieldFormatter.getCodedValue(d.domain,a):!n&&!f&&!m&&!b?(n=null,c&&g&&0<g.length&&(c=(c=p.filter(g,function(a){return a.id===e}))&&c[0])&&
(c.domains&&c.domains[d.name]&&c.domains[d.name].codedValues)&&(n=h.fieldFormatter.getCodedValue(c.domains[d.name],a)),null!==n?n:a):a}})},"widgets/AttributeTable/utils":function(){define("dojo/_base/lang dojo/_base/array jimu/LayerInfos/LayerInfos dojo/Deferred dojo/promise/all exports dojo/store/Observable dojo/store/Cache dojo/store/Memory esri/lang ./table/FeatureLayerQueryStore jimu/utils".split(" "),function(k,f,p,s,n,l,h,r,m,e,t,a){function d(a,b){if(!a||!a.length)return b||[];if(!b||!b.length)return a;
for(var d=[],g=0,e=a.length;g<e;g++)for(var f=a[g],h=0,l=b.length;h<l;h++)if(b[h].name===f.name){d.push(f);break}return d}l.readLayerInfosObj=function(a){return p.getInstance(a,a.itemInfo)};l.readLayerInfosFromMap=function(a,b,d){var g=new s;p.getInstance(a,a.itemInfo).then(k.hitch(this,function(a){var c=[];b?a.traversalLayerInfosOfWebmap(function(a){c.push(a)}):a.traversal(function(a){c.push(a)});if(d){var e=[],h=a.getMapNotesLayerInfoArray();f.forEach(h,function(a){e.push(a.id);a.traversal(function(a){e.push(a.id)})});
c=f.filter(c,function(a){return-1===e.indexOf(a.id)})}a=a.getTableInfoArray();c=c.concat(a);g.resolve(c)}),k.hitch(this,function(a){console.error(a);g.reject(a)}));return g.promise};l.generateColumnsFromFields=function(a,b,d,g,h,n){function m(b){if(a&&e.isDefined(a.fieldInfos))for(var d=0,g=a.fieldInfos.length;d<g;d++){var f=a.fieldInfos[d];if(f.fieldName===b)return f.format}return null}var r={selectionHandle:{label:"",className:"selection-handle-column",hidden:!1,unhidable:!0,filed:"selection-handle-column",
sortable:!1,_cache:{sortable:!1,statistics:!1}}};f.forEach(b,k.hitch(l,function(a,b,c){b="field"+b;var B=!!a.domain,p="esriFieldTypeDate"===a.type,t=d&&a.name===d,s="esriFieldTypeDouble"===a.type||"esriFieldTypeSingle"===a.type||"esriFieldTypeInteger"===a.type||"esriFieldTypeSmallInteger"===a.type,H="esriFieldTypeString"===a.type;r[b]={label:a.alias||a.name,className:b,hidden:1===c.length?!1:!a.show&&e.isDefined(a.show),unhidable:1===c.length?!1:!a.show&&e.isDefined(a.show)&&a._pk,field:a.name,sortable:!1,
_cache:{sortable:!!h,statistics:n&&!B&&s}};H?r[b].formatter=k.hitch(l,l.urlFormatter):p?r[b].formatter=k.hitch(l,l.dateFormatter,m(a.name)):s&&(r[b].formatter=k.hitch(l,l.numberFormatter,m(a.name)));B?r[b].get=k.hitch(l,function(a,b){return this.getCodeValue(a.domain,b[a.name])},a):t?r[b].get=k.hitch(l,function(a,b,c){return this.getTypeName(c[a.name],b)},a,g):!B&&(!p&&!t)&&(r[b].get=k.hitch(l,function(a,b,c,d){var g=null;b&&c&&0<c.length&&(c=(c=f.filter(c,k.hitch(l,function(a){return a.name===d[b]})))&&
c[0]||null)&&(c.domains&&c.domains[a.name]&&c.domains[a.name].codedValues)&&(g=this.getCodeValue(c.domains[a.name],d[a.name]));return(a=null!==g?g:d[a.name])||isFinite(a)?a:""},a,d,g))}));return r};l.getTypeName=function(c,b){return a.fieldFormatter.getTypeName(c,b)};l.getCodeValue=function(c,b){return a.fieldFormatter.getCodedValue(c,b)};l.urlFormatter=function(c){return a.fieldFormatter.getFormattedUrl(c)};l.dateFormatter=function(c,b){return a.fieldFormatter.getFormattedDate(b,c)};l.numberFormatter=
function(c,b){return a.fieldFormatter.getFormattedNumber(b,c)};l.readLayerObjectsFromMap=function(a,b,d){var g=new s,e=[];this.readLayerInfosFromMap(a,b,d).then(k.hitch(this,function(a){f.forEach(a,k.hitch(this,function(a){e.push(a.getLayerObject())}));n(e).then(k.hitch(this,function(a){g.resolve(a)}),k.hitch(this,function(a){g.reject(a);console.error(a)}))}),k.hitch(this,function(a){g.reject(a)}));return g.promise};l.readSupportTableInfoFromLayerInfos=function(a){var b=new s,d=[];f.forEach(a,k.hitch(this,
function(a){d.push(a.getSupportTableInfo())}));n(d).then(k.hitch(this,function(d){d=k.clone(d);f.forEach(d,function(b,d){b.id=a[d].id});b.resolve(d)}),function(a){b.reject(a)});return b.promise};l.readConfigLayerInfosFromMap=function(a,b,d){var g=new s,e=[];this.readLayerInfosFromMap(a,b,d).then(k.hitch(this,function(a){var b=[];f.forEach(a,function(a){e.push(a.getSupportTableInfo())});n(e).then(k.hitch(this,function(c){f.forEach(c,k.hitch(this,function(c,d){c.isSupportedLayer&&(a[d].name=a[d].title,
b.push(a[d]))}));g.resolve(b)}),k.hitch(this,function(a){g.reject(a)}))}),k.hitch(this,function(a){g.reject(a)}));return g.promise};l.getConfigInfosFromLayerInfos=function(a){return f.map(a,function(a){return l.getConfigInfoFromLayerInfo(a)})};l.getConfigInfoFromLayerInfo=function(a){var b={};b.name=a.name||a.title;b.id=a.id;b.show=a.isShowInMap();b.layer={url:a.getUrl()};var e=a.getPopupInfo();e&&!e.description&&(b.layer.fields=f.map(e.fieldInfos,function(a){return{name:a.fieldName,alias:a.label,
show:a.visible,format:a.format}}),a=k.getObject("layerObject.fields",!1,a),b.layer.fields=d(b.layer.fields,a),f.some(b.layer.fields,function(a){return a.show})||(b.layer.fields[0].show=!0));return b};l.generateCacheStore=function(a,b,d,g,e){a=new t({layer:a,objectIds:a._objectIds||null,totalCount:b,batchCount:d,where:g||"1\x3d1",spatialFilter:e});b=new m;return new r(a,b,{})};l.generateMemoryStore=function(a,b){return new h(new m({data:a||[],idProperty:b}))};l.merge=function(a,b,d,g){for(var e=f.map(b,
function(a){return a[d]}),h=0,l=a.length;h<l;h++){var k=e.indexOf(a[h][d]);-1<k&&g(a[h],b[k])}};l.syncOrderWith=function(a,b,d){function g(a,b){return f.map(a,function(a){return a[b]})}if(!k.isArray(b)||!d)return a;for(var e=g(a,d),h=[],l=0,n=b.length;l<n;l++){var m=e.indexOf(b[l][d]);-1<m&&(h=h.concat(a.splice(m,1)),e=g(a,d))}return h.concat(a)}})},"dojo/store/Observable":function(){define(["../_base/kernel","../_base/lang","../when","../_base/array"],function(k,f,p,s){k=function(k){function l(f,
a){var d=k[f];d&&(k[f]=function(c){var b;"put"===f&&(b=k.getIdentity(c));if(e)return d.apply(this,arguments);e=!0;try{var h=d.apply(this,arguments);p(h,function(d){a("object"==typeof d&&d||c,b)});return h}finally{e=!1}})}var h=[],r=0;k=f.delegate(k);k.notify=function(e,a){r++;for(var d=h.slice(),c=0,b=d.length;c<b;c++)d[c](e,a)};var m=k.query;k.query=function(e,a){a=a||{};var d=m.apply(this,arguments);if(d&&d.forEach){var c=f.mixin({},a);delete c.start;delete c.count;var b=k.queryEngine&&k.queryEngine(e,
c),l=r,g=[],v;d.observe=function(c,e){1==g.push(c)&&h.push(v=function(c,f){p(d,function(d){var h=d.length!=a.count,m,p;if(++l!=r)throw Error("Query is out of date, you must observe() the query prior to any data modifications");var t,u=-1,v=-1;if(void 0!==f){var A=[].concat(d);b&&!c&&(A=b(d));m=0;for(p=d.length;m<p;m++){var C=d[m];if(k.getIdentity(C)==f&&!(0>A.indexOf(C))){t=C;u=m;(b||!c)&&d.splice(m,1);break}}}if(b){if(c&&(b.matches?b.matches(c):b([c]).length))m=-1<u?u:d.length,d.splice(m,0,c),v=
s.indexOf(b(d),c),d.splice(m,1),a.start&&0==v||!h&&v==d.length?v=-1:d.splice(v,0,c)}else c&&(void 0!==f?v=u:a.start||(v=k.defaultIndex||0,d.splice(v,0,c)));if((-1<u||-1<v)&&(e||!b||u!=v)){h=g.slice();for(m=0;d=h[m];m++)d(c||t,u,v)}})});var f={};f.remove=f.cancel=function(){var a=s.indexOf(g,c);-1<a&&(g.splice(a,1),g.length||h.splice(s.indexOf(h,v),1))};return f}}return d};var e;l("put",function(e,a){k.notify(e,a)});l("add",function(e){k.notify(e)});l("remove",function(e){k.notify(void 0,e)});return k};
f.setObject("dojo.store.Observable",k);return k})},"dojo/store/Cache":function(){define(["../_base/lang","../when"],function(k,f){var p=function(p,n,l){l=l||{};return k.delegate(p,{query:function(f,k){var m=p.query(f,k);m.forEach(function(e){(!l.isLoaded||l.isLoaded(e))&&n.put(e)});return m},queryEngine:p.queryEngine||n.queryEngine,get:function(h,k){return f(n.get(h),function(l){return l||f(p.get(h,k),function(e){e&&n.put(e,{id:h});return e})})},add:function(h,k){return f(p.add(h,k),function(f){n.add(f&&
"object"==typeof f?f:h,k);return f})},put:function(h,k){n.remove(k&&k.id||this.getIdentity(h));return f(p.put(h,k),function(f){n.put(f&&"object"==typeof f?f:h,k);return f})},remove:function(h,k){return f(p.remove(h,k),function(f){return n.remove(h,k)})},evict:function(f){return n.remove(f)}})};k.setObject("dojo.store.Cache",p);return p})},"widgets/AttributeTable/table/FeatureLayerQueryStore":function(){define("dojo/_base/declare dojo/_base/lang dojo/_base/array esri/tasks/query esri/tasks/QueryTask ./FeatureLayerQueryResult".split(" "),
function(k,f,p,s,n,l){return k(null,{queryUrl:"",idProperty:"id",data:null,_entityData:null,constructor:function(f){k.safeMixin(this,f);this.data=[];this._entityData=[];this.layer=f.layer;this.objectIds=f.objectIds;this.where=f.where;this.orderByFields=f.orderByFields;this.totalCount=f.totalCount;this.batchCount=f.batchCount||25;this.idProperty=this.layer.objectIdField;this.spatialFilter=f.spatialFilter;this.layer&&this.layer.url&&(this.queryTask=new n(this.layer.url))},get:function(f){return this.data[f]},
getIdentity:function(f){return f[this.idProperty]},query:function(h,k){var m=new s,e=k&&k.start||0,n=this.batchCount,a=null;"function"===typeof h?a=h(this._entityData):"[object Array]"===Object.prototype.toString.call(h)&&(a=h);if(this.objectIds)a=a?a:this.objectIds,m.objectIds=a.length>=e+this.batchCount?a.slice(e,e+n):a.slice(e);else if(a&&0<a.length?m.objectIds=a.length>=e+this.batchCount?a.slice(e,e+n):a.slice(e):(m.start=e,m.num=n,m.where=this.where,m.geometry=this.spatialFilter,m.spatialRelationship=
s.SPATIAL_REL_INTERSECTS),(e=k.sort)&&0<e.length)e=p.map(e,function(a){return a.attribute+" "+(a.descending?"DESC":"ASC")}),m.orderByFields=e;m.returnGeometry="esriGeometryPoint"===this.layer.geometryType;m.outFields=["*"];var d=this.totalCount,e=null,e=!m.where;if(!(m.objectIds&&0<m.objectIds.length)&&e)return new l([]);e=this.queryTask?this.queryTask.execute(m):this.layer.queryFeatures(m);e.total=e.then(f.hitch(this,function(a){var b=0,e=this.layer.objectIdField;if(this.objectIds){if(!e)for(b=0;b<
a.fields.length;b++)if("esriFieldTypeOID"===a.fields[b].type){e=a.fields[b].name;break}for(var g={},b=0;b<a.features.length;b++)g[a.features[b].attributes[e]]=a.features[b];a.features=p.map(m.objectIds,function(a){return g[a]})}for(b=0;b<a.features.length;b++)if(a.features[b]){var h=a.features[b];a.features[b]=f.mixin(f.clone(h.attributes),{geometry:h.geometry});this.data[a.features[b][e]]=a.features[b];this._entityData.push(a.features[b])}a=a.features;return d}),function(){console.log("FeatureLayerQueryStore queryFeatures failed.");
return 0});return new l(e)}})})},"widgets/AttributeTable/table/FeatureLayerQueryResult":function(){define("esri/main dojo/_base/lang dojo/_base/kernel dojo/_base/Deferred dojo/DeferredList dojo/_base/array".split(" "),function(k,f,p,s){var n=function(l){function h(f){l[f]||(l[f]=function(){var h=arguments;return s.when(l,function(e){Array.prototype.unshift.call(h,e.features||e);return n(p[f].apply(p,h))})})}if(!l)return l;l.then&&(l=f.delegate(l));l.total||(l.total=s.when(l,function(f){return k._isDefined(f.total)?
f.total:f.length||0}));h("forEach");h("filter");h("map");h("some");h("every");return l};return n})},"widgets/AttributeTable/_build-generate_module":function(){define(["dojo/text!./css/style.css","dojo/i18n!./nls/strings"],function(){})},"url:dijit/layout/templates/TabContainer.html":'\x3cdiv class\x3d"dijitTabContainer"\x3e\r\n\t\x3cdiv class\x3d"dijitTabListWrapper" data-dojo-attach-point\x3d"tablistNode"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"tablistSpacer" class\x3d"dijitTabSpacer ${baseClass}-spacer"\x3e\x3c/div\x3e\r\n\t\x3cdiv class\x3d"dijitTabPaneWrapper ${baseClass}-container" data-dojo-attach-point\x3d"containerNode"\x3e\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/layout/templates/_TabButton.html":'\x3cdiv role\x3d"presentation" data-dojo-attach-point\x3d"titleNode,innerDiv,tabContent" class\x3d"dijitTabInner dijitTabContent"\x3e\r\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitIcon dijitTabButtonIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3cspan data-dojo-attach-point\x3d\'containerNode,focusNode\' class\x3d\'tabLabel\'\x3e\x3c/span\x3e\r\n\t\x3cspan class\x3d"dijitInline dijitTabCloseButton dijitTabCloseIcon" data-dojo-attach-point\x3d\'closeNode\'\r\n\t\t  role\x3d"presentation"\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d\'closeText\' class\x3d\'dijitTabCloseText\'\x3e[x]\x3c/span\r\n\t\t\t\t\x3e\x3c/span\x3e\r\n\x3c/div\x3e\r\n',
"url:dijit/layout/templates/ScrollingTabController.html":'\x3cdiv class\x3d"dijitTabListContainer-${tabPosition}" style\x3d"visibility:hidden"\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerMenuButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_menuBtn"\r\n\t\t data-dojo-props\x3d"containerId: \'${containerId}\', iconClass: \'dijitTabStripMenuIcon\',\r\n\t\t\t\t\tdropDownPosition: [\'below-alt\', \'above-alt\']"\r\n\t\t data-dojo-attach-point\x3d"_menuBtn" showLabel\x3d"false" title\x3d""\x3e\x26#9660;\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_leftBtn"\r\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideLeftIcon\', showLabel:false, title:\'\'"\r\n\t\t data-dojo-attach-point\x3d"_leftBtn" data-dojo-attach-event\x3d"onClick: doSlideLeft"\x3e\x26#9664;\x3c/div\x3e\r\n\t\x3cdiv data-dojo-type\x3d"dijit.layout._ScrollingTabControllerButton"\r\n\t\t class\x3d"tabStripButton-${tabPosition}"\r\n\t\t id\x3d"${id}_rightBtn"\r\n\t\t data-dojo-props\x3d"iconClass:\'dijitTabStripSlideRightIcon\', showLabel:false, title:\'\'"\r\n\t\t data-dojo-attach-point\x3d"_rightBtn" data-dojo-attach-event\x3d"onClick: doSlideRight"\x3e\x26#9654;\x3c/div\x3e\r\n\t\x3cdiv class\x3d\'dijitTabListWrapper\' data-dojo-attach-point\x3d\'tablistWrapper\'\x3e\r\n\t\t\x3cdiv role\x3d\'tablist\' data-dojo-attach-event\x3d\'onkeydown:onkeydown\'\r\n\t\t\t data-dojo-attach-point\x3d\'containerNode\' class\x3d\'nowrapTabStrip\'\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/layout/templates/_ScrollingTabControllerButton.html":'\x3cdiv data-dojo-attach-event\x3d"ondijitclick:_onClick" class\x3d"dijitTabInnerDiv dijitTabContent dijitButtonContents"  data-dojo-attach-point\x3d"focusNode" role\x3d"button"\x3e\r\n\t\x3cspan role\x3d"presentation" class\x3d"dijitInline dijitTabStripIcon" data-dojo-attach-point\x3d"iconNode"\x3e\x3c/span\x3e\r\n\t\x3cspan data-dojo-attach-point\x3d"containerNode,titleNode" class\x3d"dijitButtonText"\x3e\x3c/span\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/Filter.html":'\x3cdiv\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"contentSection" class\x3d"content-section"\x3e\r\n\t\t\x3cdiv class\x3d"add-btn-section"\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAddExp" data-dojo-attach-event\x3d"click:_onBtnAddExpClick"\r\n\t\t\t class\x3d"add-with-icon jimu-state-disabled add-expression jimu-float-leading"\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"iconAddExp" class\x3d"jimu-icon jimu-icon-add jimu-state-disabled"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addAnotherExpression}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAddSet" data-dojo-attach-event\x3d"click:_onBtnAddSetClick"\r\n\t\t\t class\x3d"add-with-icon jimu-state-disabled add-set jimu-float-leading"\x3e\r\n\t\t\t\t\x3cspan data-dojo-attach-point\x3d"iconAddSet" class\x3d"jimu-icon jimu-icon-add jimu-state-disabled"\x3e\x3c/span\x3e\r\n\t\t\t\t\x3cspan class\x3d"add-label"\x3e${nls.addSet}\x3c/span\x3e\r\n\t\t\t\x3c/div\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"matchMsg" style\x3d"margin-top:11px;margin-bottom:11px;display:none;"\x3e\r\n\t\t\t\x3cspan\x3e${nls.strMatchMsgPart1}\x3c/span\x3e\r\n\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.all}\x3c/option\x3e\r\n\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.any}\x3c/option\x3e\r\n\t\t\t\x3c/select\x3e\r\n\t\t\t\x3cspan\x3e${nls.strMatchMsgPart2}\x3c/span\x3e\r\n\t\t\x3c/span\x3e\r\n\t\t\x3cdiv class\x3d"allExpsBox" data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"errorSection" style\x3d"display:none;"\x3e\r\n\t\t\x3cspan class\x3d"jimu-icon jimu-icon-error"\x3e\x3c/span\x3e\r\n\t\t\x3cspan data-dojo-attach-point\x3d"errorTip" class\x3d"error-tip"\x3e\x3c/span\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"noFilterTipSection" class\x3d"no-filter-tip" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"loading" data-dojo-type\x3d"jimu/dijit/LoadingIndicator" data-dojo-props\x3d"hidden:true"\x3e\x3c/div\x3e\r\n\x3c/div\x3e',
"url:jimu/dijit/templates/_SingleFilter.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"setting-table" cellpadding\x3d"0" cellspacing\x3d"0" cellpadding\x3d"10px" style\x3d"table-layout:fixed;"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd class\x3d"fields-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fieldsSelect" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-attach-event\x3d"change:_onFieldsSelectChange"  data-dojo-props\x3d\'searchAttr:"displayName",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"operators-td" nowrap\x3e\r\n\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"operatorsSelect" data-dojo-type\x3d"dijit/form/Select" data-dojo-attach-event\x3d"change:_onOperatorsSelectChange" style\x3d"width:100%;" class\x3d"dijit-form-Select restrict-select-width"\x3e\r\n\t\t\t\t\t\t\x3coption value\x3d"none"\x3e${nls.none}\x3c/option\x3e\r\n\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"value-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"attributeValueContainer" class\x3d"value-container"\x3e\r\n\t\t\t\t\t\t\x3cdiv\x3e\r\n\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"allValueBoxContainer" style\x3d"width:100%;"\x3e\r\n\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"stringTextBoxContainer" style\x3d"width:100%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"stringTextBox" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"width:100%;" class\x3d"dijit-form-ValidationTextBox" /\x3e\r\n\r\n\t\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"stringCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"numberTextBoxContainer" style\x3d"display:none;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"numberTextBox" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n\r\n\t\t\t\t\t\t\t\t\t\x3ctable data-dojo-attach-point\x3d"numberRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;table-layout:fixed;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"numberTextBox1" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"numberTextBox2" data-dojo-type\x3d"dijit/form/NumberTextBox" data-dojo-attach-event\x3d"blur:_onRangeNumberBlur" data-dojo-props\x3d\'"required":true,intermediateChanges:true,constraints: {pattern: "#####0.##########"}\' class\x3d"dijit-form-NumberTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\r\n\t\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"numberCodedValuesFS" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name",required:true,intermediateChanges:true\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"dateTextBoxContainer" style\x3d"display:none;"\x3e\r\n\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"dateTextBox" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctable data-dojo-attach-point\x3d"dateRangeTable" style\x3d"display:none;width:100%;border-collapse:collapse;table-layout:fixed;" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:40%;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"dateTextBox1" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd style\x3d"width:20%;text-align:center;"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cspan\x3e${nls.and}\x3c/span\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\x3cinput data-dojo-attach-point\x3d"dateTextBox2" data-dojo-type\x3d"dijit/form/DateTextBox" data-dojo-attach-event\x3d"change:_onRangeDateBlur" data-dojo-props\x3d\'value:new Date(),required:true,trim:true\' class\x3d"dijit-form-DateTextBox" style\x3d"width:100%;" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"fieldsSelect2" data-dojo-type\x3d"dijit/form/FilteringSelect" data-dojo-props\x3d\'searchAttr:"name"\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\r\n\t\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"uniqueValuesSelect" data-dojo-type\x3d"dijit/form/FilteringSelect"  data-dojo-props\x3d\'searchAttr:"label"\' class\x3d"dijit-form-FilteringSelect" style\x3d"display:none;width:100%;"\x3e\r\n\t\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\r\n\t\t\t\t\t\t\x3cdiv class\x3d"radio-table-container"\x3e\r\n\t\t\t\t\t\t\t\x3ctable class\x3d"radio-table" cellpadding\x3d"0" cellspacing\x3d"0"\x3e\r\n\t\t\t\t\t\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\t\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"valueRadio" checked\x3d"true" disabled  title\x3d"${nls.valueTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"valueLabel" title\x3d"${nls.valueTooltip}"\x3e${nls.value}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"fieldRadio" disabled title\x3d"${nls.fieldTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"fieldLabel" title\x3d"${nls.fieldTooltip}"\x3e${nls.field}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3ctd data-dojo-attach-point\x3d"uniqueTd"\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3cinput type\x3d"radio" data-dojo-attach-point\x3d"uniqueRadio" disabled title\x3d"${nls.uniqueValueTooltip}" /\x3e\r\n\t\t\t\t\t\t\t\t\t\t\t\x3clabel data-dojo-attach-point\x3d"uniqueLabel" title\x3d"${nls.uniqueValueTooltip}"\x3e${nls.unique}\x3c/label\x3e\r\n\t\t\t\t\t\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\t\t\t\t\x3c/tbody\x3e\r\n\t\t\t\t\t\t\t\x3c/table\x3e\r\n\t\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd class\x3d"delete-td" nowrap\x3e\r\n\t\t\t\t\t\x3cdiv class\x3d"jimu-icon jimu-icon-delete" data-dojo-attach-point\x3d"btnDelete"\r\n\t\t\t\t\t data-dojo-attach-event\x3d"click:_destroySelf"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"askvalues"\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxAskValues" label\x3d"${nls.askForValues}" class\x3d"jimu-trailing-margin6"\x3e\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-type\x3d"jimu/dijit/CheckBox" data-dojo-attach-point\x3d"cbxCaseSensitive" label\x3d"${nls.caseSensitive}" style\x3d"display:none;"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"promptSection" class\x3d"prompt"\x3e\r\n\t\t\x3ctable data-dojo-attach-point\x3d"promptTable" cellpadding\x3d"0" cellspacing\x3d"0" class\x3d"prompt-table" style\x3d"width:100%;"\x3e\r\n\t\t\t\x3ctbody\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.prompt}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"promptTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"required:true,trim:true" style\x3d"width:257px;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td"\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.hint}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"second-td"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"hintTB" data-dojo-type\x3d"dijit/form/ValidationTextBox" data-dojo-props\x3d"trim:true" style\x3d"width:257px;" class\x3d"dijit-form-ValidationTextBox" \x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\t\x3ctr data-dojo-attach-point\x3d"cascadeTr" class\x3d"cascade-tr"\x3e\r\n\t\t\t\t\t\x3ctd class\x3d"first-td" colspan\x3d"2"\x3e\r\n\t\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"cbxCascade" data-dojo-type\x3d"jimu/dijit/CheckBox"\x3e\x3c/div\x3e\r\n\t\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3c/tr\x3e\r\n\t\t\t\x3c/tbody\x3e\r\n\t\t\x3c/table\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:dijit/templates/Calendar.html":'\x3cdiv class\x3d"dijitCalendarContainer dijitInline" role\x3d"presentation" aria-labelledby\x3d"${id}_mddb ${id}_year"\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarMonthContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarDecrementArrow\' data-dojo-attach-point\x3d"decrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarDecrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"decreaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e-\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv class\x3d\'dijitReset dijitCalendarArrow dijitCalendarIncrementArrow\' data-dojo-attach-point\x3d"incrementMonth"\x3e\r\n\t\t\t\x3cimg src\x3d"${_blankGif}" alt\x3d"" class\x3d"dijitCalendarIncrementControl dijitCalendarIncrease" role\x3d"presentation"/\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"increaseArrowNode" class\x3d"dijitA11ySideArrow"\x3e+\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\t\x3cdiv data-dojo-attach-point\x3d"monthNode" class\x3d"dijitInline"\x3e\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\t\x3ctable cellspacing\x3d"0" cellpadding\x3d"0" role\x3d"grid" data-dojo-attach-point\x3d"gridNode"\x3e\r\n\t\t\x3cthead\x3e\r\n\t\t\t\x3ctr role\x3d"row"\x3e\r\n\t\t\t\t${!dayCellsHtml}\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/thead\x3e\r\n\t\t\x3ctbody data-dojo-attach-point\x3d"dateRowsNode" data-dojo-attach-event\x3d"ondijitclick: _onDayClick" class\x3d"dijitReset dijitCalendarBodyContainer"\x3e\r\n\t\t\t\t${!dateRowsHtml}\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv class\x3d"dijitReset dijitCalendarYearContainer" role\x3d"presentation"\x3e\r\n\t\t\x3cdiv class\x3d"dijitCalendarYearLabel"\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"previousYearLabelNode" class\x3d"dijitInline dijitCalendarPreviousYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"currentYearLabelNode" class\x3d"dijitInline dijitCalendarSelectedYear" role\x3d"button" id\x3d"${id}_year"\x3e\x3c/span\x3e\r\n\t\t\t\x3cspan data-dojo-attach-point\x3d"nextYearLabelNode" class\x3d"dijitInline dijitCalendarNextYear" role\x3d"button"\x3e\x3c/span\x3e\r\n\t\t\x3c/div\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e\r\n',
"url:jimu/dijit/templates/_FilterSet.html":'\x3cdiv\x3e\r\n\t\x3ctable class\x3d"header-table" cellspacing\x3d"0" cellpadding\x3d"0"\x3e\r\n\t\t\x3ctbody\x3e\r\n\t\t\t\x3ctr\x3e\r\n\t\t\t\t\x3ctd\x3e\r\n\t\t\t\t\t\x3cdiv\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.strMatchMsgPart1}\x3c/span\x3e\r\n\t\t\t\t\t\t\x3cselect data-dojo-attach-point\x3d"allAnySelect"\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"AND" selected\x3e${nls.all}\x3c/option\x3e\r\n\t\t\t\t\t\t\t\x3coption value\x3d"OR"\x3e${nls.any}\x3c/option\x3e\r\n\t\t\t\t\t\t\x3c/select\x3e\r\n\t\t\t\t\t\t\x3cspan\x3e${nls.strMatchMsgPart2}\x3c/span\x3e\r\n\t\t\t\t\t\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:15px;padding-right:10px;"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnDelete" data-dojo-attach-event\x3d"onclick:_destroySelf"\r\n\t\t\t\t\t class\x3d"jimu-icon jimu-icon-delete"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\t\x3ctd style\x3d"width:15px;padding-right:14px;"\x3e\r\n\t\t\t\t\t\x3cdiv data-dojo-attach-point\x3d"btnAdd" class\x3d"jimu-icon jimu-icon-add"\x3e\x3c/div\x3e\r\n\t\t\t\t\x3c/td\x3e\r\n\t\t\t\x3c/tr\x3e\r\n\t\t\x3c/tbody\x3e\r\n\t\x3c/table\x3e\r\n\t\x3cdiv data-dojo-attach-point\x3d"allExpsBox"\x3e\r\n\t\x3c/div\x3e\r\n\x3c/div\x3e',
"url:widgets/AttributeTable/css/style.css":'.jimu-widget-attributetable-main .tabStripButton{height: 24px !important;}.jimu-widget-attributetable,.jimu-widget-attributetable-main{left: 0px; bottom: 0px; background-color: #efefef;}.jimu-widget-attributetable{height: auto;}.jimu-widget-attributetable-main{overflow: hidden; width: 100%; height: 100%;}.jimu-widget-attributetable .jimu-widget-attributetable-main .dijitToolbar {position: relative;}.jimu-widget-attributetable-move{width: 100%; height: 7px; top: 0px; background-color: rgba(0, 0, 0, 0.7);}.jimu-widget-attributetable-move:hover{cursor: n-resize;}.jimu-widget-attributetable-move:hover .jimu-widget-attributetable-thumb{background-color: #fff;}.jimu-widget-attributetable .draging{background-color: gray;}.jimu-widget-attributetable-thumb{background: #B0B0B0 none; height: 1px; width: 19px; margin: 3px auto; position: absolute; left: 0; right: 0;}.jimu-widget-attributetable-indicate-vertical{width: 2px; height: 100%; background-color: black; position: absolute; z-index: 1; opacity: 0;}.jimu-widget-attributetable-indicate-horizontal{width: 100%; height: 2px; background-color: black; position: absolute; z-index: 1; opacity: 0;}.jimu-widget-attributetable-switch{width: 63px; height: 17px; left: 0; right: 0; top: -17px; margin: auto; position: absolute; cursor: pointer; border-radius: 8px 8px 0 0; background-position: center; background-repeat: no-repeat; background-color: rgba(0,0,0,0.7); border: 2px solid rgba(255,255,255,0.8); border-bottom-style: none;}.jimu-widget-attributetable-switch.open{background-image: url(images/arrow_down.svg); border-bottom-left-radius: 0; border-bottom-right-radius: 0;}.jimu-widget-attributetable-switch.open:hover{background-image: url(images/arrow_down_hover.svg);}.jimu-widget-attributetable-switch.close{background-image: url(images/arrow_up.svg)}.jimu-widget-attributetable-switch.close:hover{background-image: url(images/arrow_up_hover.svg);}.jimu-widget-attributetable-arrowImage{width: 30px; height: 30px; left: 48%; top: -30px; position: absolute; border-top-left-radius: 4px; border-top-right-radius: 4px; border-bottom-left-radius: 0px; border-bottom-right-radius: 0px; background-position: center center; background-repeat: no-repeat; cursor: ns-resize; background-color: rgba(0, 0, 0, 0.8);}.dijitTabPaneWrapper .dijitTabContainerTop-container .dijitAlignCenter{height: 100%;}.jimu-widget-attributetable .dijitTabContainerTopChildWrapper,.jimu-widget-attributetable .dijitTabContainerTopChildWrapper .dijitContentPane{height: 100% !important; width: 100% !important; padding: 0;}.jimu-widget-attributetable .dijitToggleButton.dijitToggleButtonChecked .dijitButtonText{color: #518dca;}.jimu-widget-attributetable .esriAttributeTable{width: 100%; height: 100%; position: relative;}.jimu-widget-attributetable .dgrid-header .dgrid-column-selectionHandle.selection-handle-column div.dgrid-resize-header-container{display: none;}.jimu-widget-attributetable .dgrid-column-selectionHandle.selection-handle-column{width: 20px !important; background-color: #eee; padding: 0 !important; border-bottom: 1px solid #ccc !important; cursor: pointer;}.dojoDndSource.dojoDndTarget.dojoDndHorizontal.dojoDndContainer .dgrid-column-selectionHandle.selection-handle-column{pointer-events: none;}.jimu-widget-attributetable .dgrid-cell {border-right: solid 1px #ccc; width: 100px;}.jimu-widget-attributetable .jimu-widget-attributetable-feature-table.auto-width .dgrid-cell{width: auto;}.jimu-widget-attributetable .dgrid-row .dgrid-cell {border:medium none; padding: 7px 3px; border-right: 1px solid #CCCCCC;}.jimu-rtl .jimu-widget-attributetable .dgrid-rtl-swap .dgrid-header-row {right: 0; left: 17px;}.jimu-rtl .jimu-widget-attributetable .dgrid-cell {text-align: right; border-left: solid 1px #ccc;}.jimu-widget-attributetable .dgrid-header {overflow: hidden; background-color: #eee;}.jimu-widget-attributetable .dgrid-cell a{color: #21759B; text-decoration: none;}.jimu-widget-attributetable .dgrid-cell a:hover, a:active{text-decoration: underline;}.jimu-widget-attributetable .dgrid-row {border: medium none;}.jimu-widget-attributetable .dgrid-row:hover {background-color:#E1F0FB;}.jimu-widget-attributetable .dgrid-row-even{background-color: #FFF;}.jimu-widget-attributetable .dgrid-row-odd {background-color: #F7F8F8;}.jimu-widget-attributetable .ui-state-active {background-color: rgb(0, 255, 255) !important;}.jimu-widget-attributetable .dgrid-status {white-space: pre;}.jimu-widget-attributetable .self-footer {display: inline-block;}.jimu-rtl .dgrid-hider-menu-check{right: 2px; left: auto;}.jimu-rtl .dgrid-hider-menu-label {padding-left: 0; padding-right: 20px;}.jimu-rtl .jimu-widget-attributetable .dgrid-pagination .dgrid-status{float: right !important;}.jimu-rtl .dgrid-pagination .dgrid-navigation,.jimu-rtl .dgrid-pagination .dgrid-page-size{float: left !important;}.esriAttributeTableExportImage{background-image: url("../images/export.png"); width: 13px; height: 13px;}.esriAttributeTableZoomImage{background-image: url("../images/zoom.png"); width: 13px; height: 13px;}.esriAttributeTableSelectAllImage{background-image: url("../images/select.png"); width: 13px; height: 13px;}.esriAttributeTableFilterImage{background-image: url("../images/filter.png"); width: 13px; height: 13px;}.esriAttributeTableSelectPageImage{background-image: url("../images/page.png"); width: 13px; height: 13px;}.esriAttributeTableClearImage{background-image: url("../images/clear.png"); width: 13px; height: 13px;}.esriAttributeTableOptionsImage{background-image: url("../images/more.png"); width: 13px; height: 13px;}.esriAttributeTableRefreshImage{background-image: url("../images/refresh.png"); width: 13px; height: 13px;}.esriAttributeTableSymbolImage{background-image: url("../images/symbol.png"); width: 13px; height: 13px;}.esriAttributeTableCloseImage{background-image: url("../images/close.png"); width: 13px; height: 13px; position: absolute; right: 0; top: -13px;}.esriAttributeTableColumnsImage{background-image: url("../images/columns.png"); width: 13px; height: 13px;}.jimu-rtl .jimu-widget-attributetable .close-button {right: auto; left: 0;}.jimu-widget-attributetable .jimu-loading-indicator {z-index: 100;}.jimu-widget-attributetable .jimu-widget-attributetable-feature-table{height: 100%; position: relative;}.jimu-widget-attributetable-feature-menu .menuItemClass{cursor: pointer;}.jimu-widget-attributetable-feature-menu.dijitMenu{background-color: #fff !important;}.jimu-widget-attributetable-feature-menu.dijitMenu .dijitMenuItemSelected td,.jimu-widget-attributetable-feature-menu.dijitMenu .dijitMenuItemSelected{background-color: #f1f1f1 !important; color: #000!important;}',
"*now":function(k){k(['dojo/i18n!*preload*widgets/AttributeTable/nls/Widget*["ar","cs","da","de","en","el","es","et","fi","fr","he","hr","it","ja","ko","lt","lv","nb","nl","pl","pt-br","pt-pt","ro","ru","sr","sv","th","tr","zh-cn","vi","zh-hk","zh-tw","ROOT"]'])}}});
define("dojo/_base/declare dojo/_base/html dijit/_WidgetsInTemplateMixin jimu/BaseWidget dijit/layout/TabContainer dijit/layout/ContentPane jimu/utils jimu/dijit/Message dojo/Deferred dojo/promise/all esri/layers/FeatureLayer esri/lang dojo/_base/lang dojo/on dojo/touch dojo/topic dojo/aspect dojo/_base/array dojo/query jimu/dijit/LoadingIndicator jimu/FilterManager ./_ResourceManager ./utils".split(" "),function(k,f,p,s,n,l,h,r,m,e,t,a,d,c,b,w,g,v,u,G,I,D,E){k=k([s,p],{name:"AttributeTable",baseClass:"jimu-widget-attributetable",
normalHeight:0,openHeight:0,arrowDivHeight:null,_relatedDef:null,_resourceManager:null,_activeLayerInfoId:null,_layerTypes:{FEATURELAYER:"FeatureLayerTable",RELATIONSHIPTABLE:"RelationshipTable"},postMixInProperties:function(){this.nls.features=this.nls.features||"features"},postCreate:function(){this.inherited(arguments);h.loadStyleLink("dgrid",apiUrl+"dgrid/css/dgrid.css");this.AttributeTableDiv=this._loadInfoDef=null;this._delayedLayerInfos=[];this.layerTabPages=[];this.tabContainer=null;this.moveMode=
!1;this.bottomPosition=this.noGridHeight=this.previousDomHeight=this.moveY=0;this.layerTabPagesIndex=-1;this.showing=!1;this.openHeight=this.normalHeight=this._getNormalHeight();this.arrowDivHeight=0;this._dragingHandlers=[];this._activeTable=null;this._activeTableHandles=[];this.filterManager=I.getInstance();this._createUtilitiesUI();this._resourceManager=new D({map:this.map,nls:this.nls});this._resourceManager.setConfig(this.config);this.own(w.subscribe("changeMapPosition",d.hitch(this,this._onMapPositionChange)));
E.readLayerInfosObj(this.map).then(d.hitch(this,function(a){this.domNode&&a&&(this.own(c(a,"layerInfosIsShowInMapChanged",d.hitch(this,this.onLayerInfosIsShowInMapChanged))),this.own(a.on("layerInfosChanged",d.hitch(this,this.onLayerInfosChanged))),this.own(a.on("layerInfosFilterChanged",d.hitch(this,this.onLayerInfosFilterChanged))))}))},_createUtilitiesUI:function(){this._createArrowUI();this._createBarUI()},_createArrowUI:function(){this.arrowDiv=f.create("div");f.addClass(this.arrowDiv,"jimu-widget-attributetable-move");
f.create("div",{"class":"jimu-widget-attributetable-thumb"},this.arrowDiv);f.place(this.arrowDiv,this.domNode);if(!this.arrowDivHeight){var a=f.getMarginBox(this.arrowDiv);this.arrowDivHeight=a&&a.h?a.h:7}this.own(c(this.arrowDiv,"mousedown",d.hitch(this,this._onDragStart)));this.own(c(this.arrowDiv,b.press,d.hitch(this,this._onDragStart)))},_isOnlyTable:function(){return this.closeable||!this.isOnScreen},_createBarUI:function(){this._isOnlyTable()||(this.switchBtn=f.create("div",{className:"jimu-widget-attributetable-switch"},
this.domNode),this.own(c(this.switchBtn,"click",d.hitch(this,this._switchTable))))},_processOpenBarUI:function(){this._isOnlyTable()||(f.removeClass(this.switchBtn,"close"),f.addClass(this.switchBtn,"open"),f.setAttr(this.switchBtn,"title",this.nls.closeTableTip))},_processCloseBarUI:function(){this._isOnlyTable()||(f.removeClass(this.switchBtn,"open"),f.addClass(this.switchBtn,"close"),f.setAttr(this.switchBtn,"title",this.nls.openTableTip))},_switchTable:function(){this.showing?this._closeTable():
this._openTable()},_openTable:function(){this._loadInfoDef?this._loadInfoDef&&this._loadInfoDef.isFulfilled()&&(this.showing=!0,this._processDelayedLayerInfos(),this._activeTable&&this._activeTable.active()):(this._loadInfoDef=new m,this.own(this._loadInfoDef),this.loading||(this.loading=new G),this.loading.placeAt(this.domNode),this.loading.show(),this._resourceManager.updateLayerInfoResources(!0).then(d.hitch(this,function(){this.domNode&&(this._init(),this.showRefreshing(!1),this.showing=!0,this._loadInfoDef.resolve())}),
d.hitch(this,function(a){console.error(a);this._loadInfoDef.reject(a)})));this._changeHeight(this.openHeight);this._processOpenBarUI();return this._loadInfoDef},_onCloseBtnClicked:function(){this.showing&&this._isOnlyTable()?this.widgetManager.closeWidget(this):this.showing&&this._closeTable();this._activeTable&&this._activeTable.deactive()},_closeTable:function(){this._changeHeight(0);this.showRefreshing(!1);this._processCloseBarUI();this._activeTable&&this._activeTable.deactive();this.showing=!1;
f.setStyle(this.arrowDiv,"display","none");f.setStyle(this.domNode,"overflow","hidden");setTimeout(d.hitch(this,function(){this.domNode&&(f.setStyle(this.domNode,"overflow","visible"),f.setStyle(this.arrowDiv,"display","block"))}),10)},_init:function(){this.initDiv();this._changeHeight(this.openHeight);this.resize();this.own(c(window.document,"mouseup",d.hitch(this,this._onDragEnd)));this.own(c(window.document,"mousemove",d.hitch(this,this._onDraging)));this.own(c(window.document,b.move,d.hitch(this,
this._onDraging)));this.own(c(window.document,b.release,d.hitch(this,this._onDragEnd)))},_processDelayedLayerInfos:function(){0<this._delayedLayerInfos.length&&(v.forEach(this._delayedLayerInfos,d.hitch(this,function(a){this._resourceManager.addLayerInfo(a)})),this._delayedLayerInfos=[])},onLayerInfosIsShowInMapChanged:function(){this._activeTable&&this._activeTable.changeToolbarStatus()},onLayerInfosChanged:function(a,b,c){c&&a&&("added"===b?c.getSupportTableInfo().then(d.hitch(this,function(a){a.isSupportedLayer&&
this._resourceManager.addLayerInfo(c)})):"removed"===b&&(a=c.id,this.getExistLayerTabPage(a)&&this.layerTabPageClose(a,!0),this._resourceManager.getLayerInfoById(a)&&this._resourceManager.removeLayerInfo(a),this._resourceManager.getConfigInfoById(a)&&this._resourceManager.removeConfigInfo(a)))},onLayerInfosFilterChanged:function(a){v.some(a,d.hitch(this,function(a){if(this._activeTable&&a.id===this._activeTable.layerInfo.id)return this._activeTable._relatedQuery||this._activeTable.startQuery(),!0}))},
destroy:function(){if(!this._destroyed){var b,c;if(this.layerTabPages&&0<this.layerTabPages.length){b=this.layerTabPages.length;for(c=0;c<b;c++){var e=this.layerTabPages[c].paneId,f=d.getObject("_resourceManager.featureTableSet."+e,!1,this);f&&(f=f.getFilterObj())&&a.isDefined(f.expr)&&this.filterManager.applyWidgetFilter(e,this.id,"");this.layerTabPages[c].destroy()}this.layerTabPages=null}this.tabContainer&&(this.tabContainer.destroy(),this.tabContainer=null);this._activeLayerInfoId=this._loadInfoDef=
this.AttributeTableDiv=null;this._resourceManager&&this._resourceManager.empty();this.inherited(arguments)}},onOpen:function(){!this.showing&&this._isOnlyTable()&&this._openTable()},onClose:function(){this.showing&&this._closeTable()},_changeHeight:function(a){f.setStyle(this.domNode,"height",a+"px");this.tabContainer&&(this.tabContainer.domNode&&0<=a-this.arrowDivHeight)&&f.setStyle(this.tabContainer.domNode,"height",a-this.arrowDivHeight+"px");this._activeTable&&this._activeTable.changeHeight(a-
this.noGridHeight);w.publish("changeMapPosition",{bottom:a+this.bottomPosition});this.publishData({changeMapPosition:{bottom:a+this.bottomPosition}});0!==a&&(this.openHeight=a>=this.arrowDivHeight?a:this.normalHeight)},_onMapPositionChange:function(a){isFinite(a.left)&&"number"===typeof a.left&&(window.isRTL?f.setStyle(this.domNode,"right",parseFloat(a.left)+"px"):f.setStyle(this.domNode,"left",parseFloat(a.left)+"px"));isFinite(a.right)&&"number"===typeof a.right&&(window.isRTL?f.setStyle(this.domNode,
"left",parseFloat(a.right)+"px"):f.setStyle(this.domNode,"right",parseFloat(a.right)+"px"));this.tabContainer&&this.tabContainer.resize()},setPosition:function(a){this.position=a;this._isOnlyTable()?this.bottomPosition=0:this.bottomPosition="bottom"in a?parseInt(a.bottom,10):0;if(!this.domNode.parentNode||this.domNode.parentNode.id!==window.jimuConfig.layoutId)f.place(this.domNode,window.jimuConfig.layoutId),this.setInitialPosition(a),this.showRefreshing(!1);f.setStyle(this.domNode,"bottom",this.bottomPosition+
"px");this._resourceManager.isEmpty()||setTimeout(d.hitch(this,function(){var a=this._getGridTopSectionHeight(),b=f.getStyle(this.domNode,"height");0<a&&(this.noGridHeight=a);0<b&&this._changeHeight(b)}),20)},_startQueryOnLayerTab:function(a,b){var c=this._resourceManager.getLayerInfoById(a),e=this.getExistLayerTabPage(a);c&&e&&(this.showRefreshing(!0),this._resourceManager.getQueryTable(a,this.config.filterByMapExtent,this.config.hideExportButton).then(d.hitch(this,function(c){this._activeLayerInfoId===
a&&c&&(e=this.getExistLayerTabPage(a),c.isSupportQuery?(c=c.table,c.getParent()!==e&&c.placeAt(e),this.setActiveTable(c,{h:this.openHeight-this.noGridHeight,featureSet:b})):(c=f.toDom("\x3cdiv\x3e"+this.nls.unsupportQueryWarning+"\x3c/div\x3e"),e.set("content",c),this._activeTable&&this._activeTable.changeToolbarStatus()),this.showRefreshing(!1))}),d.hitch(this,function(a){new r({message:a.message||a});this.showRefreshing(!1)})))},_startQueryOnRelationTab:function(a,b,c,e){var g=this._resourceManager.getLayerInfoById(e),
h=this.getExistLayerTabPage(a);g&&g.layerObject&&h&&this._resourceManager.getRelationTable(e,b,!1,this.config.hideExportButton).then(d.hitch(this,function(b){this._activeLayerInfoId===a&&b&&(h=this.getExistLayerTabPage(a),b.isSupportQuery?(b=b.table,b.getParent()!==h&&b.placeAt(h),this.setActiveTable(b,{h:this.openHeight-this.noGridHeight,layer:g.layerObject,selectedIds:c})):(b=f.toDom("\x3cdiv\x3e"+this.nls.unsupportQueryWarning+"\x3c/div\x3e"),h.set("content",b),this._activeTable&&this._activeTable.changeToolbarStatus()),
this.showRefreshing(!1))}))},tabChanged:function(){if(this.tabContainer&&this.tabContainer.selectedChildWidget){0>=this.noGridHeight&&(this.noGridHeight=this._getGridTopSectionHeight()+5);var a=this.tabContainer.selectedChildWidget.params,b=a.layerType,c=a.paneId,d=a.relKey;b===this._layerTypes.FEATURELAYER&&(this._activeLayerInfoId!==c||a.oids||a.featureSet)?(this.setActiveTable(null),delete a.oids,this._activeLayerInfoId=c,this._startQueryOnLayerTab(c,a.featureSet)):b===this._layerTypes.RELATIONSHIPTABLE&&
(this.setActiveTable(null),b=a.oids,a=a.originalInfoId,this._activeLayerInfoId=c,this._startQueryOnRelationTab(c,d,b,a))}},showRefreshing:function(a){this.loading&&(a?this.loading.show():this.loading.hide())},_onDragStart:function(a){this.moveMode=!0;this.moveY=a.clientY;this.previousDomHeight=f.getStyle(this.domNode,"height");f.addClass(this.arrowDiv,"draging");this._dragingHandlers=this._dragingHandlers.concat([c(this.ownerDocument,"dragstart",function(a){a.stopPropagation();a.preventDefault()}),
c(this.ownerDocumentBody,"selectstart",function(a){a.stopPropagation();a.preventDefault()})])},_onDraging:function(a){this.moveMode&&125<=a.clientY&&this._changeHeight(this.moveY-a.clientY+this.previousDomHeight)},_onDragEnd:function(){this.moveMode=!1;f.removeClass(this.arrowDiv,"draging");for(var a=this._dragingHandlers.pop();a;)a.remove(),a=this._dragingHandlers.pop()},_getNormalHeight:function(){var a=document.body.clientHeight;return window.appInfo.isRunInMobile?a/2:a/3},setInitialPosition:function(){f.setStyle(this.domNode,
"top","auto");f.setStyle(this.domNode,"left","0px");f.setStyle(this.domNode,"right","0px");f.setStyle(this.domNode,"position","absolute");this._isOnlyTable()||(this.config&&this.config.initiallyExpand?this._openTable():this._closeTable())},_bindActiveTableEvents:function(){var a=this;a._activeTable&&(a._activeTableHandles.push(c(a._activeTable,"show-related-records",function(b){a._showRelatedRecords(b)})),a._activeTableHandles.push(c(a._activeTable,"show-all-records",function(b){a.getExistLayerTabPage(b.layerInfoId).params.layerType=
a._layerTypes.FEATURELAYER})),a._activeTableHandles.push(c(a._activeTable,"refresh",function(b){delete a.getExistLayerTabPage(b.layerInfoId).params.featureSet})),a._activeTableHandles.push(c(a._activeTable,"apply-filter",function(b){a.filterManager.applyWidgetFilter(b.layerInfoId,a.id,b.expr);a._activeTable.startQuery()})))},_unbindActiveTableEvents:function(){for(var a=this._activeTableHandles;0<a.length;){var b=a.pop();b&&b.remove&&b.remove()}},setActiveTable:function(a,b){this._activeTable&&(this._activeTable.cancelThread(),
this._activeTable.deactive(),this._unbindActiveTableEvents(),this._activeTable=null);if(a){this._activeTable=a;this._activeTable.active();this._activeTable.changeHeight(b.h);if(!this._activeTable.tableCreated||this._activeTable.tableCreated&&this._activeTable.matchingMap||this._activeTable.tableCreated&&!this._activeTable.matchingMap&&b.featureSet||b.layer&&b.selectedIds){var c=d.getObject("featureSet.features.length",!1,b);if(b.layer&&b.selectedIds)this._activeTable.queryRecordsByRelationship(b);
else if(c){var e=b.featureSet.displayFieldName,c=v.map(b.featureSet.features,function(a){return a.attributes[e]});this._activeTable.startQuery(c)}else this._activeTable.startQuery()}this._bindActiveTableEvents();this._activeTable.changeToolbarStatus()}},initDiv:function(){this.AttributeTableDiv=f.create("div",{},this.domNode);f.addClass(this.AttributeTableDiv,"jimu-widget-attributetable-main");var a=f.create("div");f.place(a,this.AttributeTableDiv);this.tabContainer=new n({style:"width: 100%;"},a);
f.setStyle(this.tabContainer.domNode,"height",this.normalHeight+"px");for(var a=this._resourceManager.getConfigInfos(),b=a.length,c=0;c<b;c++){var e=a[c];if(e.show){var e=d.clone(e),k={};k.paneId=e.id;k.title=e.name;k.name=e.name;k.layerType=this._layerTypes.FEATURELAYER;k.style="height: 100%; width: 100%; overflow: visible;";e=new l(k);this.layerTabPages[c]=e;this.tabContainer.addChild(e)}}this.tabContainer.startup();0<b&&(this.noGridHeight=this._getGridTopSectionHeight()+5);h.setVerticalCenter(this.tabContainer.domNode);
this.tabChanged();this.own(g.after(this.tabContainer,"selectChild",d.hitch(this,this.tabChanged)))},getLayerInfoLabel:function(a){return a.name||a.title},getLayerInfoId:function(a){return a&&a.id||""},_getGridTopSectionHeight:function(){var a=u(".dijitTabPaneWrapper",this.domNode)[0];if(a){var b=f.position(this.domNode).y;return f.position(a).y-b}return 0},_getLayerInfoByIdFromConfigJSON:function(a){var b=v.filter(this.config.layerInfos,function(b){return b.id===a});return b&&0<b.length&&b[0]},_showRelatedRecords:function(){var a=
this._activeTable;if(a){var b=a.layerInfo;if(b&&b.layerObject)for(var c=b.layerObject.relationships,a=a.getSelectedRows(),d=0,e=c.length;d<e;d++)this.addNewRelationTab(a,c[d],b.id)}},addNewLayerTab:function(a,b){var e=this._resourceManager.getLayerInfoById(a);if(e){var f=this.getExistLayerTabPage(a),g={};g.title=this.getLayerInfoLabel(e);g.name=g.title;g.paneId=this.getLayerInfoId(e);g.closable=!0;g.layerType=this._layerTypes.FEATURELAYER;g.featureSet=b;f?(d.mixin(f.params,g),this.onOpen()):(this._resourceManager.getConfigInfoById(e.id)||
this._resourceManager.addConfigInfo(e),this._resourceManager.getLayerInfoById(e.id)||this._resourceManager.addLayerInfo(e),this.onOpen(),g.style="height: 100%; width: 100%; overflow: visible",f=new l(g),this.layerTabPages.push(f),f.set("title",g.name),this.own(c(f,"close",d.hitch(this,this.layerTabPageClose,g.paneId))),this.tabContainer.addChild(f));this.tabContainer.selectChild(f)}},addNewRelationTab:function(a,b,e){var f=b&&b.shipInfo;if(f){var g=this.getExistLayerTabPage(b.shipInfo.id),h={};h.oids=
a;h.title=f.title||f.name||b.name;h.name=h.title;h.paneId=f.id;h.relKey=b._relKey;h.originalInfoId=e;h.closable=!0;h.layerType=this._layerTypes.RELATIONSHIPTABLE;g?d.mixin(g.params,h):(this._resourceManager.getConfigInfoById(f.id)||this._resourceManager.addConfigInfo(f),this._resourceManager.getLayerInfoById(f.id)||this._resourceManager.addLayerInfo(f),h.style="height: 100%; width: 100%; overflow: visible",g=new l(h),this.layerTabPages.push(g),g.set("title",h.name),this.own(c(g,"close",d.hitch(this,
this.layerTabPageClose,h.paneId))),this.tabContainer.addChild(g));this.tabContainer.selectChild(g)}},onReceiveData:function(a,b,c){c&&"AttributeTable"===c.target&&(this._isOnlyTable()&&"closed"===this.state?console.warn("Please open Attribute Table!"):(c.layer=c.layer||c.layerInfo,this.showing?this._resourceManager.updateLayerInfoResources(!1).then(d.hitch(this,function(){this._addLayerToTable(c)})):this._openTable().then(d.hitch(this,function(){this._resourceManager.getLayerInfoById(c.layer.id)?
this._addLayerToTable(c):this._resourceManager.updateLayerInfoResources(!1).then(d.hitch(this,function(){this._addLayerToTable(c)}))}))))},_addLayerToTable:function(a){var b=null;if(d.getObject("layer.id",!1,a)||d.getObject("layerInfo.id",!1,a)){var e=this._resourceManager.getLayerInfoById(a.layerInfo&&a.layerInfo.id||a.layer&&a.layer.id);e.getLayerObject().then(d.hitch(this,function(f){f?(f.id=a.layer.id,f.loaded?this.addNewLayerTab(e.id,a.featureSet):this.own(c(f,"load",d.hitch(this,this.addNewLayerTab,
e.id,a.featureSet)))):a.url&&(b=new t(a.url),this.own(c(b,"load",d.hitch(this,this.addNewLayerTab,e.id,a.featureSet))))}),d.hitch(this,function(a){new r({message:a.message||a})}))}},getExistLayerTabPage:function(a){for(var b=this.layerTabPages.length,c=0;c<b;c++)if(this.layerTabPages[c]&&this.layerTabPages[c].get("paneId")===a)return this.layerTabPages[c];return null},layerTabPageClose:function(b,c){var e=this.layerTabPages.length;d.getObject("_activeTable.layerInfo.id",!1,this)===b&&this.setActiveTable(null);
for(var f=0;f<e;f++)if(this.layerTabPages[f]&&this.layerTabPages[f].paneId===b){var g=d.getObject("_resourceManager.featureTableSet."+b,!1,this);g&&(g=g.getFilterObj())&&a.isDefined(g.expr)&&this.filterManager.applyWidgetFilter(b,this.id,"");!0===c&&(this.tabContainer.removeChild(this.layerTabPages[f]),this.layerTabPages[f].destroyRecursive());this.layerTabPages&&this.layerTabPages[f]&&this.layerTabPages.splice(f,1);this._resourceManager.removeConfigInfo(b);this._resourceManager.removeLayerInfo(b);
if(1===e){this._activeLayerInfoId=null;this.onClose();break}else b===this._activeLayerInfoId&&this.tabContainer.selectChild(this.layerTabPages[e-2]);break}},_processRelatedRecordsFromPopup:function(a,b){if(a){var c=[];c.push(a.getLayerObject());c.push(a.getRelatedTableInfoArray());e(c).then(d.hitch(this,function(c){if(c){var d=c[0];this._resourceManager.collectRelationShips(a,c[1]);c=d.relationships;for(var d=0,e=c.length;d<e;d++)this.addNewRelationTab(b,c[d],a.id)}}))}},showRelatedRecordsFromPopup:function(a,
b){this.showing?this._resourceManager.updateLayerInfoResources(!1).then(d.hitch(this,function(){this._processRelatedRecordsFromPopup(a,b)})):this._openTable().then(d.hitch(this,function(){this._resourceManager.getLayerInfoById(a.id)?this._processRelatedRecordsFromPopup(a,b):this._resourceManager.updateLayerInfoResources(!1).then(d.hitch(this,function(){this._processRelatedRecordsFromPopup(a,b)}))}))}});k.inPanel=!1;k.hasUIFile=!1;return k});